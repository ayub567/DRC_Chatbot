"use strict";(self["webpackChunkDRC_AI"]=self["webpackChunkDRC_AI"]||[]).push([[177],{9880:function(e,t,n){n.r(t),n.d(t,{default:function(){return np}});var r={};n.r(r),n.d(r,{APIConnectionError:function(){return w},APIConnectionTimeoutError:function(){return E},APIError:function(){return v},APIUserAbortError:function(){return b},AuthenticationError:function(){return S},BadRequestError:function(){return _},ConflictError:function(){return A},InternalServerError:function(){return C},NotFoundError:function(){return x},PermissionDeniedError:function(){return O},RateLimitError:function(){return P},UnprocessableEntityError:function(){return R}});var o={};n.r(o),n.d(o,{hasBrowserEnv:function(){return la},hasStandardBrowserEnv:function(){return ua},hasStandardBrowserWebWorkerEnv:function(){return ca}});n(560);var s=n(3396),i=n(7139),a=n(4870),l=n(7178),u=n(2748),c=n(2483),d=n(7853);n(8858),n(1318),n(3228),n(3429);const h="4.10.0";n(4224),n(1121),n(7133);class f{constructor(e,t){this.response=e,this.controller=t,this.decoder=new p}async*iterMessages(){if(!this.response.body)throw this.controller.abort(),new Error("Attempted to iterate over a response with no body");const e=new m,t=g(this.response.body);for await(const n of t)for(const t of e.decode(n)){const e=this.decoder.decode(t);e&&(yield e)}for(const n of e.flush()){const e=this.decoder.decode(n);e&&(yield e)}}async*[Symbol.asyncIterator](){let e=!1;try{for await(const t of this.iterMessages())if(!e)if(t.data.startsWith("[DONE]"))e=!0;else if(null===t.event)try{yield JSON.parse(t.data)}catch(ku){throw console.error("Could not parse message into JSON:",t.data),console.error("From chunk:",t.raw),ku}e=!0}catch(ku){if(ku instanceof Error&&"AbortError"===ku.name)return;throw ku}finally{e||this.controller.abort()}}}class p{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,r]=y(e,":");return r.startsWith(" ")&&(r=r.substring(1)),"event"===t?this.event=r:"data"===t&&this.data.push(r),null}}class m{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];const n=m.NEWLINE_CHARS.has(t[t.length-1]||"");let r=t.split(m.NEWLINE_REGEXP);return 1!==r.length||n?(this.buffer.length>0&&(r=[this.buffer.join("")+r[0],...r.slice(1)],this.buffer=[]),n||(this.buffer=[r.pop()||""]),r):(this.buffer.push(r[0]),[])}decodeText(e){var t;if(null==e)return"";if("string"===typeof e)return e;if("undefined"!==typeof Buffer){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new Error(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if("undefined"!==typeof TextDecoder){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return null!==(t=this.textDecoder)&&void 0!==t||(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new Error(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new Error("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}function y(e,t){const n=e.indexOf(t);return-1!==n?[e.substring(0,n),t,e.substring(n+t.length)]:[e,"",""]}function g(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const e=await t.read();return(null===e||void 0===e?void 0:e.done)&&t.releaseLock(),e}catch(ku){throw t.releaseLock(),ku}},async return(){const e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}m.NEWLINE_CHARS=new Set(["\n","\r","\v","\f","","","","","\u2028","\u2029"]),m.NEWLINE_REGEXP=/\r\n|[\n\r\x0b\x0c\x1c\x1d\x1e\x85\u2028\u2029]/g;class v extends Error{constructor(e,t,n,r){super(`${e} ${v.makeMessage(t,n)}`),this.status=e,this.headers=r;const o=t;this.error=o,this.code=null===o||void 0===o?void 0:o["code"],this.param=null===o||void 0===o?void 0:o["param"],this.type=null===o||void 0===o?void 0:o["type"]}static makeMessage(e,t){return(null===e||void 0===e?void 0:e.message)?"string"===typeof e.message?e.message:JSON.stringify(e.message):e?JSON.stringify(e):t||"status code (no body)"}static generate(e,t,n,r){if(!e)return new w({cause:Ce(t)});const o=null===t||void 0===t?void 0:t["error"];return 400===e?new _(e,o,n,r):401===e?new S(e,o,n,r):403===e?new O(e,o,n,r):404===e?new x(e,o,n,r):409===e?new A(e,o,n,r):422===e?new R(e,o,n,r):429===e?new P(e,o,n,r):e>=500?new C(e,o,n,r):new v(e,o,n,r)}}class b extends v{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}}class w extends v{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),this.status=void 0,t&&(this.cause=t)}}class E extends w{constructor({message:e}={}){super({message:null!==e&&void 0!==e?e:"Request timed out."})}}class _ extends v{constructor(){super(...arguments),this.status=400}}class S extends v{constructor(){super(...arguments),this.status=401}}class O extends v{constructor(){super(...arguments),this.status=403}}class x extends v{constructor(){super(...arguments),this.status=404}}class A extends v{constructor(){super(...arguments),this.status=409}}class R extends v{constructor(){super(...arguments),this.status=422}}class P extends v{constructor(){super(...arguments),this.status=429}}class C extends v{}let k,T,I,j,N,D,q,B,U=!1,M=null,K=null,L=null,$=null;function F(e,t={auto:!1}){if(U)throw new Error(`you must \`import 'openai/shims/${e.kind}'\` before importing anything else from openai`);if(k)throw new Error(`can't \`import 'openai/shims/${e.kind}'\` after \`import 'openai/shims/${k}'\``);U=t.auto,k=e.kind,T=e.fetch,M=e.Request,K=e.Response,L=e.Headers,I=e.FormData,$=e.Blob,j=e.File,N=e.getMultipartRequestOptions,D=e.getDefaultAgent,q=e.fileFromPath,B=e.isFsReadStream}class V{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function z({manuallyImported:e}={}){const t=e?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,o,s;try{n=fetch,r=Request,o=Response,s=Headers}catch(i){throw new Error(`this environment is missing the following Web Fetch API type: ${i.message}. ${t}`)}return{kind:"web",fetch:n,Request:r,Response:o,Headers:s,FormData:"undefined"!==typeof FormData?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${t}`)}},Blob:"undefined"!==typeof Blob?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${t}`)}},File:"undefined"!==typeof File?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${t}`)}},getMultipartRequestOptions:async(e,t)=>({...t,body:new V(e)}),getDefaultAgent:e=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:e=>!1}}k||F(z(),{auto:!0});const H=e=>null!=e&&"object"===typeof e&&"string"===typeof e.url&&"function"===typeof e.blob,W=e=>null!=e&&"object"===typeof e&&"string"===typeof e.name&&"number"===typeof e.lastModified&&G(e),G=e=>null!=e&&"object"===typeof e&&"number"===typeof e.size&&"string"===typeof e.type&&"function"===typeof e.text&&"function"===typeof e.slice&&"function"===typeof e.arrayBuffer,J=e=>W(e)||H(e)||B(e);async function Y(e,t,n={}){var r,o,s;if(e=await e,H(e)){const o=await e.blob();return t||(t=null!==(r=new URL(e.url).pathname.split(/[\\/]/).pop())&&void 0!==r?r:"unknown_file"),new j([o],t,n)}const i=await X(e);if(t||(t=null!==(o=Z(e))&&void 0!==o?o:"unknown_file"),!n.type){const e=null===(s=i[0])||void 0===s?void 0:s.type;"string"===typeof e&&(n={...n,type:e})}return new j(i,t,n)}async function X(e){var t;let n=[];if("string"===typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)n.push(e);else if(G(e))n.push(await e.arrayBuffer());else{if(!te(e))throw new Error(`Unexpected data type: ${typeof e}; constructor: ${null===(t=null===e||void 0===e?void 0:e.constructor)||void 0===t?void 0:t.name}; props: ${Q(e)}`);for await(const t of e)n.push(t)}return n}function Q(e){const t=Object.getOwnPropertyNames(e);return`[${t.map((e=>`"${e}"`)).join(", ")}]`}function Z(e){var t;return ee(e.name)||ee(e.filename)||(null===(t=ee(e.path))||void 0===t?void 0:t.split(/[\\/]/).pop())}const ee=e=>"string"===typeof e?e:"undefined"!==typeof Buffer&&e instanceof Buffer?String(e):void 0,te=e=>null!=e&&"object"===typeof e&&"function"===typeof e[Symbol.asyncIterator],ne=e=>e&&"object"===typeof e&&e.body&&"MultipartBody"===e[Symbol.toStringTag],re=async e=>{const t=await oe(e.body);return N(t,e)},oe=async e=>{const t=new I;return await Promise.all(Object.entries(e||{}).map((([e,n])=>se(t,e,n)))),t},se=async(e,t,n)=>{if(void 0!==n){if(null==n)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if("string"===typeof n||"number"===typeof n||"boolean"===typeof n)e.append(t,String(n));else if(J(n)){const r=await Y(n);e.append(t,r)}else if(Array.isArray(n))await Promise.all(n.map((n=>se(e,t+"[]",n))));else{if("object"!==typeof n)throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`);await Promise.all(Object.entries(n).map((([n,r])=>se(e,`${t}[${n}]`,r))))}}};var ie,ae=function(e,t,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(e,n):o?o.value=n:t.set(e,n),n},le=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};const ue=2;async function ce(e){const{response:t}=e;if(e.options.stream)return new f(t,e.controller);const n=t.headers.get("content-type");if(null===n||void 0===n?void 0:n.includes("application/json")){const e=await t.json();return je("response",t.status,t.url,t.headers,e),e}const r=await t.text();return je("response",t.status,t.url,t.headers,r),r}class de extends Promise{constructor(e,t=ce){super((e=>{e(null)})),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new de(this.responsePromise,(async t=>e(await this.parseResponse(t))))}asResponse(){return this.responsePromise.then((e=>e.response))}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class he{constructor({baseURL:e,maxRetries:t,timeout:n=6e5,httpAgent:r,fetch:o}){this.baseURL=e,this.maxRetries=Pe("maxRetries",null!==t&&void 0!==t?t:ue),this.timeout=Pe("timeout",n),this.httpAgent=r,this.fetch=null!==o&&void 0!==o?o:T}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Se(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${Ne()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then((n=>({method:e,path:t,...n}))))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if("string"===typeof e){if("undefined"!==typeof Buffer)return Buffer.byteLength(e,"utf8").toString();if("undefined"!==typeof TextEncoder){const t=new TextEncoder,n=t.encode(e);return n.length.toString()}}return null}buildRequest(e){var t,n,r,o,s,i;const{method:a,path:l,query:u,headers:c={}}=e,d=ne(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,h=this.calculateContentLength(d),f=this.buildURL(l,u);"timeout"in e&&Pe("timeout",e.timeout);const p=null!==(t=e.timeout)&&void 0!==t?t:this.timeout,m=null!==(r=null!==(n=e.httpAgent)&&void 0!==n?n:this.httpAgent)&&void 0!==r?r:D(f),y=p+1e3;"number"===typeof(null===(o=null===m||void 0===m?void 0:m.options)||void 0===o?void 0:o.timeout)&&y>(null!==(s=m.options.timeout)&&void 0!==s?s:0)&&(m.options.timeout=y),this.idempotencyHeader&&"get"!==a&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),c[this.idempotencyHeader]=e.idempotencyKey);const g={...h&&{"Content-Length":h},...this.defaultHeaders(e),...c};ne(e.body)&&"node"!==k&&delete g["Content-Type"],Object.keys(g).forEach((e=>null===g[e]&&delete g[e]));const v={method:a,...d&&{body:d},headers:g,...m&&{agent:m},signal:null!==(i=e.signal)&&void 0!==i?i:null};return this.validateHeaders(g,c),{req:v,url:f,timeout:p}}async prepareRequest(e,{url:t,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map((e=>[...e]))):{...e}:{}}makeStatusError(e,t,n,r){return v.generate(e,t,n,r)}request(e,t=null){return new de(this.makeRequest(e,t))}async makeRequest(e,t){var n,r,o;const s=await e;null==t&&(t=null!==(n=s.maxRetries)&&void 0!==n?n:this.maxRetries);const{req:i,url:a,timeout:l}=this.buildRequest(s);if(await this.prepareRequest(i,{url:a,options:s}),je("request",a,s,i.headers),null===(r=s.signal)||void 0===r?void 0:r.aborted)throw new b;const u=new AbortController,c=await this.fetchWithTimeout(a,i,l,u).catch(Ce);if(c instanceof Error){if(null===(o=s.signal)||void 0===o?void 0:o.aborted)throw new b;if(t)return this.retryRequest(s,t);if("AbortError"===c.name)throw new E;throw new w({cause:c})}const d=me(c.headers);if(!c.ok){if(t&&this.shouldRetry(c))return this.retryRequest(s,t,d);const e=await c.text().catch((e=>Ce(e).message)),n=Oe(e),r=n?void 0:e;je("response",c.status,a,d,r);const o=this.makeStatusError(c.status,n,r,d);throw o}return{response:c,options:s,controller:u}}requestAPIList(e,t){const n=this.makeRequest(t,null);return new pe(this,n,e)}buildURL(e,t){const n=Ae(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),r=this.defaultQuery();return Te(r)||(t={...r,...t}),t&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter((([e,t])=>"undefined"!==typeof t)).map((([e,t])=>{if("string"===typeof t||"number"===typeof t||"boolean"===typeof t)return`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;if(null===t)return`${encodeURIComponent(e)}=`;throw new Error(`Cannot stringify type ${typeof t}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)})).join("&")}async fetchWithTimeout(e,t,n,r){const{signal:o,...s}=t||{};o&&o.addEventListener("abort",(()=>r.abort()));const i=setTimeout((()=>r.abort()),n);return this.getRequestClient().fetch.call(void 0,e,{signal:r.signal,...s}).finally((()=>{clearTimeout(i)}))}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){const t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||(409===e.status||(429===e.status||e.status>=500)))}async retryRequest(e,t,n){var r;t-=1;const o=parseInt((null===n||void 0===n?void 0:n["retry-after"])||""),s=null!==(r=e.maxRetries)&&void 0!==r?r:this.maxRetries,i=1e3*this.calculateRetryTimeoutSeconds(t,o,s);return await Re(i),this.makeRequest(e,t)}calculateRetryTimeoutSeconds(e,t,n){const r=.5,o=2;if(Number.isInteger(t)&&t<=60)return t;const s=n-e,i=Math.min(r*Math.pow(s-1,2),o),a=Math.random()-.5;return i+a}getUserAgent(){return`${this.constructor.name}/JS ${h}`}}class fe{constructor(e,t,n,r){ie.set(this,void 0),ae(this,ie,e,"f"),this.options=r,this.response=t,this.body=n}hasNextPage(){const e=this.getPaginatedItems();return!!e.length&&null!=this.nextPageInfo()}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new Error("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e)t.query={...t.query,...e.params};else if("url"in e){const n=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[t,r]of n)e.url.searchParams.set(t,r);t.query=void 0,t.path=e.url.toString()}return await le(this,ie,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;yield e;while(e.hasNextPage())e=await e.getNextPage(),yield e}async*[(ie=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class pe extends de{constructor(e,t,n){super(t,(async t=>new n(e,t.response,await ce(t),t.options)))}async*[Symbol.asyncIterator](){const e=await(this);for await(const t of e)yield t}}const me=e=>new Proxy(Object.fromEntries(e.entries()),{get(e,t){const n=t.toString();return e[n.toLowerCase()]||e[n]}}),ye={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0},ge=e=>"object"===typeof e&&null!==e&&!Te(e)&&Object.keys(e).every((e=>Ie(ye,e))),ve=()=>{if("undefined"!==typeof Deno&&null!=Deno.build)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":h,"X-Stainless-OS":Ee(Deno.build.os),"X-Stainless-Arch":we(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":Deno.version};if("undefined"!==typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":h,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if("[object process]"===Object.prototype.toString.call("undefined"!==typeof process?process:0))return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":h,"X-Stainless-OS":Ee(process.platform),"X-Stainless-Arch":we(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const e=be();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":h,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":h,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function be(){if("undefined"===typeof navigator||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const e=n.exec(navigator.userAgent);if(e){const n=e[1]||0,r=e[2]||0,o=e[3]||0;return{browser:t,version:`${n}.${r}.${o}`}}}return null}const we=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",Ee=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown");let _e;const Se=()=>null!==_e&&void 0!==_e?_e:_e=ve(),Oe=e=>{try{return JSON.parse(e)}catch(t){return}},xe=new RegExp("^(?:[a-z]+:)?//","i"),Ae=e=>xe.test(e),Re=e=>new Promise((t=>setTimeout(t,e))),Pe=(e,t)=>{if("number"!==typeof t||!Number.isInteger(t))throw new Error(`${e} must be an integer`);if(t<0)throw new Error(`${e} must be a positive integer`);return t},Ce=e=>e instanceof Error?e:new Error(e),ke=e=>{var t,n,r,o;return"undefined"!==typeof process?null!==(n=null===(t={NODE_ENV:"production",BASE_URL:"/"})||void 0===t?void 0:t[e])&&void 0!==n?n:void 0:"undefined"!==typeof Deno?null===(o=null===(r=Deno.env)||void 0===r?void 0:r.get)||void 0===o?void 0:o.call(r,e):void 0};function Te(e){if(!e)return!0;for(const t in e)return!1;return!0}function Ie(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function je(e,...t){"undefined"!==typeof process&&"true"==={NODE_ENV:"production",BASE_URL:"/"}["DEBUG"]&&console.log(`OpenAI:DEBUG:${e}`,...t)}const Ne=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0,n="x"===e?t:3&t|8;return n.toString(16)})),De=()=>"undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof navigator;class qe extends fe{constructor(e,t,n,r){super(e,t,n,r),this.object=n.object,this.data=n.data}getPaginatedItems(){return this.data}nextPageParams(){return null}nextPageInfo(){return null}}class Be extends fe{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data}getPaginatedItems(){return this.data}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var e,t;if(!(null===(e=this.data)||void 0===e?void 0:e.length))return null;const n=null===(t=this.data[this.data.length-1])||void 0===t?void 0:t.id;return n?{params:{after:n}}:null}}class Ue{constructor(e){this.client=e,this.get=e.get.bind(e),this.post=e.post.bind(e),this.patch=e.patch.bind(e),this.put=e.put.bind(e),this.delete=e.delete.bind(e),this.getAPIList=e.getAPIList.bind(e)}}class Me extends Ue{create(e,t){var n;return this.post("/completions",{body:e,...t,stream:null!==(n=e.stream)&&void 0!==n&&n})}}Me||(Me={});class Ke extends Ue{create(e,t){var n;return this.post("/chat/completions",{body:e,...t,stream:null!==(n=e.stream)&&void 0!==n&&n})}}Ke||(Ke={});class Le extends Ue{constructor(){super(...arguments),this.completions=new Ke(this.client)}}(function(e){e.Completions=Ke})(Le||(Le={}));class $e extends Ue{create(e,t){return this.post("/edits",{body:e,...t})}}$e||($e={});class Fe extends Ue{create(e,t){return this.post("/embeddings",{body:e,...t})}}Fe||(Fe={});class Ve extends Ue{create(e,t){return this.post("/files",re({body:e,...t}))}retrieve(e,t){return this.get(`/files/${e}`,t)}list(e){return this.getAPIList("/files",ze,e)}del(e,t){return this.delete(`/files/${e}`,t)}retrieveContent(e,t){return this.get(`/files/${e}/content`,{...t,headers:{Accept:"application/json",...null===t||void 0===t?void 0:t.headers}})}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:n=18e5}={}){const r=new Set(["processed","error","deleted"]),o=Date.now();let s=await this.retrieve(e);while(!s.status||!r.has(s.status))if(await Re(t),s=await this.retrieve(e),Date.now()-o>n)throw new E({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return s}}class ze extends qe{}Ve||(Ve={});class He extends Ue{createVariation(e,t){return this.post("/images/variations",re({body:e,...t}))}edit(e,t){return this.post("/images/edits",re({body:e,...t}))}generate(e,t){return this.post("/images/generations",{body:e,...t})}}He||(He={});class We extends Ue{create(e,t){return this.post("/audio/transcriptions",re({body:e,...t}))}}We||(We={});class Ge extends Ue{create(e,t){return this.post("/audio/translations",re({body:e,...t}))}}Ge||(Ge={});class Je extends Ue{constructor(){super(...arguments),this.transcriptions=new We(this.client),this.translations=new Ge(this.client)}}(function(e){e.Transcriptions=We,e.Translations=Ge})(Je||(Je={}));class Ye extends Ue{create(e,t){return this.post("/moderations",{body:e,...t})}}Ye||(Ye={});class Xe extends Ue{retrieve(e,t){return this.get(`/models/${e}`,t)}list(e){return this.getAPIList("/models",Qe,e)}del(e,t){return this.delete(`/models/${e}`,t)}}class Qe extends qe{}Xe||(Xe={});class Ze extends Ue{create(e,t){return this.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return ge(e)?this.list({},e):this.getAPIList("/fine_tuning/jobs",et,{query:e,...t})}cancel(e,t){return this.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},n){return ge(t)?this.listEvents(e,{},t):this.getAPIList(`/fine_tuning/jobs/${e}/events`,tt,{query:t,...n})}}class et extends Be{}class tt extends Be{}Ze||(Ze={});class nt extends Ue{constructor(){super(...arguments),this.jobs=new Ze(this.client)}}(function(e){e.Jobs=Ze,e.FineTuningJobsPage=et,e.FineTuningJobEventsPage=tt})(nt||(nt={}));class rt extends Ue{create(e,t){return this.post("/fine-tunes",{body:e,...t})}retrieve(e,t){return this.get(`/fine-tunes/${e}`,t)}list(e){return this.getAPIList("/fine-tunes",ot,e)}cancel(e,t){return this.post(`/fine-tunes/${e}/cancel`,t)}listEvents(e,t,n){var r;return this.get(`/fine-tunes/${e}/events`,{query:t,timeout:864e5,...n,stream:null!==(r=null===t||void 0===t?void 0:t.stream)&&void 0!==r&&r})}}class ot extends qe{}var st;rt||(rt={});class it extends he{constructor(e){var t,n,r,{apiKey:o=ke("OPENAI_API_KEY"),organization:s=(null!==(t=ke("OPENAI_ORG_ID"))&&void 0!==t?t:null),...i}=void 0===e?{}:e;if(void 0===o)throw new Error("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'my apiKey' }).");const a={apiKey:o,organization:s,...i,baseURL:null!==(n=i.baseURL)&&void 0!==n?n:"https://api.openai.com/v1"};if(!a.dangerouslyAllowBrowser&&De())throw new Error("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");super({baseURL:a.baseURL,timeout:null!==(r=a.timeout)&&void 0!==r?r:6e5,httpAgent:a.httpAgent,maxRetries:a.maxRetries,fetch:a.fetch}),this.completions=new Me(this),this.chat=new Le(this),this.edits=new $e(this),this.embeddings=new Fe(this),this.files=new Ve(this),this.images=new He(this),this.audio=new Je(this),this.moderations=new Ye(this),this.models=new Xe(this),this.fineTuning=new nt(this),this.fineTunes=new rt(this),this._options=a,this.apiKey=o,this.organization=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}}st=it,it.OpenAI=st,it.APIError=v,it.APIConnectionError=w,it.APIConnectionTimeoutError=E,it.APIUserAbortError=b,it.NotFoundError=x,it.ConflictError=A,it.RateLimitError=P,it.BadRequestError=_,it.AuthenticationError=S,it.InternalServerError=C,it.PermissionDeniedError=O,it.UnprocessableEntityError=R;const{APIError:at,APIConnectionError:lt,APIConnectionTimeoutError:ut,APIUserAbortError:ct,NotFoundError:dt,ConflictError:ht,RateLimitError:ft,BadRequestError:pt,AuthenticationError:mt,InternalServerError:yt,PermissionDeniedError:gt,UnprocessableEntityError:vt}=r;(function(e){e.toFile=Y,e.fileFromPath=q,e.Page=qe,e.CursorPage=Be,e.Completions=Me,e.Chat=Le,e.Edits=$e,e.Embeddings=Fe,e.Files=Ve,e.FileObjectsPage=ze,e.Images=He,e.Audio=Je,e.Moderations=Ye,e.Models=Xe,e.ModelsPage=Qe,e.FineTuning=nt,e.FineTunes=rt,e.FineTunesPage=ot})(it||(it={}));var bt=it,wt=n(9255);function Et(e,t){const n={apiKey:e,baseURL:t||"https://api.openai.com/v1",dangerouslyAllowBrowser:!0};return n}async function _t(e,t,n,r,o,s,i,a,l){const u=new bt(e);Object.keys(wt.o2).includes(l??"")&&(l=wt.o2[l??""]);const c={model:l??"gpt-4o",messages:t,temperature:a??.9,max_tokens:i??2500};let d;try{d=await u.chat.completions.create(c),n.value=d.choices[0].message?.content?.replace(/\\n/g,"\n")??"",r.value.push({role:"assistant",content:n.value})}catch(h){h instanceof bt.APIError?(n.value=h.message,o.value=!0,console.error(h.message)):(n.value=String(h),o.value=!0,console.error(h))}s.value=!1}var St={setConfig:Et,createChatCompletionStream:_t};function Ot(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}Object.create;function xt(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function At(e){return this instanceof At?(this.v=e,this):new At(e)}function Rt(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),s=[];return r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r;function i(e){o[e]&&(r[e]=function(t){return new Promise((function(n,r){s.push([e,t,n,r])>1||a(e,t)}))})}function a(e,t){try{l(o[e](t))}catch(ku){d(s[0][3],ku)}}function l(e){e.value instanceof At?Promise.resolve(e.value.v).then(u,c):d(s[0][2],e)}function u(e){a("next",e)}function c(e){a("throw",e)}function d(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function Pt(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"===typeof xt?xt(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,s){t=e[n](t),o(r,s,t.done,t.value)}))}}function o(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}}Object.create;"function"===typeof SuppressedError&&SuppressedError;function Ct(e){const t=e;return t&&"function"===typeof t.getToken&&(void 0===t.signRequest||t.getToken.length>0)}class kt extends Error{constructor(e){super(e),this.name="AbortError"}}const Tt="The operation was aborted.";function It(e,t,n){return new Promise(((r,o)=>{let s,i;const a=()=>o(new kt((null===n||void 0===n?void 0:n.abortErrorMsg)?null===n||void 0===n?void 0:n.abortErrorMsg:Tt)),l=()=>{(null===n||void 0===n?void 0:n.abortSignal)&&i&&n.abortSignal.removeEventListener("abort",i)};if(i=()=>(s&&clearTimeout(s),l(),a()),(null===n||void 0===n?void 0:n.abortSignal)&&n.abortSignal.aborted)return a();s=setTimeout((()=>{l(),r(t)}),e),(null===n||void 0===n?void 0:n.abortSignal)&&n.abortSignal.addEventListener("abort",i)}))}function jt(e,t){const n=e.headers.get(t);if(!n)return;const r=Number(n);return Number.isNaN(r)?void 0:r}const Nt={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:12e4};async function Dt(e,t,n){async function r(){if(!(Date.now()<n)){const t=await e();if(null===t)throw new Error("Failed to refresh access token.");return t}try{return await e()}catch(st){return null}}let o=await r();while(null===o)await It(t),o=await r();return o}function qt(e,t){let n,r=null,o=null;const s=Object.assign(Object.assign({},Nt),t),i={get isRefreshing(){return null!==r},get shouldRefresh(){var e;return!i.isRefreshing&&(null!==(e=null===o||void 0===o?void 0:o.expiresOnTimestamp)&&void 0!==e?e:0)-s.refreshWindowInMs<Date.now()},get mustRefresh(){return null===o||o.expiresOnTimestamp-s.forcedRefreshWindowInMs<Date.now()}};function a(t,a){var l;if(!i.isRefreshing){const i=()=>e.getToken(t,a);r=Dt(i,s.retryIntervalInMs,null!==(l=null===o||void 0===o?void 0:o.expiresOnTimestamp)&&void 0!==l?l:Date.now()).then((e=>(r=null,o=e,n=a.tenantId,o))).catch((e=>{throw r=null,o=null,n=void 0,e}))}return r}return async(e,t)=>{const r=n!==t.tenantId||Boolean(t.claims)||i.mustRefresh;return r?a(e,t):(i.shouldRefresh&&a(e,t),o)}}function Bt(...e){if(e.length>0){const t=String(e[0]);t.includes(":error")?console.error(...e):t.includes(":warning")?console.warn(...e):t.includes(":info")?console.info(...e):(t.includes(":verbose"),console.debug(...e))}}const Ut="undefined"!==typeof process&&{NODE_ENV:"production",BASE_URL:"/"}&&{NODE_ENV:"production",BASE_URL:"/"}.DEBUG||void 0;let Mt,Kt=[],Lt=[];const $t=[];Ut&&Vt(Ut);const Ft=Object.assign((e=>Wt(e)),{enable:Vt,enabled:zt,disable:Ht,log:Bt});function Vt(e){Mt=e,Kt=[],Lt=[];const t=/\*/g,n=e.split(",").map((e=>e.trim().replace(t,".*?")));for(const r of n)r.startsWith("-")?Lt.push(new RegExp(`^${r.substr(1)}$`)):Kt.push(new RegExp(`^${r}$`));for(const r of $t)r.enabled=zt(r.namespace)}function zt(e){if(e.endsWith("*"))return!0;for(const t of Lt)if(t.test(e))return!1;for(const t of Kt)if(t.test(e))return!0;return!1}function Ht(){const e=Mt||"";return Vt(""),e}function Wt(e){const t=Object.assign(n,{enabled:zt(e),destroy:Gt,log:Ft.log,namespace:e,extend:Jt});function n(...n){t.enabled&&(n.length>0&&(n[0]=`${e} ${n[0]}`),t.log(...n))}return $t.push(t),t}function Gt(){const e=$t.indexOf(this);return e>=0&&($t.splice(e,1),!0)}function Jt(e){const t=Wt(`${this.namespace}:${e}`);return t.log=this.log,t}var Yt=Ft;const Xt=new Set,Qt="undefined"!==typeof process&&{NODE_ENV:"production",BASE_URL:"/"}&&{NODE_ENV:"production",BASE_URL:"/"}.AZURE_LOG_LEVEL||void 0;let Zt;const en=Yt("azure");en.log=(...e)=>{Yt.log(...e)};const tn=["verbose","info","warning","error"];function nn(e){if(e&&!un(e))throw new Error(`Unknown log level '${e}'. Acceptable values: ${tn.join(",")}`);Zt=e;const t=[];for(const n of Xt)ln(n)&&t.push(n.namespace);Yt.enable(t.join(","))}Qt&&(un(Qt)?nn(Qt):console.error(`AZURE_LOG_LEVEL set to unknown log level '${Qt}'; logging is not enabled. Acceptable values: ${tn.join(", ")}.`));const rn={verbose:400,info:300,warning:200,error:100};function on(e){const t=en.extend(e);return sn(en,t),{error:an(t,"error"),warning:an(t,"warning"),info:an(t,"info"),verbose:an(t,"verbose")}}function sn(e,t){t.log=(...t)=>{e.log(...t)}}function an(e,t){const n=Object.assign(e.extend(t),{level:t});if(sn(e,n),ln(n)){const e=Yt.disable();Yt.enable(e+","+n.namespace)}return Xt.add(n),n}function ln(e){return Boolean(Zt&&rn[e.level]<=rn[Zt])}function un(e){return tn.includes(e)}const cn=on("core-rest-pipeline"),dn="bearerTokenAuthenticationPolicy";async function hn(e){const{scopes:t,getAccessToken:n,request:r}=e,o={abortSignal:r.abortSignal,tracingOptions:r.tracingOptions},s=await n(t,o);s&&e.request.headers.set("Authorization",`Bearer ${s.token}`)}function fn(e){const t=e.headers.get("WWW-Authenticate");if(401===e.status&&t)return t}function pn(e){var t;const{credential:n,scopes:r,challengeCallbacks:o}=e,s=e.logger||cn,i=Object.assign({authorizeRequest:null!==(t=null===o||void 0===o?void 0:o.authorizeRequest)&&void 0!==t?t:hn,authorizeRequestOnChallenge:null===o||void 0===o?void 0:o.authorizeRequestOnChallenge},o),a=n?qt(n):()=>Promise.resolve(null);return{name:dn,async sendRequest(e,t){if(!e.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");let n,o;await i.authorizeRequest({scopes:Array.isArray(r)?r:[r],request:e,getAccessToken:a,logger:s});try{n=await t(e)}catch(l){o=l,n=l.response}if(i.authorizeRequestOnChallenge&&401===(null===n||void 0===n?void 0:n.status)&&fn(n)){const o=await i.authorizeRequestOnChallenge({scopes:Array.isArray(r)?r:[r],request:e,response:n,getAccessToken:a,logger:s});if(o)return t(e)}if(o)throw o;return n}}}function mn(e){return"object"===typeof e&&null!==e&&!Array.isArray(e)&&!(e instanceof RegExp)&&!(e instanceof Date)}const yn="REDACTED",gn=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],vn=["api-version"];class bn{constructor({additionalAllowedHeaderNames:e=[],additionalAllowedQueryParameters:t=[]}={}){e=gn.concat(e),t=vn.concat(t),this.allowedHeaderNames=new Set(e.map((e=>e.toLowerCase()))),this.allowedQueryParameters=new Set(t.map((e=>e.toLowerCase())))}sanitize(e){const t=new Set;return JSON.stringify(e,((e,n)=>{if(n instanceof Error)return Object.assign(Object.assign({},n),{name:n.name,message:n.message});if("headers"===e)return this.sanitizeHeaders(n);if("url"===e)return this.sanitizeUrl(n);if("query"===e)return this.sanitizeQuery(n);if("body"!==e&&"response"!==e&&"operationSpec"!==e){if(Array.isArray(n)||mn(n)){if(t.has(n))return"[Circular]";t.add(n)}return n}}),2)}sanitizeHeaders(e){const t={};for(const n of Object.keys(e))this.allowedHeaderNames.has(n.toLowerCase())?t[n]=e[n]:t[n]=yn;return t}sanitizeQuery(e){if("object"!==typeof e||null===e)return e;const t={};for(const n of Object.keys(e))this.allowedQueryParameters.has(n.toLowerCase())?t[n]=e[n]:t[n]=yn;return t}sanitizeUrl(e){if("string"!==typeof e||null===e)return e;const t=new URL(e);if(!t.search)return e;for(const[n]of t.searchParams)this.allowedQueryParameters.has(n.toLowerCase())||t.searchParams.set(n,yn);return t.toString()}}const wn="logPolicy";function En(e={}){var t;const n=null!==(t=e.logger)&&void 0!==t?t:cn.info,r=new bn({additionalAllowedHeaderNames:e.additionalAllowedHeaderNames,additionalAllowedQueryParameters:e.additionalAllowedQueryParameters});return{name:wn,async sendRequest(e,t){if(!n.enabled)return t(e);n(`Request: ${r.sanitize(e)}`);const o=await t(e);return n(`Response status code: ${o.status}`),n(`Headers: ${r.sanitize(o.headers)}`),o}}}const _n=new Set(["Deserialize","Serialize","Retry","Sign"]);class Sn{constructor(e){var t;this._policies=[],this._policies=null!==(t=null===e||void 0===e?void 0:e.slice(0))&&void 0!==t?t:[],this._orderedPolicies=void 0}addPolicy(e,t={}){if(t.phase&&t.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(t.phase&&!_n.has(t.phase))throw new Error(`Invalid phase name: ${t.phase}`);if(t.afterPhase&&!_n.has(t.afterPhase))throw new Error(`Invalid afterPhase name: ${t.afterPhase}`);this._policies.push({policy:e,options:t}),this._orderedPolicies=void 0}removePolicy(e){const t=[];return this._policies=this._policies.filter((n=>!(e.name&&n.policy.name===e.name||e.phase&&n.options.phase===e.phase)||(t.push(n.policy),!1))),this._orderedPolicies=void 0,t}sendRequest(e,t){const n=this.getOrderedPolicies(),r=n.reduceRight(((e,t)=>n=>t.sendRequest(n,e)),(t=>e.sendRequest(t)));return r(t)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new Sn(this._policies)}static create(){return new Sn}orderPolicies(){const e=[],t=new Map;function n(e){return{name:e,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}const r=n("Serialize"),o=n("None"),s=n("Deserialize"),i=n("Retry"),a=n("Sign"),l=[r,o,s,i,a];function u(e){return"Retry"===e?i:"Serialize"===e?r:"Deserialize"===e?s:"Sign"===e?a:o}for(const f of this._policies){const e=f.policy,n=f.options,r=e.name;if(t.has(r))throw new Error("Duplicate policy names not allowed in pipeline");const o={policy:e,dependsOn:new Set,dependants:new Set};n.afterPhase&&(o.afterPhase=u(n.afterPhase),o.afterPhase.hasAfterPolicies=!0),t.set(r,o);const s=u(n.phase);s.policies.add(o)}for(const f of this._policies){const{policy:e,options:n}=f,r=e.name,o=t.get(r);if(!o)throw new Error(`Missing node for policy ${r}`);if(n.afterPolicies)for(const s of n.afterPolicies){const e=t.get(s);e&&(o.dependsOn.add(e),e.dependants.add(o))}if(n.beforePolicies)for(const s of n.beforePolicies){const e=t.get(s);e&&(e.dependsOn.add(o),o.dependants.add(e))}}function c(n){n.hasRun=!0;for(const r of n.policies)if((!r.afterPhase||r.afterPhase.hasRun&&!r.afterPhase.policies.size)&&0===r.dependsOn.size){e.push(r.policy);for(const e of r.dependants)e.dependsOn.delete(r);t.delete(r.policy.name),n.policies.delete(r)}}function d(){for(const e of l){if(c(e),e.policies.size>0&&e!==o)return void(o.hasRun||c(o));e.hasAfterPolicies&&c(o)}}let h=0;while(t.size>0){h++;const t=e.length;if(d(),e.length<=t&&h>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return e}}function On(){return Sn.create()}const xn="redirectPolicy",An=["GET","HEAD"];function Rn(e={}){const{maxRetries:t=20}=e;return{name:xn,async sendRequest(e,n){const r=await n(e);return Pn(n,r,t)}}}async function Pn(e,t,n,r=0){const{request:o,status:s,headers:i}=t,a=i.get("location");if(a&&(300===s||301===s&&An.includes(o.method)||302===s&&An.includes(o.method)||303===s&&"POST"===o.method||307===s)&&r<n){const t=new URL(a,o.url);o.url=t.toString(),303===s&&(o.method="GET",o.headers.delete("Content-Length"),delete o.body),o.headers.delete("Authorization");const i=await e(o);return Pn(e,i,n,r+1)}return t}function Cn(){return"x-ms-useragent"}function kn(e){var t,n,r;const o=globalThis.navigator;e.set("OS",(null!==(r=null!==(n=null===(t=null===o||void 0===o?void 0:o.userAgentData)||void 0===t?void 0:t.platform)&&void 0!==n?n:null===o||void 0===o?void 0:o.platform)&&void 0!==r?r:"unknown").replace(" ",""))}const Tn="1.12.0",In=3;function jn(e){const t=[];for(const[n,r]of e){const e=r?`${n}/${r}`:n;t.push(e)}return t.join(" ")}function Nn(){return Cn()}function Dn(e){const t=new Map;t.set("core-rest-pipeline",Tn),kn(t);const n=jn(t),r=e?`${e} ${n}`:n;return r}const qn=Nn(),Bn="userAgentPolicy";function Un(e={}){const t=Dn(e.userAgentPrefix);return{name:Bn,async sendRequest(e,n){return e.headers.has(qn)||e.headers.set(qn,t),n(e)}}}const Mn=new Error("decompressResponsePolicy is not supported in browser environment");function Kn(){throw Mn}function Ln(e,t){e=Math.ceil(e),t=Math.floor(t);const n=Math.floor(Math.random()*(t-e+1));return n+e}const $n="Retry-After",Fn=["retry-after-ms","x-ms-retry-after-ms",$n];function Vn(e){if(e&&[429,503].includes(e.status))try{for(const o of Fn){const t=jt(e,o);if(0===t||t){const e=o===$n?1e3:1;return t*e}}const t=e.headers.get($n);if(!t)return;const n=Date.parse(t),r=n-Date.now();return Number.isFinite(r)?Math.max(0,r):void 0}catch(ku){return}}function zn(e){return Number.isFinite(Vn(e))}function Hn(){return{name:"throttlingRetryStrategy",retry({response:e}){const t=Vn(e);return Number.isFinite(t)?{retryAfterInMs:t}:{skipStrategy:!0}}}}const Wn=1e3,Gn=64e3;function Jn(e={}){var t,n;const r=null!==(t=e.retryDelayInMs)&&void 0!==t?t:Wn,o=null!==(n=e.maxRetryDelayInMs)&&void 0!==n?n:Gn;let s=r;return{name:"exponentialRetryStrategy",retry({retryCount:t,response:n,responseError:r}){const i=Xn(r),a=i&&e.ignoreSystemErrors,l=Yn(n),u=l&&e.ignoreHttpStatusCodes,c=n&&(zn(n)||!l);if(c||u||a)return{skipStrategy:!0};if(r&&!i&&!l)return{errorToThrow:r};const d=s*Math.pow(2,t),h=Math.min(o,d);return s=h/2+Ln(0,h/2),{retryAfterInMs:s}}}}function Yn(e){return Boolean(e&&void 0!==e.status&&(e.status>=500||408===e.status)&&501!==e.status&&505!==e.status)}function Xn(e){return!!e&&("ETIMEDOUT"===e.code||"ESOCKETTIMEDOUT"===e.code||"ECONNREFUSED"===e.code||"ECONNRESET"===e.code||"ENOENT"===e.code)}const Qn=on("core-rest-pipeline retryPolicy"),Zn="retryPolicy";function er(e,t={maxRetries:In}){const n=t.logger||Qn;return{name:Zn,async sendRequest(r,o){var s,i;let a,l,u=-1;e:while(1){u+=1,a=void 0,l=void 0;try{n.info(`Retry ${u}: Attempting to send request`,r.requestId),a=await o(r),n.info(`Retry ${u}: Received a response from request`,r.requestId)}catch(ku){if(n.error(`Retry ${u}: Received an error from request`,r.requestId),l=ku,!ku||"RestError"!==l.name)throw ku;a=l.response}if(null===(s=r.abortSignal)||void 0===s?void 0:s.aborted){n.error(`Retry ${u}: Request aborted.`);const e=new kt;throw e}if(u>=(null!==(i=t.maxRetries)&&void 0!==i?i:In)){if(n.info(`Retry ${u}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),l)throw l;if(a)return a;throw new Error("Maximum retries reached with no response or error to throw")}n.info(`Retry ${u}: Processing ${e.length} retry strategies.`);t:for(const t of e){const e=t.logger||Qn;e.info(`Retry ${u}: Processing retry strategy ${t.name}.`);const n=t.retry({retryCount:u,response:a,responseError:l});if(n.skipStrategy){e.info(`Retry ${u}: Skipped.`);continue t}const{errorToThrow:o,retryAfterInMs:s,redirectTo:i}=n;if(o)throw e.error(`Retry ${u}: Retry strategy ${t.name} throws error:`,o),o;if(s||0===s){e.info(`Retry ${u}: Retry strategy ${t.name} retries after ${s}`),await It(s,void 0,{abortSignal:r.abortSignal});continue e}if(i){e.info(`Retry ${u}: Retry strategy ${t.name} redirects to ${i}`),r.url=i;continue e}}if(l)throw n.info("None of the retry strategies could work with the received error. Throwing it."),l;if(a)return n.info("None of the retry strategies could work with the received response. Returning it."),a}}}}const tr="defaultRetryPolicy";function nr(e={}){var t;return{name:tr,sendRequest:er([Hn(),Jn(e)],{maxRetries:null!==(t=e.maxRetries)&&void 0!==t?t:In}).sendRequest}}const rr="formDataPolicy";function or(){return{name:rr,async sendRequest(e,t){if(e.formData){const t=e.formData,n=new FormData;for(const e of Object.keys(t)){const r=t[e];if(Array.isArray(r))for(const t of r)n.append(e,t);else n.append(e,r)}e.body=n,e.formData=void 0;const r=e.headers.get("Content-Type");r&&-1!==r.indexOf("application/x-www-form-urlencoded")?e.body=new URLSearchParams(n).toString():r&&-1!==r.indexOf("multipart/form-data")&&e.headers.delete("Content-Type")}return t(e)}}}var sr,ir,ar,lr;"undefined"!==typeof window&&window.document,"object"===typeof self&&"function"===typeof(null===self||void 0===self?void 0:self.importScripts)&&("DedicatedWorkerGlobalScope"===(null===(sr=self.constructor)||void 0===sr?void 0:sr.name)||"ServiceWorkerGlobalScope"===(null===(ir=self.constructor)||void 0===ir?void 0:ir.name)||null===(ar=self.constructor)||void 0===ar||ar.name);const ur="undefined"!==typeof process&&Boolean(process.version)&&Boolean(null===(lr=process.versions)||void 0===lr?void 0:lr.node),cr=("undefined"!==typeof Deno&&"undefined"!==typeof Deno.version&&Deno.version.deno,"undefined"!==typeof Bun&&Bun.version,"undefined"!==typeof navigator&&(null===navigator||void 0===navigator||navigator.product),new Error("proxyPolicy is not supported in browser environment"));function dr(){throw cr}const hr="setClientRequestIdPolicy";function fr(e="x-ms-client-request-id"){return{name:hr,async sendRequest(t,n){return t.headers.has(e)||t.headers.set(e,t.requestId),n(t)}}}const pr="tlsPolicy";function mr(e){return{name:pr,sendRequest:async(t,n)=>(t.tlsSettings||(t.tlsSettings=e),n(t))}}const yr={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};function gr(e={}){let t=new vr(e.parentContext);return e.span&&(t=t.setValue(yr.span,e.span)),e.namespace&&(t=t.setValue(yr.namespace,e.namespace)),t}class vr{constructor(e){this._contextMap=e instanceof vr?new Map(e._contextMap):new Map}setValue(e,t){const n=new vr(this);return n._contextMap.set(e,t),n}getValue(e){return this._contextMap.get(e)}deleteValue(e){const t=new vr(this);return t._contextMap.delete(e),t}}function br(){return{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{}}}function wr(){return{createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(e,t)=>({span:br(),tracingContext:gr({parentContext:t.tracingContext})}),withContext(e,t,...n){return t(...n)}}}let Er;function _r(){return Er||(Er=wr()),Er}function Sr(e){const{namespace:t,packageName:n,packageVersion:r}=e;function o(e,o,s){var i;const a=_r().startSpan(e,Object.assign(Object.assign({},s),{packageName:n,packageVersion:r,tracingContext:null===(i=null===o||void 0===o?void 0:o.tracingOptions)||void 0===i?void 0:i.tracingContext}));let l=a.tracingContext;const u=a.span;l.getValue(yr.namespace)||(l=l.setValue(yr.namespace,t)),u.setAttribute("az.namespace",l.getValue(yr.namespace));const c=Object.assign({},o,{tracingOptions:Object.assign(Object.assign({},null===o||void 0===o?void 0:o.tracingOptions),{tracingContext:l})});return{span:u,updatedOptions:c}}async function s(e,t,n,r){const{span:s,updatedOptions:a}=o(e,t,r);try{const e=await i(a.tracingOptions.tracingContext,(()=>Promise.resolve(n(a,s))));return s.setStatus({status:"success"}),e}catch(l){throw s.setStatus({status:"error",error:l}),l}finally{s.end()}}function i(e,t,...n){return _r().withContext(e,t,...n)}function a(e){return _r().parseTraceparentHeader(e)}function l(e){return _r().createRequestHeaders(e)}return{startSpan:o,withSpan:s,withContext:i,parseTraceparentHeader:a,createRequestHeaders:l}}function Or(e){if(mn(e)){const t="string"===typeof e.name,n="string"===typeof e.message;return t&&n}return!1}function xr(e){if(Or(e))return e.message;{let n;try{n="object"===typeof e&&e?JSON.stringify(e):String(e)}catch(t){n="[unable to stringify input]"}return`Unknown error ${n}`}}const Ar={},Rr=new bn;class Pr extends Error{constructor(e,t={}){super(e),this.name="RestError",this.code=t.code,this.statusCode=t.statusCode,this.request=t.request,this.response=t.response,Object.setPrototypeOf(this,Pr.prototype)}[Ar](){return`RestError: ${this.message} \n ${Rr.sanitize(this)}`}}function Cr(e){return e instanceof Pr||Or(e)&&"RestError"===e.name}Pr.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",Pr.PARSE_ERROR="PARSE_ERROR";const kr="tracingPolicy";function Tr(e={}){const t=Dn(e.userAgentPrefix),n=Ir();return{name:kr,async sendRequest(e,r){var o,s;if(!n||!(null===(o=e.tracingOptions)||void 0===o?void 0:o.tracingContext))return r(e);const{span:i,tracingContext:a}=null!==(s=jr(n,e,t))&&void 0!==s?s:{};if(!i||!a)return r(e);try{const t=await n.withContext(a,r,e);return Dr(i,t),t}catch(l){throw Nr(i,l),l}}}}function Ir(){try{return Sr({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:Tn})}catch(ku){return void cn.warning(`Error when creating the TracingClient: ${xr(ku)}`)}}function jr(e,t,n){try{const{span:r,updatedOptions:o}=e.startSpan(`HTTP ${t.method}`,{tracingOptions:t.tracingOptions},{spanKind:"client",spanAttributes:{"http.method":t.method,"http.url":t.url,requestId:t.requestId}});if(!r.isRecording())return void r.end();n&&r.setAttribute("http.user_agent",n);const s=e.createRequestHeaders(o.tracingOptions.tracingContext);for(const[e,n]of Object.entries(s))t.headers.set(e,n);return{span:r,tracingContext:o.tracingOptions.tracingContext}}catch(ku){return void cn.warning(`Skipping creating a tracing span due to an error: ${xr(ku)}`)}}function Nr(e,t){try{e.setStatus({status:"error",error:Or(t)?t:void 0}),Cr(t)&&t.statusCode&&e.setAttribute("http.status_code",t.statusCode),e.end()}catch(ku){cn.warning(`Skipping tracing span processing due to an error: ${xr(ku)}`)}}function Dr(e,t){try{e.setAttribute("http.status_code",t.status);const n=t.headers.get("x-ms-request-id");n&&e.setAttribute("serviceRequestId",n),e.setStatus({status:"success"}),e.end()}catch(ku){cn.warning(`Skipping tracing span processing due to an error: ${xr(ku)}`)}}function qr(e){var t;const n=On();return ur&&(e.tlsOptions&&n.addPolicy(mr(e.tlsOptions)),n.addPolicy(dr(e.proxyOptions)),n.addPolicy(Kn())),n.addPolicy(or()),n.addPolicy(Un(e.userAgentOptions)),n.addPolicy(fr(null===(t=e.telemetryOptions)||void 0===t?void 0:t.clientRequestIdHeaderName)),n.addPolicy(nr(e.retryOptions),{phase:"Retry"}),n.addPolicy(Tr(e.userAgentOptions),{afterPhase:"Retry"}),ur&&n.addPolicy(Rn(e.redirectOptions),{afterPhase:"Retry"}),n.addPolicy(En(e.loggingOptions),{afterPhase:"Sign"}),n}function Br(e){return e.toLowerCase()}function*Ur(e){for(const t of e.values())yield[t.name,t.value]}class Mr{constructor(e){if(this._headersMap=new Map,e)for(const t of Object.keys(e))this.set(t,e[t])}set(e,t){this._headersMap.set(Br(e),{name:e,value:String(t)})}get(e){var t;return null===(t=this._headersMap.get(Br(e)))||void 0===t?void 0:t.value}has(e){return this._headersMap.has(Br(e))}delete(e){this._headersMap.delete(Br(e))}toJSON(e={}){const t={};if(e.preserveCase)for(const n of this._headersMap.values())t[n.name]=n.value;else for(const[n,r]of this._headersMap)t[n]=r.value;return t}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return Ur(this._headersMap)}}function Kr(e){return new Mr(e)}function Lr(e){return e&&"function"===typeof e.pipe}function $r(e){return Boolean(e&&"function"===typeof e.getReader&&"function"===typeof e.tee)}function Fr(e){return("function"===typeof Blob||"object"===typeof Blob)&&e instanceof Blob}class Vr{async sendRequest(e){const t=new URL(e.url),n="https:"!==t.protocol;if(n&&!e.allowInsecureConnection)throw new Error(`Cannot connect to ${e.url} while allowInsecureConnection is false.`);if(e.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");try{return await zr(e)}catch(ku){throw Gr(ku,e)}}}async function zr(e){const{abortController:t,abortControllerCleanup:n}=Wr(e);try{const n=Jr(e.headers),r=Xr(e),o=await fetch(e.url,{body:r,method:e.method,headers:n,signal:t.signal,credentials:e.withCredentials?"include":"same-origin",cache:"no-store"});return Fr(e.body)&&e.onUploadProgress&&e.onUploadProgress({loadedBytes:e.body.size}),Hr(o,e)}finally{n&&n()}}async function Hr(e,t){var n,r;const o=Yr(e),s={request:t,headers:o,status:e.status},i=$r(e.body)?Qr(e.body,t.onDownloadProgress):e.body;if((null===(n=t.streamResponseStatusCodes)||void 0===n?void 0:n.has(Number.POSITIVE_INFINITY))||(null===(r=t.streamResponseStatusCodes)||void 0===r?void 0:r.has(s.status)))if(t.enableBrowserStreams)s.browserStreamBody=null!==i&&void 0!==i?i:void 0;else{const e=new Response(i);s.blobBody=e.blob()}else{const e=new Response(i);s.bodyAsText=await e.text()}return s}function Wr(e){const t=new AbortController;let n,r;if(e.abortSignal){if(e.abortSignal.aborted)throw new kt("The operation was aborted.");r=e=>{"abort"===e.type&&t.abort()},e.abortSignal.addEventListener("abort",r),n=()=>{var t;r&&(null===(t=e.abortSignal)||void 0===t||t.removeEventListener("abort",r))}}return e.timeout>0&&setTimeout((()=>{t.abort()}),e.timeout),{abortController:t,abortControllerCleanup:n}}function Gr(e,t){var n;return e&&"AbortError"===(null===e||void 0===e?void 0:e.name)?e:new Pr(`Error sending request: ${e.message}`,{code:null!==(n=null===e||void 0===e?void 0:e.code)&&void 0!==n?n:Pr.REQUEST_SEND_ERROR,request:t})}function Jr(e){const t=new Headers;for(const[n,r]of e)t.append(n,r);return t}function Yr(e){const t=Kr();for(const[n,r]of e.headers)t.set(n,r);return t}function Xr(e){const t="function"===typeof e.body?e.body():e.body;if(Lr(t))throw new Error("Node streams are not supported in browser environment.");return $r(t)?Qr(t,e.onUploadProgress):t}function Qr(e,t){let n=0;if(eo(e))return e.pipeThrough(new TransformStream({transform(e,r){null!==e?(r.enqueue(e),n+=e.length,t&&t({loadedBytes:n})):r.terminate()}}));{const r=e.getReader();return new ReadableStream({async pull(e){var o;const{done:s,value:i}=await r.read();if(s||!i)return e.close(),void r.releaseLock();n+=null!==(o=null===i||void 0===i?void 0:i.length)&&void 0!==o?o:0,e.enqueue(i),t&&t({loadedBytes:n})}})}}function Zr(){return new Vr}function eo(e){return void 0!==e.pipeThrough&&void 0!==self.TransformStream}function to(){return Zr()}const no="ApiVersionPolicy";function ro(e){return{name:no,sendRequest:(t,n)=>{const r=new URL(t.url);return!r.searchParams.get("api-version")&&e.apiVersion&&(t.url=`${t.url}${Array.from(r.searchParams.keys()).length>0?"&":"?"}api-version=${e.apiVersion}`),n(t)}}}const oo="keyCredentialAuthenticationPolicy";function so(e,t){return{name:oo,async sendRequest(n,r){return n.headers.set(t,e.key),r(n)}}}let io;function ao(e,t,n={}){var r,o,s,i;const{credential:a,clientOptions:l}=n;if(a)if(Ct(a)){const n=pn({credential:a,scopes:null!==(o=null===(r=null===l||void 0===l?void 0:l.credentials)||void 0===r?void 0:r.scopes)&&void 0!==o?o:`${t}/.default`});e.addPolicy(n)}else if(uo(a)){if(!(null===(s=null===l||void 0===l?void 0:l.credentials)||void 0===s?void 0:s.apiKeyHeaderName))throw new Error("Missing API Key Header Name");const t=so(a,null===(i=null===l||void 0===l?void 0:l.credentials)||void 0===i?void 0:i.apiKeyHeaderName);e.addPolicy(t)}}function lo(e,t,n={}){const r=qr(n);return r.addPolicy(ro(n)),ao(r,e,{credential:t,clientOptions:n}),r}function uo(e){return void 0!==e.key}function co(){return io||(io=to()),io}function ho(){let e="";for(let t=0;t<32;t++){const n=Math.floor(16*Math.random());e+=12===t?"4":16===t?3&n|8:n.toString(16),7!==t&&11!==t&&15!==t&&19!==t||(e+="-")}return e}var fo;const po="function"===typeof(null===(fo=null===globalThis||void 0===globalThis?void 0:globalThis.crypto)||void 0===fo?void 0:fo.randomUUID)?globalThis.crypto.randomUUID.bind(globalThis.crypto):ho;function mo(){return po()}class yo{constructor(e){var t,n,r,o,s,i,a;this.url=e.url,this.body=e.body,this.headers=null!==(t=e.headers)&&void 0!==t?t:Kr(),this.method=null!==(n=e.method)&&void 0!==n?n:"GET",this.timeout=null!==(r=e.timeout)&&void 0!==r?r:0,this.formData=e.formData,this.disableKeepAlive=null!==(o=e.disableKeepAlive)&&void 0!==o&&o,this.proxySettings=e.proxySettings,this.streamResponseStatusCodes=e.streamResponseStatusCodes,this.withCredentials=null!==(s=e.withCredentials)&&void 0!==s&&s,this.abortSignal=e.abortSignal,this.tracingOptions=e.tracingOptions,this.onUploadProgress=e.onUploadProgress,this.onDownloadProgress=e.onDownloadProgress,this.requestId=e.requestId||mo(),this.allowInsecureConnection=null!==(i=e.allowInsecureConnection)&&void 0!==i&&i,this.enableBrowserStreams=null!==(a=e.enableBrowserStreams)&&void 0!==a&&a}}function go(e){return new yo(e)}function vo(e){return Boolean(e&&"function"===typeof e.getReader&&"function"===typeof e.tee)}function bo(e){let t="";for(const n of e)t+=String.fromCharCode(n);return t}async function wo(e,t,n,r={},o){const s=null!==o&&void 0!==o?o:co(),i=So(e,t,r),a=await n.sendRequest(s,i),l=a.headers.toJSON(),u=Ro(a);return(null===r||void 0===r?void 0:r.onResponse)&&r.onResponse(Object.assign(Object.assign({},a),{request:i,rawHeaders:l,parsedBody:u})),{request:i,headers:l,status:`${a.status}`,body:u}}async function Eo(e,t,n,r={},o){var s;const i=null!==o&&void 0!==o?o:co(),a=So(e,t,Object.assign(Object.assign({},r),{responseAsStream:!0})),l=await n.sendRequest(i,a),u=l.headers.toJSON(),c=null!==(s=l.browserStreamBody)&&void 0!==s?s:l.readableStreamBody;return{request:a,headers:u,status:`${l.status}`,body:c}}function _o(e){return ArrayBuffer.isView(e)?"application/octet-stream":"application/json; charset=UTF-8"}function So(e,t,n={}){var r,o;const{body:s,formData:i}=Oo(n.body,n.contentType),a=void 0!==s||void 0!==i,l=Kr(Object.assign(Object.assign(Object.assign({},n.headers?n.headers:{}),{accept:null!==(r=n.accept)&&void 0!==r?r:"application/json"}),a&&{"content-type":null!==(o=n.contentType)&&void 0!==o?o:_o(n.body)}));return go({url:t,method:e,body:s,formData:i,headers:l,allowInsecureConnection:n.allowInsecureConnection,tracingOptions:n.tracingOptions,abortSignal:n.abortSignal,onUploadProgress:n.onUploadProgress,onDownloadProgress:n.onDownloadProgress,timeout:n.timeout,enableBrowserStreams:!0,streamResponseStatusCodes:n.responseAsStream?new Set([Number.POSITIVE_INFINITY]):void 0})}function Oo(e,t=""){if(void 0===e)return{body:void 0};if(vo(e))return{body:e};if(!t&&"string"===typeof e)return{body:e};const n=t.split(";")[0];if("application/json"===n)return{body:JSON.stringify(e)};if(ArrayBuffer.isView(e))return e instanceof Uint8Array?{body:bo(e)}:{body:JSON.stringify(e)};switch(n){case"multipart/form-data":return xo(e)?{formData:Ao(e)}:{body:JSON.stringify(e)};case"text/plain":return{body:String(e)};default:return"string"===typeof e?{body:e}:{body:JSON.stringify(e)}}}function xo(e){return e instanceof Object&&Object.keys(e).length>0}function Ao(e){if(!e)return e;const t={};for(const n in e){const r=e[n];r instanceof Uint8Array?t[n]=bo(r):t[n]=r}return t}function Ro(e){var t,n;const r=null!==(t=e.headers.get("content-type"))&&void 0!==t?t:"",o=r.split(";")[0],s=null!==(n=e.bodyAsText)&&void 0!==n?n:"";if("text/plain"===o)return String(s);try{return s?JSON.parse(s):void 0}catch(i){if("application/json"===o)throw Po(e,i);return String(s)}}function Po(e,t){var n;const r=`Error "${t}" occurred while parsing the response body - ${e.bodyAsText}.`,o=null!==(n=t.code)&&void 0!==n?n:Pr.PARSE_ERROR;return new Pr(r,{code:o,statusCode:e.status,request:e.request,response:e})}function Co(e,t,n,r={}){if(t.startsWith("https://")||t.startsWith("http://"))return t;e=Io(e,r),t=jo(t,n,r);const o=ko(`${e}/${t}`,r),s=new URL(o);return s.toString().replace(/([^:]\/)\/+/g,"$1")}function ko(e,t={}){if(!t.queryParameters)return e;let n=new URL(e);const r=t.queryParameters;for(const o of Object.keys(r)){const e=r[o];if(void 0===e||null===e)continue;if(!e.toString||"function"!==typeof e.toString)throw new Error(`Query parameters must be able to be represented as string, ${o} can't`);const t=void 0!==e.toISOString?e.toISOString():e.toString();n.searchParams.append(o,t)}return t.skipUrlEncoding&&(n=To(n)),n.toString()}function To(e){if(!e)return e;const t=[];for(const[n,r]of e.searchParams)t.push(`${n}=${r}`);return e.search=t.length?`?${t.join("&")}`:"",e}function Io(e,t){var n;if(!t.pathParameters)return e;const r=t.pathParameters;for(const[o,s]of Object.entries(r)){if(void 0===s||null===s)throw new Error(`Path parameters ${o} must not be undefined or null`);if(!s.toString||"function"!==typeof s.toString)throw new Error(`Path parameters must be able to be represented as string, ${o} can't`);let r=void 0!==s.toISOString?s.toISOString():String(s);t.skipUrlEncoding||(r=encodeURIComponent(s)),e=null!==(n=No(e,`{${o}}`,r))&&void 0!==n?n:""}return e}function jo(e,t,n={}){for(const r of t){let t=r;n.skipUrlEncoding||(t=encodeURIComponent(r)),e=e.replace(/\{\w+\}/,t)}return e}function No(e,t,n){return e&&t?e.split(t).join(n||""):e}function Do(e,t,n={}){var r;let o;t&&(Bo(t)?o=t:n=null!==t&&void 0!==t?t:{});const s=lo(e,o,n);if(null===(r=n.additionalPolicies)||void 0===r?void 0:r.length)for(const{policy:u,position:c}of n.additionalPolicies){const e="perRetry"===c?"Sign":void 0;s.addPolicy(u,{afterPhase:e})}const{allowInsecureConnection:i,httpClient:a}=n,l=(t,...n)=>{const r=r=>Co(e,t,n,Object.assign({allowInsecureConnection:i},r));return{get:(e={})=>qo("GET",r(e),s,e,i,a),post:(e={})=>qo("POST",r(e),s,e,i,a),put:(e={})=>qo("PUT",r(e),s,e,i,a),patch:(e={})=>qo("PATCH",r(e),s,e,i,a),delete:(e={})=>qo("DELETE",r(e),s,e,i,a),head:(e={})=>qo("HEAD",r(e),s,e,i,a),options:(e={})=>qo("OPTIONS",r(e),s,e,i,a),trace:(e={})=>qo("TRACE",r(e),s,e,i,a)}};return{path:l,pathUnchecked:l,pipeline:s}}function qo(e,t,n,r,o,s){var i;return o=null!==(i=r.allowInsecureConnection)&&void 0!==i?i:o,{then:function(i,a){return wo(e,t,n,Object.assign(Object.assign({},r),{allowInsecureConnection:o}),s).then(i,a)},async asBrowserStream(){return Eo(e,t,n,Object.assign(Object.assign({},r),{allowInsecureConnection:o}),s)},async asNodeStream(){return Eo(e,t,n,Object.assign(Object.assign({},r),{allowInsecureConnection:o}),s)}}}function Bo(e){return!(void 0===e.key&&!Ct(e))}const Uo=on("openai");function Mo(e,t,n={}){var r,o,s,i,a,l,u,c;const d=null!==(r=n.baseUrl)&&void 0!==r?r:`${e}/openai`;n.apiVersion=null!==(o=n.apiVersion)&&void 0!==o?o:"2023-06-01-preview",n=Object.assign(Object.assign({},n),{credentials:{scopes:null!==(i=null===(s=n.credentials)||void 0===s?void 0:s.scopes)&&void 0!==i?i:["https://cognitiveservices.azure.com/.default"],apiKeyHeaderName:null!==(l=null===(a=n.credentials)||void 0===a?void 0:a.apiKeyHeaderName)&&void 0!==l?l:"api-key"}});const h="azsdk-js-openai-rest/1.0.0-beta.4",f=n.userAgentOptions&&n.userAgentOptions.userAgentPrefix?`${n.userAgentOptions.userAgentPrefix} ${h}`:`${h}`;n=Object.assign(Object.assign({},n),{userAgentOptions:{userAgentPrefix:f},loggingOptions:{logger:null!==(c=null===(u=n.loggingOptions)||void 0===u?void 0:u.logger)&&void 0!==c?c:Uo.info}});const p=Do(d,t,n);return p}var Ko=Mo;function Lo(e,t,n={}){const r=e,o=Ko(r,t,n);return o}const $o={"POST /deployments/{deploymentId}/embeddings":["200"],"POST /deployments/{deploymentId}/completions":["200"],"POST /deployments/{deploymentId}/chat/completions":["200"],"GET /operations/images/{operationId}":["200"],"POST /images/generations:submit":["202"],"GET /images/generations:submit":["200","202"]};function Fo(e){const t=e.headers["x-ms-original-url"],n=new URL(null!==t&&void 0!==t?t:e.request.url),r=e.request.method;let o=$o[`${r} ${n.pathname}`];return o||(o=Vo(r,n.pathname)),!o.includes(e.status)}function Vo(e,t){var n,r,o,s;const i=t.split("/");let a=-1,l=[];for(const[u,c]of Object.entries($o)){if(!u.startsWith(e))continue;const t=zo(u),d=t.split("/");let h=!0;for(let e=d.length-1,a=i.length-1;e>=1&&a>=1;e--,a--)if((null===(n=d[e])||void 0===n?void 0:n.startsWith("{"))&&-1!==(null===(r=d[e])||void 0===r?void 0:r.indexOf("}"))){const t=d[e].indexOf("}")+1,n=null===(o=d[e])||void 0===o?void 0:o.length,r=new RegExp(`${null===(s=d[e])||void 0===s?void 0:s.slice(t,n)}`).test(i[a]||"");if(!r){h=!1;break}}else if(d[e]!==i[a]){h=!1;break}h&&t.length>a&&(a=t.length,l=c)}return l}function zo(e){const t=e.indexOf("/");return e.slice(t)}function Ho(e){return Yo(Jo(e))}function Wo(e,t){const n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function Go(){return{data:void 0,event:"",id:"",retry:void 0}}function Jo(e){return Rt(this,arguments,(function*(){var t,n,r,o;let s,i=0,a=-1,l=!1;try{for(var u,c=!0,d=Pt(e);u=yield At(d.next()),t=u.done,!t;){o=u.value,c=!1;try{const e=o;void 0===s?(s=e,i=0,a=-1):s=Wo(s,e);const t=s.length;let n=0;while(i<t){l&&(10===s[i]&&(n=++i),l=!1);let e=-1;for(;i<t&&-1===e;++i)switch(s[i]){case 58:-1===a&&(a=i-n);break;case 13:l=!0,e=i;break;case 10:e=i;break}if(-1===e)break;yield yield At({line:s.subarray(n,e),fieldLen:a}),n=i,a=-1}n===t?s=void 0:0!==n&&(s=s.subarray(n),i-=n)}finally{c=!0}}}catch(h){n={error:h}}finally{try{c||t||!(r=d.return)||(yield At(r.call(d)))}finally{if(n)throw n.error}}}))}function Yo(e){return Rt(this,arguments,(function*(){var t,n,r,o;let s=Go();const i=new TextDecoder;try{for(var a,l=!0,u=Pt(e);a=yield At(u.next()),t=a.done,!t;){o=a.value,l=!1;try{const{line:e,fieldLen:t}=o;if(0===e.length&&void 0!==s.data)yield yield At(s),s=Go();else if(t>0){const n=i.decode(e.subarray(0,t)),r=t+(32===e[t+1]?2:1),o=i.decode(e.subarray(r));switch(n){case"data":s.data=s.data?s.data+"\n"+o:o;break;case"event":s.event=o;break;case"id":s.id=o;break;case"retry":{const e=parseInt(o,10);isNaN(e)||(s.retry=e);break}}}}finally{l=!0}}}catch(c){n={error:c}}finally{try{l||t||!(r=u.return)||(yield At(r.call(u)))}finally{if(n)throw n.error}}}))}async function Xo(e){const t=await Zo(e);return Ho(t)}function Qo(e){return Rt(this,arguments,(function*(){const t=e.getReader();try{while(1){const{value:e,done:n}=yield At(t.read());if(n)return yield At(void 0);yield yield At(e)}}finally{t.releaseLock()}}))}async function Zo(e){const t=(await e.asBrowserStream()).body;if(!t)throw new Error("No stream found in response. Did you enable the stream option?");return Qo(t)}function es(e,t){return new Error(e,{cause:t})}function ts(e,t){let n;try{n=e()}catch(r){throw es(t,r)}return n}function ns(e,t){return Rt(this,arguments,(function*(){var n,r,o,s;const i=yield At(Xo(e));let a=!1;try{for(var l,u=!0,c=Pt(i);l=yield At(c.next()),n=l.done,!n;){s=l.value,u=!1;try{const e=s;if(a)continue;"[DONE]"===e.data?a=!0:yield yield At(t(ts((()=>JSON.parse(e.data)),"Error parsing an event. See 'cause' for more details")))}finally{u=!0}}}catch(d){r={error:d}}finally{try{u||n||!(o=c.return)||(yield At(o.call(c)))}finally{if(r)throw r.error}}}))}function rs(e,t,n,r={requestOptions:{}}){var o,s,i;return e.path("/deployments/{deploymentId}/embeddings",n).post({allowInsecureConnection:null===(o=r.requestOptions)||void 0===o?void 0:o.allowInsecureConnection,skipUrlEncoding:null===(s=r.requestOptions)||void 0===s?void 0:s.skipUrlEncoding,headers:Object.assign({},null===(i=r.requestOptions)||void 0===i?void 0:i.headers),body:{user:null===r||void 0===r?void 0:r.user,model:null===r||void 0===r?void 0:r.model,input:t}})}async function os(e){var t;if(Fo(e))throw e.body;return{data:(null!==(t=e.body["data"])&&void 0!==t?t:[]).map((e=>({embedding:e["embedding"],index:e["index"]}))),usage:{promptTokens:e.body.usage["prompt_tokens"],totalTokens:e.body.usage["total_tokens"]}}}async function ss(e,t,n,r={requestOptions:{}}){const o=await rs(e,t,n,r);return os(o)}function is(e,t,n,r={requestOptions:{}}){const o=as(e,t,n,Object.assign(Object.assign({},r),{stream:!0}));return ns(o,Es)}function as(e,t,n,r={requestOptions:{}}){var o,s,i;return e.path("/deployments/{deploymentId}/completions",n).post({allowInsecureConnection:null===(o=r.requestOptions)||void 0===o?void 0:o.allowInsecureConnection,skipUrlEncoding:null===(s=r.requestOptions)||void 0===s?void 0:s.skipUrlEncoding,headers:Object.assign({},null===(i=r.requestOptions)||void 0===i?void 0:i.headers),body:{prompt:t,max_tokens:null===r||void 0===r?void 0:r.maxTokens,temperature:null===r||void 0===r?void 0:r.temperature,top_p:null===r||void 0===r?void 0:r.topP,logit_bias:null===r||void 0===r?void 0:r.logitBias,user:null===r||void 0===r?void 0:r.user,n:null===r||void 0===r?void 0:r.n,logprobs:null===r||void 0===r?void 0:r.logprobs,echo:null===r||void 0===r?void 0:r.echo,stop:null===r||void 0===r?void 0:r.stop,presence_penalty:null===r||void 0===r?void 0:r.presencePenalty,frequency_penalty:null===r||void 0===r?void 0:r.frequencyPenalty,best_of:null===r||void 0===r?void 0:r.bestOf,stream:null===r||void 0===r?void 0:r.stream,model:null===r||void 0===r?void 0:r.model}})}async function ls(e){var t;if(Fo(e))throw e.body;return{id:e.body["id"],created:e.body["created"],choices:(null!==(t=e.body["choices"])&&void 0!==t?t:[]).map((e=>({text:e["text"],index:e["index"],logprobs:null===e.logprobs?null:{tokens:e.logprobs["tokens"],tokenLogprobs:e.logprobs["token_logprobs"],topLogprobs:e.logprobs["top_logprobs"],textOffset:e.logprobs["text_offset"]},finishReason:e["finish_reason"]}))),usage:{completionTokens:e.body.usage["completion_tokens"],promptTokens:e.body.usage["prompt_tokens"],totalTokens:e.body.usage["total_tokens"]}}}async function us(e,t,n,r={requestOptions:{}}){const o=await as(e,t,n,r);return ls(o)}function cs(e,t,n,r={requestOptions:{}}){var o,s,i;return e.path("/deployments/{deploymentId}/chat/completions",n).post({allowInsecureConnection:null===(o=r.requestOptions)||void 0===o?void 0:o.allowInsecureConnection,skipUrlEncoding:null===(s=r.requestOptions)||void 0===s?void 0:s.skipUrlEncoding,headers:Object.assign({},null===(i=r.requestOptions)||void 0===i?void 0:i.headers),body:{messages:t,max_tokens:null===r||void 0===r?void 0:r.maxTokens,temperature:null===r||void 0===r?void 0:r.temperature,top_p:null===r||void 0===r?void 0:r.topP,logit_bias:null===r||void 0===r?void 0:r.logitBias,user:null===r||void 0===r?void 0:r.user,n:null===r||void 0===r?void 0:r.n,stop:null===r||void 0===r?void 0:r.stop,presence_penalty:null===r||void 0===r?void 0:r.presencePenalty,frequency_penalty:null===r||void 0===r?void 0:r.frequencyPenalty,stream:null===r||void 0===r?void 0:r.stream,model:null===r||void 0===r?void 0:r.model}})}async function ds(e){var t;if(Fo(e))throw e.body;return{id:e.body["id"],created:e.body["created"],choices:(null!==(t=e.body["choices"])&&void 0!==t?t:[]).map((e=>{var t,n,r,o;return{message:e.message?{role:null===(t=e.message)||void 0===t?void 0:t["role"],content:null===(n=e.message)||void 0===n?void 0:n["content"]}:void 0,index:e["index"],finishReason:e["finish_reason"],delta:e.delta?{role:null===(r=e.delta)||void 0===r?void 0:r["role"],content:null===(o=e.delta)||void 0===o?void 0:o["content"]}:void 0}})),usage:{completionTokens:e.body.usage["completion_tokens"],promptTokens:e.body.usage["prompt_tokens"],totalTokens:e.body.usage["total_tokens"]}}}async function hs(e,t,n,r={requestOptions:{}}){const o=await cs(e,t,n,r);return ds(o)}function fs(e,t,n,r={requestOptions:{}}){const o=cs(e,t,n,Object.assign(Object.assign({},r),{stream:!0}));return ns(o,_s)}function ps(e,t,n={requestOptions:{}}){var r,o,s;return e.path("/operations/images/{operationId}",t).get({allowInsecureConnection:null===(r=n.requestOptions)||void 0===r?void 0:r.allowInsecureConnection,skipUrlEncoding:null===(o=n.requestOptions)||void 0===o?void 0:o.skipUrlEncoding,headers:Object.assign({},null===(s=n.requestOptions)||void 0===s?void 0:s.headers)})}async function ms(e){var t,n;if(Fo(e))throw e.body;return{id:e.body["id"],created:e.body["created"],expires:e.body["expires"],result:e.body.result?{created:null===(t=e.body.result)||void 0===t?void 0:t["created"],data:ys(null===(n=e.body.result)||void 0===n?void 0:n["data"])}:void 0,status:e.body["status"],error:e.body.error?e.body.error:void 0}}function ys(e){return e.map((function(e){return"url"in e?e:{base64Data:e.b64_json}}))}async function gs(e,t,n={requestOptions:{}}){const r=await ps(e,t,n);return ms(r)}function vs(e,t,n={requestOptions:{}}){var r,o,s,i;return e.path("/images/generations:submit").post({allowInsecureConnection:null===(r=n.requestOptions)||void 0===r?void 0:r.allowInsecureConnection,skipUrlEncoding:null===(o=n.requestOptions)||void 0===o?void 0:o.skipUrlEncoding,headers:Object.assign({},null===(s=n.requestOptions)||void 0===s?void 0:s.headers),body:{prompt:t,n:null!==(i=n.n)&&void 0!==i?i:1,size:null===n||void 0===n?void 0:n.size,response_format:null===n||void 0===n?void 0:n.responseFormat,user:null===n||void 0===n?void 0:n.user}})}async function bs(e){var t,n;if(Fo(e))throw e.body;return{id:e.body["id"],created:e.body["created"],expires:e.body["expires"],result:e.body.result?{created:null===(t=e.body.result)||void 0===t?void 0:t["created"],data:ys(null===(n=e.body.result)||void 0===n?void 0:n["data"])}:void 0,status:e.body["status"],error:e.body.error?e.body.error:void 0}}async function ws(e,t,n={requestOptions:{}}){const r=await vs(e,t,n);return bs(r)}function Es(e){var t;return{id:e["id"],created:e["created"],choices:(null!==(t=e["choices"])&&void 0!==t?t:[]).map((e=>({text:e["text"],index:e["index"],logprobs:null===e.logprobs?null:{tokens:e.logprobs["tokens"],tokenLogprobs:e.logprobs["token_logprobs"],topLogprobs:e.logprobs["top_logprobs"],textOffset:e.logprobs["text_offset"]},finishReason:e["finish_reason"]})))}}function _s(e){var t;return{id:e["id"],created:e["created"],choices:(null!==(t=e["choices"])&&void 0!==t?t:[]).map((e=>{var t,n,r,o;return{message:e.message?{role:null===(t=e.message)||void 0===t?void 0:t["role"],content:null===(n=e.message)||void 0===n?void 0:n["content"]}:void 0,index:e["index"],finishReason:e["finish_reason"],delta:e.delta?{role:null===(r=e.delta)||void 0===r?void 0:r["role"],content:null===(o=e.delta)||void 0===o?void 0:o["content"]}:void 0}}))}}class Ss{constructor(e,t={},n={}){var r,o;let s,i,a;if(this._isAzure=!1,xs(t))i=e,a=t,s=n,this._isAzure=!0;else{i=Os(1),a=e;const{credentials:n}=t,o=Ot(t,["credentials"]);s=Object.assign({credentials:{apiKeyHeaderName:null!==(r=null===n||void 0===n?void 0:n.apiKeyHeaderName)&&void 0!==r?r:"Authorization",scopes:null===n||void 0===n?void 0:n.scopes}},o)}this._client=Lo(i,a,Object.assign(Object.assign({},s),this._isAzure?{}:{additionalPolicies:[...null!==(o=s.additionalPolicies)&&void 0!==o?o:[],{position:"perCall",policy:{name:"openAiEndpoint",sendRequest:(e,t)=>{const n=new URL(e.url),r=n.pathname.split("/");return n.pathname=`/${r[1]}/${r.slice(5).join("/")}`,n.searchParams.delete("api-version"),e.url=n.toString(),t(e)}}}]}))}getAzureBatchImageGenerationOperationStatus(e,t={requestOptions:{}}){return gs(this._client,e,t)}beginAzureBatchImageGeneration(e,t={requestOptions:{}}){return ws(this._client,e,t)}getImages(e,t={requestOptions:{}}){return ws(this._client,e,t)}getCompletions(e,t,n={requestOptions:{}}){return this.setModel(e,n),us(this._client,t,e,n)}listCompletions(e,t,n={}){return this.setModel(e,n),is(this._client,t,e,n)}getEmbeddings(e,t,n={requestOptions:{}}){return this.setModel(e,n),ss(this._client,t,e,n)}getChatCompletions(e,t,n={requestOptions:{}}){return this.setModel(e,n),hs(this._client,t,e,n)}listChatCompletions(e,t,n={requestOptions:{}}){return this.setModel(e,n),fs(this._client,t,e,n)}setModel(e,t){this._isAzure||(t.model=e)}}function Os(e){return`https://api.openai.com/v${e}`}function xs(e){return Ct(e)||void 0!==e.key}class As{get key(){return this._key}constructor(e){if(!e)throw new Error("key must be a non-empty string");this._key=e}update(e){this._key=e}}async function Rs(e){const t=Ps(e.azureAPIKey,e.azureAPIEndpoint),n=Cs(e.maxTokens,e.temperature);try{const r=await ks(t,e.azureDeploymentName,e.messages,n);Ts(r,e.result,e.historyDialog)}catch(r){Is(r,e.result,e.errorIssue)}e.loading.value=!1}function Ps(e,t){return new Ss(t,new As(e))}function Cs(e,t){return{maxTokens:e??800,temperature:t??.7,stream:!1}}async function ks(e,t,n,r){return await e.getChatCompletions(t,n,r)}function Ts(e,t,n){const r=e.choices[0].message?.content?.replace(/\\n/g,"\n")??"";t.value=r,n.value.push({role:"assistant",content:r})}function Is(e,t,n){t.value=String(e),n.value=!0,console.error(e)}var js={createChatCompletionStream:Rs};function Ns(e,t){return function(){return e.apply(t,arguments)}}const{toString:Ds}=Object.prototype,{getPrototypeOf:qs}=Object,Bs=(e=>t=>{const n=Ds.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Us=e=>(e=e.toLowerCase(),t=>Bs(t)===e),Ms=e=>t=>typeof t===e,{isArray:Ks}=Array,Ls=Ms("undefined");function $s(e){return null!==e&&!Ls(e)&&null!==e.constructor&&!Ls(e.constructor)&&Hs(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Fs=Us("ArrayBuffer");function Vs(e){let t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&Fs(e.buffer),t}const zs=Ms("string"),Hs=Ms("function"),Ws=Ms("number"),Gs=e=>null!==e&&"object"===typeof e,Js=e=>!0===e||!1===e,Ys=e=>{if("object"!==Bs(e))return!1;const t=qs(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Xs=Us("Date"),Qs=Us("File"),Zs=Us("Blob"),ei=Us("FileList"),ti=e=>Gs(e)&&Hs(e.pipe),ni=e=>{let t;return e&&("function"===typeof FormData&&e instanceof FormData||Hs(e.append)&&("formdata"===(t=Bs(e))||"object"===t&&Hs(e.toString)&&"[object FormData]"===e.toString()))},ri=Us("URLSearchParams"),oi=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function si(e,t,{allOwnKeys:n=!1}={}){if(null===e||"undefined"===typeof e)return;let r,o;if("object"!==typeof e&&(e=[e]),Ks(e))for(r=0,o=e.length;r<o;r++)t.call(null,e[r],r,e);else{const o=n?Object.getOwnPropertyNames(e):Object.keys(e),s=o.length;let i;for(r=0;r<s;r++)i=o[r],t.call(null,e[i],i,e)}}function ii(e,t){t=t.toLowerCase();const n=Object.keys(e);let r,o=n.length;while(o-- >0)if(r=n[o],t===r.toLowerCase())return r;return null}const ai=(()=>"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global)(),li=e=>!Ls(e)&&e!==ai;function ui(){const{caseless:e}=li(this)&&this||{},t={},n=(n,r)=>{const o=e&&ii(t,r)||r;Ys(t[o])&&Ys(n)?t[o]=ui(t[o],n):Ys(n)?t[o]=ui({},n):Ks(n)?t[o]=n.slice():t[o]=n};for(let r=0,o=arguments.length;r<o;r++)arguments[r]&&si(arguments[r],n);return t}const ci=(e,t,n,{allOwnKeys:r}={})=>(si(t,((t,r)=>{n&&Hs(t)?e[r]=Ns(t,n):e[r]=t}),{allOwnKeys:r}),e),di=e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),hi=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},fi=(e,t,n,r)=>{let o,s,i;const a={};if(t=t||{},null==e)return t;do{o=Object.getOwnPropertyNames(e),s=o.length;while(s-- >0)i=o[s],r&&!r(i,e,t)||a[i]||(t[i]=e[i],a[i]=!0);e=!1!==n&&qs(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},pi=(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return-1!==r&&r===n},mi=e=>{if(!e)return null;if(Ks(e))return e;let t=e.length;if(!Ws(t))return null;const n=new Array(t);while(t-- >0)n[t]=e[t];return n},yi=(e=>t=>e&&t instanceof e)("undefined"!==typeof Uint8Array&&qs(Uint8Array)),gi=(e,t)=>{const n=e&&e[Symbol.iterator],r=n.call(e);let o;while((o=r.next())&&!o.done){const n=o.value;t.call(e,n[0],n[1])}},vi=(e,t)=>{let n;const r=[];while(null!==(n=e.exec(t)))r.push(n);return r},bi=Us("HTMLFormElement"),wi=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n})),Ei=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),_i=Us("RegExp"),Si=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};si(n,((n,o)=>{let s;!1!==(s=t(n,o,e))&&(r[o]=s||n)})),Object.defineProperties(e,r)},Oi=e=>{Si(e,((t,n)=>{if(Hs(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=e[n];Hs(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))}))},xi=(e,t)=>{const n={},r=e=>{e.forEach((e=>{n[e]=!0}))};return Ks(e)?r(e):r(String(e).split(t)),n},Ai=()=>{},Ri=(e,t)=>(e=+e,Number.isFinite(e)?e:t),Pi="abcdefghijklmnopqrstuvwxyz",Ci="0123456789",ki={DIGIT:Ci,ALPHA:Pi,ALPHA_DIGIT:Pi+Pi.toUpperCase()+Ci},Ti=(e=16,t=ki.ALPHA_DIGIT)=>{let n="";const{length:r}=t;while(e--)n+=t[Math.random()*r|0];return n};function Ii(e){return!!(e&&Hs(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])}const ji=e=>{const t=new Array(10),n=(e,r)=>{if(Gs(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[r]=e;const o=Ks(e)?[]:{};return si(e,((e,t)=>{const s=n(e,r+1);!Ls(s)&&(o[t]=s)})),t[r]=void 0,o}}return e};return n(e,0)},Ni=Us("AsyncFunction"),Di=e=>e&&(Gs(e)||Hs(e))&&Hs(e.then)&&Hs(e.catch);var qi={isArray:Ks,isArrayBuffer:Fs,isBuffer:$s,isFormData:ni,isArrayBufferView:Vs,isString:zs,isNumber:Ws,isBoolean:Js,isObject:Gs,isPlainObject:Ys,isUndefined:Ls,isDate:Xs,isFile:Qs,isBlob:Zs,isRegExp:_i,isFunction:Hs,isStream:ti,isURLSearchParams:ri,isTypedArray:yi,isFileList:ei,forEach:si,merge:ui,extend:ci,trim:oi,stripBOM:di,inherits:hi,toFlatObject:fi,kindOf:Bs,kindOfTest:Us,endsWith:pi,toArray:mi,forEachEntry:gi,matchAll:vi,isHTMLForm:bi,hasOwnProperty:Ei,hasOwnProp:Ei,reduceDescriptors:Si,freezeMethods:Oi,toObjectSet:xi,toCamelCase:wi,noop:Ai,toFiniteNumber:Ri,findKey:ii,global:ai,isContextDefined:li,ALPHABET:ki,generateString:Ti,isSpecCompliantForm:Ii,toJSONObject:ji,isAsyncFn:Ni,isThenable:Di};function Bi(e,t,n,r,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),o&&(this.response=o)}qi.inherits(Bi,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:qi.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Ui=Bi.prototype,Mi={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{Mi[e]={value:e}})),Object.defineProperties(Bi,Mi),Object.defineProperty(Ui,"isAxiosError",{value:!0}),Bi.from=(e,t,n,r,o,s)=>{const i=Object.create(Ui);return qi.toFlatObject(e,i,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),Bi.call(i,e.message,t,n,r,o),i.cause=e,i.name=e.name,s&&Object.assign(i,s),i};var Ki=Bi,Li=null;function $i(e){return qi.isPlainObject(e)||qi.isArray(e)}function Fi(e){return qi.endsWith(e,"[]")?e.slice(0,-2):e}function Vi(e,t,n){return e?e.concat(t).map((function(e,t){return e=Fi(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}function zi(e){return qi.isArray(e)&&!e.some($i)}const Hi=qi.toFlatObject(qi,{},null,(function(e){return/^is[A-Z]/.test(e)}));function Wi(e,t,n){if(!qi.isObject(e))throw new TypeError("target must be an object");t=t||new(Li||FormData),n=qi.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!qi.isUndefined(t[e])}));const r=n.metaTokens,o=n.visitor||c,s=n.dots,i=n.indexes,a=n.Blob||"undefined"!==typeof Blob&&Blob,l=a&&qi.isSpecCompliantForm(t);if(!qi.isFunction(o))throw new TypeError("visitor must be a function");function u(e){if(null===e)return"";if(qi.isDate(e))return e.toISOString();if(!l&&qi.isBlob(e))throw new Ki("Blob is not supported. Use a Buffer instead.");return qi.isArrayBuffer(e)||qi.isTypedArray(e)?l&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,n,o){let a=e;if(e&&!o&&"object"===typeof e)if(qi.endsWith(n,"{}"))n=r?n:n.slice(0,-2),e=JSON.stringify(e);else if(qi.isArray(e)&&zi(e)||(qi.isFileList(e)||qi.endsWith(n,"[]"))&&(a=qi.toArray(e)))return n=Fi(n),a.forEach((function(e,r){!qi.isUndefined(e)&&null!==e&&t.append(!0===i?Vi([n],r,s):null===i?n:n+"[]",u(e))})),!1;return!!$i(e)||(t.append(Vi(o,n,s),u(e)),!1)}const d=[],h=Object.assign(Hi,{defaultVisitor:c,convertValue:u,isVisitable:$i});function f(e,n){if(!qi.isUndefined(e)){if(-1!==d.indexOf(e))throw Error("Circular reference detected in "+n.join("."));d.push(e),qi.forEach(e,(function(e,r){const s=!(qi.isUndefined(e)||null===e)&&o.call(t,e,qi.isString(r)?r.trim():r,n,h);!0===s&&f(e,n?n.concat(r):[r])})),d.pop()}}if(!qi.isObject(e))throw new TypeError("data must be an object");return f(e),t}var Gi=Wi;function Ji(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function Yi(e,t){this._pairs=[],e&&Gi(e,this,t)}const Xi=Yi.prototype;Xi.append=function(e,t){this._pairs.push([e,t])},Xi.toString=function(e){const t=e?function(t){return e.call(this,t,Ji)}:Ji;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};var Qi=Yi;function Zi(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function ea(e,t,n){if(!t)return e;const r=n&&n.encode||Zi,o=n&&n.serialize;let s;if(s=o?o(t,n):qi.isURLSearchParams(t)?t.toString():new Qi(t,n).toString(r),s){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}class ta{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){qi.forEach(this.handlers,(function(t){null!==t&&e(t)}))}}var na=ta,ra={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},oa="undefined"!==typeof URLSearchParams?URLSearchParams:Qi,sa="undefined"!==typeof FormData?FormData:null,ia="undefined"!==typeof Blob?Blob:null,aa={isBrowser:!0,classes:{URLSearchParams:oa,FormData:sa,Blob:ia},protocols:["http","https","file","blob","url","data"]};const la="undefined"!==typeof window&&"undefined"!==typeof document,ua=(e=>la&&["ReactNative","NativeScript","NS"].indexOf(e)<0)("undefined"!==typeof navigator&&navigator.product),ca=(()=>"undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts)();var da={...o,...aa};function ha(e,t){return Gi(e,new da.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,r){return da.isNode&&qi.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},t))}function fa(e){return qi.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}function pa(e){const t={},n=Object.keys(e);let r;const o=n.length;let s;for(r=0;r<o;r++)s=n[r],t[s]=e[s];return t}function ma(e){function t(e,n,r,o){let s=e[o++];const i=Number.isFinite(+s),a=o>=e.length;if(s=!s&&qi.isArray(r)?r.length:s,a)return qi.hasOwnProp(r,s)?r[s]=[r[s],n]:r[s]=n,!i;r[s]&&qi.isObject(r[s])||(r[s]=[]);const l=t(e,n,r[s],o);return l&&qi.isArray(r[s])&&(r[s]=pa(r[s])),!i}if(qi.isFormData(e)&&qi.isFunction(e.entries)){const n={};return qi.forEachEntry(e,((e,r)=>{t(fa(e),r,n,0)})),n}return null}var ya=ma;function ga(e,t,n){if(qi.isString(e))try{return(t||JSON.parse)(e),qi.trim(e)}catch(ku){if("SyntaxError"!==ku.name)throw ku}return(n||JSON.stringify)(e)}const va={transitional:ra,adapter:["xhr","http"],transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,o=qi.isObject(e);o&&qi.isHTMLForm(e)&&(e=new FormData(e));const s=qi.isFormData(e);if(s)return r&&r?JSON.stringify(ya(e)):e;if(qi.isArrayBuffer(e)||qi.isBuffer(e)||qi.isStream(e)||qi.isFile(e)||qi.isBlob(e))return e;if(qi.isArrayBufferView(e))return e.buffer;if(qi.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let i;if(o){if(n.indexOf("application/x-www-form-urlencoded")>-1)return ha(e,this.formSerializer).toString();if((i=qi.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return Gi(i?{"files[]":e}:e,t&&new t,this.formSerializer)}}return o||r?(t.setContentType("application/json",!1),ga(e)):e}],transformResponse:[function(e){const t=this.transitional||va.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(e&&qi.isString(e)&&(n&&!this.responseType||r)){const n=t&&t.silentJSONParsing,o=!n&&r;try{return JSON.parse(e)}catch(ku){if(o){if("SyntaxError"===ku.name)throw Ki.from(ku,Ki.ERR_BAD_RESPONSE,this,null,this.response);throw ku}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:da.classes.FormData,Blob:da.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};qi.forEach(["delete","get","head","post","put","patch"],(e=>{va.headers[e]={}}));var ba=va;const wa=qi.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]);var Ea=e=>{const t={};let n,r,o;return e&&e.split("\n").forEach((function(e){o=e.indexOf(":"),n=e.substring(0,o).trim().toLowerCase(),r=e.substring(o+1).trim(),!n||t[n]&&wa[n]||("set-cookie"===n?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)})),t};const _a=Symbol("internals");function Sa(e){return e&&String(e).trim().toLowerCase()}function Oa(e){return!1===e||null==e?e:qi.isArray(e)?e.map(Oa):String(e)}function xa(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;while(r=n.exec(e))t[r[1]]=r[2];return t}const Aa=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Ra(e,t,n,r,o){return qi.isFunction(r)?r.call(this,t,n):(o&&(t=n),qi.isString(t)?qi.isString(r)?-1!==t.indexOf(r):qi.isRegExp(r)?r.test(t):void 0:void 0)}function Pa(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,n)=>t.toUpperCase()+n))}function Ca(e,t){const n=qi.toCamelCase(" "+t);["get","set","has"].forEach((r=>{Object.defineProperty(e,r+n,{value:function(e,n,o){return this[r].call(this,t,e,n,o)},configurable:!0})}))}class ka{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function o(e,t,n){const o=Sa(t);if(!o)throw new Error("header name must be a non-empty string");const s=qi.findKey(r,o);(!s||void 0===r[s]||!0===n||void 0===n&&!1!==r[s])&&(r[s||t]=Oa(e))}const s=(e,t)=>qi.forEach(e,((e,n)=>o(e,n,t)));return qi.isPlainObject(e)||e instanceof this.constructor?s(e,t):qi.isString(e)&&(e=e.trim())&&!Aa(e)?s(Ea(e),t):null!=e&&o(t,e,n),this}get(e,t){if(e=Sa(e),e){const n=qi.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return xa(e);if(qi.isFunction(t))return t.call(this,e,n);if(qi.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Sa(e),e){const n=qi.findKey(this,e);return!(!n||void 0===this[n]||t&&!Ra(this,this[n],n,t))}return!1}delete(e,t){const n=this;let r=!1;function o(e){if(e=Sa(e),e){const o=qi.findKey(n,e);!o||t&&!Ra(n,n[o],o,t)||(delete n[o],r=!0)}}return qi.isArray(e)?e.forEach(o):o(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;while(n--){const o=t[n];e&&!Ra(this,this[o],o,e,!0)||(delete this[o],r=!0)}return r}normalize(e){const t=this,n={};return qi.forEach(this,((r,o)=>{const s=qi.findKey(n,o);if(s)return t[s]=Oa(r),void delete t[o];const i=e?Pa(o):String(o).trim();i!==o&&delete t[o],t[i]=Oa(r),n[i]=!0})),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return qi.forEach(this,((n,r)=>{null!=n&&!1!==n&&(t[r]=e&&qi.isArray(n)?n.join(", "):n)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([e,t])=>e+": "+t)).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach((e=>n.set(e))),n}static accessor(e){const t=this[_a]=this[_a]={accessors:{}},n=t.accessors,r=this.prototype;function o(e){const t=Sa(e);n[t]||(Ca(r,e),n[t]=!0)}return qi.isArray(e)?e.forEach(o):o(e),this}}ka.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),qi.reduceDescriptors(ka.prototype,(({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[n]=e}}})),qi.freezeMethods(ka);var Ta=ka;function Ia(e,t){const n=this||ba,r=t||n,o=Ta.from(r.headers);let s=r.data;return qi.forEach(e,(function(e){s=e.call(n,s,o.normalize(),t?t.status:void 0)})),o.normalize(),s}function ja(e){return!(!e||!e.__CANCEL__)}function Na(e,t,n){Ki.call(this,null==e?"canceled":e,Ki.ERR_CANCELED,t,n),this.name="CanceledError"}qi.inherits(Na,Ki,{__CANCEL__:!0});var Da=Na;function qa(e,t,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new Ki("Request failed with status code "+n.status,[Ki.ERR_BAD_REQUEST,Ki.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}var Ba=da.hasStandardBrowserEnv?{write(e,t,n,r,o,s){const i=[e+"="+encodeURIComponent(t)];qi.isNumber(n)&&i.push("expires="+new Date(n).toGMTString()),qi.isString(r)&&i.push("path="+r),qi.isString(o)&&i.push("domain="+o),!0===s&&i.push("secure"),document.cookie=i.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Ua(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Ma(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}function Ka(e,t){return e&&!Ua(t)?Ma(e,t):t}var La=da.hasStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");let n;function r(n){let r=n;return e&&(t.setAttribute("href",r),r=t.href),t.setAttribute("href",r),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:"/"===t.pathname.charAt(0)?t.pathname:"/"+t.pathname}}return n=r(window.location.href),function(e){const t=qi.isString(e)?r(e):e;return t.protocol===n.protocol&&t.host===n.host}}():function(){return function(){return!0}}();function $a(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Fa(e,t){e=e||10;const n=new Array(e),r=new Array(e);let o,s=0,i=0;return t=void 0!==t?t:1e3,function(a){const l=Date.now(),u=r[i];o||(o=l),n[s]=a,r[s]=l;let c=i,d=0;while(c!==s)d+=n[c++],c%=e;if(s=(s+1)%e,s===i&&(i=(i+1)%e),l-o<t)return;const h=u&&l-u;return h?Math.round(1e3*d/h):void 0}}var Va=Fa;function za(e,t){let n=0;const r=Va(50,250);return o=>{const s=o.loaded,i=o.lengthComputable?o.total:void 0,a=s-n,l=r(a),u=s<=i;n=s;const c={loaded:s,total:i,progress:i?s/i:void 0,bytes:a,rate:l||void 0,estimated:l&&i&&u?(i-s)/l:void 0,event:o};c[t?"download":"upload"]=!0,e(c)}}const Ha="undefined"!==typeof XMLHttpRequest;var Wa=Ha&&function(e){return new Promise((function(t,n){let r=e.data;const o=Ta.from(e.headers).normalize();let s,i,{responseType:a,withXSRFToken:l}=e;function u(){e.cancelToken&&e.cancelToken.unsubscribe(s),e.signal&&e.signal.removeEventListener("abort",s)}if(qi.isFormData(r))if(da.hasStandardBrowserEnv||da.hasStandardBrowserWebWorkerEnv)o.setContentType(!1);else if(!1!==(i=o.getContentType())){const[e,...t]=i?i.split(";").map((e=>e.trim())).filter(Boolean):[];o.setContentType([e||"multipart/form-data",...t].join("; "))}let c=new XMLHttpRequest;if(e.auth){const t=e.auth.username||"",n=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";o.set("Authorization","Basic "+btoa(t+":"+n))}const d=Ka(e.baseURL,e.url);function h(){if(!c)return;const r=Ta.from("getAllResponseHeaders"in c&&c.getAllResponseHeaders()),o=a&&"text"!==a&&"json"!==a?c.response:c.responseText,s={data:o,status:c.status,statusText:c.statusText,headers:r,config:e,request:c};qa((function(e){t(e),u()}),(function(e){n(e),u()}),s),c=null}if(c.open(e.method.toUpperCase(),ea(d,e.params,e.paramsSerializer),!0),c.timeout=e.timeout,"onloadend"in c?c.onloadend=h:c.onreadystatechange=function(){c&&4===c.readyState&&(0!==c.status||c.responseURL&&0===c.responseURL.indexOf("file:"))&&setTimeout(h)},c.onabort=function(){c&&(n(new Ki("Request aborted",Ki.ECONNABORTED,e,c)),c=null)},c.onerror=function(){n(new Ki("Network Error",Ki.ERR_NETWORK,e,c)),c=null},c.ontimeout=function(){let t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const r=e.transitional||ra;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(new Ki(t,r.clarifyTimeoutError?Ki.ETIMEDOUT:Ki.ECONNABORTED,e,c)),c=null},da.hasStandardBrowserEnv&&(l&&qi.isFunction(l)&&(l=l(e)),l||!1!==l&&La(d))){const t=e.xsrfHeaderName&&e.xsrfCookieName&&Ba.read(e.xsrfCookieName);t&&o.set(e.xsrfHeaderName,t)}void 0===r&&o.setContentType(null),"setRequestHeader"in c&&qi.forEach(o.toJSON(),(function(e,t){c.setRequestHeader(t,e)})),qi.isUndefined(e.withCredentials)||(c.withCredentials=!!e.withCredentials),a&&"json"!==a&&(c.responseType=e.responseType),"function"===typeof e.onDownloadProgress&&c.addEventListener("progress",za(e.onDownloadProgress,!0)),"function"===typeof e.onUploadProgress&&c.upload&&c.upload.addEventListener("progress",za(e.onUploadProgress)),(e.cancelToken||e.signal)&&(s=t=>{c&&(n(!t||t.type?new Da(null,e,c):t),c.abort(),c=null)},e.cancelToken&&e.cancelToken.subscribe(s),e.signal&&(e.signal.aborted?s():e.signal.addEventListener("abort",s)));const f=$a(d);f&&-1===da.protocols.indexOf(f)?n(new Ki("Unsupported protocol "+f+":",Ki.ERR_BAD_REQUEST,e)):c.send(r||null)}))};const Ga={http:Li,xhr:Wa};qi.forEach(Ga,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(ku){}Object.defineProperty(e,"adapterName",{value:t})}}));const Ja=e=>`- ${e}`,Ya=e=>qi.isFunction(e)||null===e||!1===e;var Xa={getAdapter:e=>{e=qi.isArray(e)?e:[e];const{length:t}=e;let n,r;const o={};for(let s=0;s<t;s++){let t;if(n=e[s],r=n,!Ya(n)&&(r=Ga[(t=String(n)).toLowerCase()],void 0===r))throw new Ki(`Unknown adapter '${t}'`);if(r)break;o[t||"#"+s]=r}if(!r){const e=Object.entries(o).map((([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build")));let n=t?e.length>1?"since :\n"+e.map(Ja).join("\n"):" "+Ja(e[0]):"as no adapter specified";throw new Ki("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return r},adapters:Ga};function Qa(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Da(null,e)}function Za(e){Qa(e),e.headers=Ta.from(e.headers),e.data=Ia.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);const t=Xa.getAdapter(e.adapter||ba.adapter);return t(e).then((function(t){return Qa(e),t.data=Ia.call(e,e.transformResponse,t),t.headers=Ta.from(t.headers),t}),(function(t){return ja(t)||(Qa(e),t&&t.response&&(t.response.data=Ia.call(e,e.transformResponse,t.response),t.response.headers=Ta.from(t.response.headers))),Promise.reject(t)}))}const el=e=>e instanceof Ta?e.toJSON():e;function tl(e,t){t=t||{};const n={};function r(e,t,n){return qi.isPlainObject(e)&&qi.isPlainObject(t)?qi.merge.call({caseless:n},e,t):qi.isPlainObject(t)?qi.merge({},t):qi.isArray(t)?t.slice():t}function o(e,t,n){return qi.isUndefined(t)?qi.isUndefined(e)?void 0:r(void 0,e,n):r(e,t,n)}function s(e,t){if(!qi.isUndefined(t))return r(void 0,t)}function i(e,t){return qi.isUndefined(t)?qi.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function a(n,o,s){return s in t?r(n,o):s in e?r(void 0,n):void 0}const l={url:s,method:s,data:s,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:a,headers:(e,t)=>o(el(e),el(t),!0)};return qi.forEach(Object.keys(Object.assign({},e,t)),(function(r){const s=l[r]||o,i=s(e[r],t[r],r);qi.isUndefined(i)&&s!==a||(n[r]=i)})),n}const nl="1.6.2",rl={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{rl[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));const ol={};function sl(e,t,n){if("object"!==typeof e)throw new Ki("options must be an object",Ki.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let o=r.length;while(o-- >0){const s=r[o],i=t[s];if(i){const t=e[s],n=void 0===t||i(t,s,e);if(!0!==n)throw new Ki("option "+s+" must be "+n,Ki.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new Ki("Unknown option "+s,Ki.ERR_BAD_OPTION)}}rl.transitional=function(e,t,n){function r(e,t){return"[Axios v"+nl+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,o,s)=>{if(!1===e)throw new Ki(r(o," has been removed"+(t?" in "+t:"")),Ki.ERR_DEPRECATED);return t&&!ol[o]&&(ol[o]=!0,console.warn(r(o," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,o,s)}};var il={assertOptions:sl,validators:rl};const al=il.validators;class ll{constructor(e){this.defaults=e,this.interceptors={request:new na,response:new na}}request(e,t){"string"===typeof e?(t=t||{},t.url=e):t=e||{},t=tl(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:o}=t;void 0!==n&&il.assertOptions(n,{silentJSONParsing:al.transitional(al.boolean),forcedJSONParsing:al.transitional(al.boolean),clarifyTimeoutError:al.transitional(al.boolean)},!1),null!=r&&(qi.isFunction(r)?t.paramsSerializer={serialize:r}:il.assertOptions(r,{encode:al.function,serialize:al.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let s=o&&qi.merge(o.common,o[t.method]);o&&qi.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete o[e]})),t.headers=Ta.concat(s,o);const i=[];let a=!0;this.interceptors.request.forEach((function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(a=a&&e.synchronous,i.unshift(e.fulfilled,e.rejected))}));const l=[];let u;this.interceptors.response.forEach((function(e){l.push(e.fulfilled,e.rejected)}));let c,d=0;if(!a){const e=[Za.bind(this),void 0];e.unshift.apply(e,i),e.push.apply(e,l),c=e.length,u=Promise.resolve(t);while(d<c)u=u.then(e[d++],e[d++]);return u}c=i.length;let h=t;d=0;while(d<c){const e=i[d++],t=i[d++];try{h=e(h)}catch(f){t.call(this,f);break}}try{u=Za.call(this,h)}catch(f){return Promise.reject(f)}d=0,c=l.length;while(d<c)u=u.then(l[d++],l[d++]);return u}getUri(e){e=tl(this.defaults,e);const t=Ka(e.baseURL,e.url);return ea(t,e.params,e.paramsSerializer)}}qi.forEach(["delete","get","head","options"],(function(e){ll.prototype[e]=function(t,n){return this.request(tl(n||{},{method:e,url:t,data:(n||{}).data}))}})),qi.forEach(["post","put","patch"],(function(e){function t(t){return function(n,r,o){return this.request(tl(o||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}ll.prototype[e]=t(),ll.prototype[e+"Form"]=t(!0)}));var ul=ll;class cl{constructor(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const n=this;this.promise.then((e=>{if(!n._listeners)return;let t=n._listeners.length;while(t-- >0)n._listeners[t](e);n._listeners=null})),this.promise.then=e=>{let t;const r=new Promise((e=>{n.subscribe(e),t=e})).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e((function(e,r,o){n.reason||(n.reason=new Da(e,r,o),t(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}static source(){let e;const t=new cl((function(t){e=t}));return{token:t,cancel:e}}}var dl=cl;function hl(e){return function(t){return e.apply(null,t)}}function fl(e){return qi.isObject(e)&&!0===e.isAxiosError}const pl={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(pl).forEach((([e,t])=>{pl[t]=e}));var ml=pl;function yl(e){const t=new ul(e),n=Ns(ul.prototype.request,t);return qi.extend(n,ul.prototype,t,{allOwnKeys:!0}),qi.extend(n,t,null,{allOwnKeys:!0}),n.create=function(t){return yl(tl(e,t))},n}const gl=yl(ba);gl.Axios=ul,gl.CanceledError=Da,gl.CancelToken=dl,gl.isCancel=ja,gl.VERSION=nl,gl.toFormData=Gi,gl.AxiosError=Ki,gl.Cancel=gl.CanceledError,gl.all=function(e){return Promise.all(e)},gl.spread=hl,gl.isAxiosError=fl,gl.mergeConfig=tl,gl.AxiosHeaders=Ta,gl.formToJSON=e=>ya(qi.isHTMLForm(e)?new FormData(e):e),gl.getAdapter=Xa.getAdapter,gl.HttpStatusCode=ml,gl.default=gl;var vl=gl;async function bl(e,t,n,r,o,s,i,a,l){const u=t.replace(/^https?:\/\//,"").replace(/\/$/,""),c=`https://${u}/models/${n}:generateText`,d={"Content-Type":"application/json"},h={key:e},f={prompt:{text:r},temperature:l,maxOutputTokens:a};let p;try{if(p=await vl.post(c,f,{headers:d,params:h}),200!==p.status)throw new Error(`Status code: ${p.status}`);o.value=p.data?.candidates[0]?.output||""}catch(m){console.error(m),o.value=String(m),s.value=!0}i.value=!1}var wl={createChatCompletionStream:bl};function El(e,t){const n=e.value.replace(/\n+/g,"\n").replace(/\r+/g,"\n").split("\n");switch(t.value){case"replace":Word.run((async e=>{const t=e.document.getSelection();t.insertText(n[0],"Replace");for(let r=n.length-1;r>0;r--)t.insertParagraph(n[r],"After");await e.sync()}));break;case"append":Word.run((async e=>{const t=e.document.getSelection();t.insertText(n[0],"End");for(let r=n.length-1;r>0;r--)t.insertParagraph(n[r],"After");await e.sync()}));break;case"newLine":Word.run((async e=>{const t=e.document.getSelection();for(let r=n.length-1;r>=0;r--)t.insertParagraph(n[r],"After");await e.sync()}));break;case"NoAction":break}}var _l={insertResult:El};
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Sl=["user","model","function"];var Ol,xl,Al,Rl,Pl,Cl,kl;(function(e){e["HARM_CATEGORY_UNSPECIFIED"]="HARM_CATEGORY_UNSPECIFIED",e["HARM_CATEGORY_HATE_SPEECH"]="HARM_CATEGORY_HATE_SPEECH",e["HARM_CATEGORY_SEXUALLY_EXPLICIT"]="HARM_CATEGORY_SEXUALLY_EXPLICIT",e["HARM_CATEGORY_HARASSMENT"]="HARM_CATEGORY_HARASSMENT",e["HARM_CATEGORY_DANGEROUS_CONTENT"]="HARM_CATEGORY_DANGEROUS_CONTENT"})(Ol||(Ol={})),function(e){e["HARM_BLOCK_THRESHOLD_UNSPECIFIED"]="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e["BLOCK_LOW_AND_ABOVE"]="BLOCK_LOW_AND_ABOVE",e["BLOCK_MEDIUM_AND_ABOVE"]="BLOCK_MEDIUM_AND_ABOVE",e["BLOCK_ONLY_HIGH"]="BLOCK_ONLY_HIGH",e["BLOCK_NONE"]="BLOCK_NONE"}(xl||(xl={})),function(e){e["HARM_PROBABILITY_UNSPECIFIED"]="HARM_PROBABILITY_UNSPECIFIED",e["NEGLIGIBLE"]="NEGLIGIBLE",e["LOW"]="LOW",e["MEDIUM"]="MEDIUM",e["HIGH"]="HIGH"}(Al||(Al={})),function(e){e["BLOCKED_REASON_UNSPECIFIED"]="BLOCKED_REASON_UNSPECIFIED",e["SAFETY"]="SAFETY",e["OTHER"]="OTHER"}(Rl||(Rl={})),function(e){e["FINISH_REASON_UNSPECIFIED"]="FINISH_REASON_UNSPECIFIED",e["STOP"]="STOP",e["MAX_TOKENS"]="MAX_TOKENS",e["SAFETY"]="SAFETY",e["RECITATION"]="RECITATION",e["OTHER"]="OTHER"}(Pl||(Pl={})),function(e){e["TASK_TYPE_UNSPECIFIED"]="TASK_TYPE_UNSPECIFIED",e["RETRIEVAL_QUERY"]="RETRIEVAL_QUERY",e["RETRIEVAL_DOCUMENT"]="RETRIEVAL_DOCUMENT",e["SEMANTIC_SIMILARITY"]="SEMANTIC_SIMILARITY",e["CLASSIFICATION"]="CLASSIFICATION",e["CLUSTERING"]="CLUSTERING"}(Cl||(Cl={})),function(e){e["STRING"]="STRING",e["NUMBER"]="NUMBER",e["INTEGER"]="INTEGER",e["BOOLEAN"]="BOOLEAN",e["ARRAY"]="ARRAY",e["OBJECT"]="OBJECT"}(kl||(kl={}));
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Tl extends Error{constructor(e){super(`[GoogleGenerativeAI Error]: ${e}`)}}class Il extends Tl{constructor(e,t){super(e),this.response=t}}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jl="https://generativelanguage.googleapis.com",Nl="v1",Dl="0.5.0",ql="genai-js";var Bl;(function(e){e["GENERATE_CONTENT"]="generateContent",e["STREAM_GENERATE_CONTENT"]="streamGenerateContent",e["COUNT_TOKENS"]="countTokens",e["EMBED_CONTENT"]="embedContent",e["BATCH_EMBED_CONTENTS"]="batchEmbedContents"})(Bl||(Bl={}));class Ul{constructor(e,t,n,r,o){this.model=e,this.task=t,this.apiKey=n,this.stream=r,this.requestOptions=o}toString(){var e,t;const n=(null===(e=this.requestOptions)||void 0===e?void 0:e.apiVersion)||Nl,r=(null===(t=this.requestOptions)||void 0===t?void 0:t.baseUrl)||jl;let o=`${r}/${n}/${this.model}:${this.task}`;return this.stream&&(o+="?alt=sse"),o}}function Ml(e){const t=[];return(null===e||void 0===e?void 0:e.apiClient)&&t.push(e.apiClient),t.push(`${ql}/${Dl}`),t.join(" ")}async function Kl(e,t,n){let r;try{if(r=await fetch(e.toString(),Object.assign(Object.assign({},Ll(n)),{method:"POST",headers:{"Content-Type":"application/json","x-goog-api-client":Ml(n),"x-goog-api-key":e.apiKey},body:t})),!r.ok){let e="";try{const t=await r.json();e=t.error.message,t.error.details&&(e+=` ${JSON.stringify(t.error.details)}`)}catch(ku){}throw new Error(`[${r.status} ${r.statusText}] ${e}`)}}catch(ku){const n=new Tl(`Error fetching from ${e.toString()}: ${ku.message}`);throw n.stack=ku.stack,n}return r}function Ll(e){const t={};if((null===e||void 0===e?void 0:e.timeout)>=0){const n=new AbortController,r=n.signal;setTimeout((()=>n.abort()),e.timeout),t.signal=r}return t}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $l(e){return e.text=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),Hl(e.candidates[0]))throw new Il(`${Wl(e)}`,e);return Fl(e)}if(e.promptFeedback)throw new Il(`Text not available. ${Wl(e)}`,e);return""},e.functionCall=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),Hl(e.candidates[0]))throw new Il(`${Wl(e)}`,e);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),Vl(e)[0]}if(e.promptFeedback)throw new Il(`Function call not available. ${Wl(e)}`,e)},e.functionCalls=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),Hl(e.candidates[0]))throw new Il(`${Wl(e)}`,e);return Vl(e)}if(e.promptFeedback)throw new Il(`Function call not available. ${Wl(e)}`,e)},e}function Fl(e){var t,n,r,o;return(null===(o=null===(r=null===(n=null===(t=e.candidates)||void 0===t?void 0:t[0].content)||void 0===n?void 0:n.parts)||void 0===r?void 0:r[0])||void 0===o?void 0:o.text)?e.candidates[0].content.parts.map((({text:e})=>e)).join(""):""}function Vl(e){var t,n,r,o;const s=[];if(null===(n=null===(t=e.candidates)||void 0===t?void 0:t[0].content)||void 0===n?void 0:n.parts)for(const i of null===(o=null===(r=e.candidates)||void 0===r?void 0:r[0].content)||void 0===o?void 0:o.parts)i.functionCall&&s.push(i.functionCall);return s.length>0?s:void 0}const zl=[Pl.RECITATION,Pl.SAFETY];function Hl(e){return!!e.finishReason&&zl.includes(e.finishReason)}function Wl(e){var t,n,r;let o="";if(e.candidates&&0!==e.candidates.length||!e.promptFeedback){if(null===(r=e.candidates)||void 0===r?void 0:r[0]){const t=e.candidates[0];Hl(t)&&(o+=`Candidate was blocked due to ${t.finishReason}`,t.finishMessage&&(o+=`: ${t.finishMessage}`))}}else o+="Response was blocked",(null===(t=e.promptFeedback)||void 0===t?void 0:t.blockReason)&&(o+=` due to ${e.promptFeedback.blockReason}`),(null===(n=e.promptFeedback)||void 0===n?void 0:n.blockReasonMessage)&&(o+=`: ${e.promptFeedback.blockReasonMessage}`);return o}function Gl(e){return this instanceof Gl?(this.v=e,this):new Gl(e)}function Jl(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),s=[];return r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r;function i(e){o[e]&&(r[e]=function(t){return new Promise((function(n,r){s.push([e,t,n,r])>1||a(e,t)}))})}function a(e,t){try{l(o[e](t))}catch(ku){d(s[0][3],ku)}}function l(e){e.value instanceof Gl?Promise.resolve(e.value.v).then(u,c):d(s[0][2],e)}function u(e){a("next",e)}function c(e){a("throw",e)}function d(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}"function"===typeof SuppressedError&&SuppressedError;
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Yl=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function Xl(e){const t=e.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),n=eu(t),[r,o]=n.tee();return{stream:Zl(r),response:Ql(o)}}async function Ql(e){const t=[],n=e.getReader();while(1){const{done:e,value:r}=await n.read();if(e)return $l(tu(t));t.push(r)}}function Zl(e){return Jl(this,arguments,(function*(){const t=e.getReader();while(1){const{value:e,done:n}=yield Gl(t.read());if(n)break;yield yield Gl($l(e))}}))}function eu(e){const t=e.getReader(),n=new ReadableStream({start(e){let n="";return r();function r(){return t.read().then((({value:t,done:o})=>{if(o)return n.trim()?void e.error(new Tl("Failed to parse stream")):void e.close();n+=t;let s,i=n.match(Yl);while(i){try{s=JSON.parse(i[1])}catch(ku){return void e.error(new Tl(`Error parsing JSON response: "${i[1]}"`))}e.enqueue(s),n=n.substring(i[0].length),i=n.match(Yl)}return r()}))}}});return n}function tu(e){const t=e[e.length-1],n={promptFeedback:null===t||void 0===t?void 0:t.promptFeedback};for(const r of e)if(r.candidates)for(const e of r.candidates){const t=e.index;if(n.candidates||(n.candidates=[]),n.candidates[t]||(n.candidates[t]={index:e.index}),n.candidates[t].citationMetadata=e.citationMetadata,n.candidates[t].finishReason=e.finishReason,n.candidates[t].finishMessage=e.finishMessage,n.candidates[t].safetyRatings=e.safetyRatings,e.content&&e.content.parts){n.candidates[t].content||(n.candidates[t].content={role:e.content.role||"user",parts:[]});const r={};for(const o of e.content.parts)o.text&&(r.text=o.text),o.functionCall&&(r.functionCall=o.functionCall),0===Object.keys(r).length&&(r.text=""),n.candidates[t].content.parts.push(r)}}return n}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nu(e,t,n,r){const o=new Ul(t,Bl.STREAM_GENERATE_CONTENT,e,!0,r),s=await Kl(o,JSON.stringify(n),r);return Xl(s)}async function ru(e,t,n,r){const o=new Ul(t,Bl.GENERATE_CONTENT,e,!1,r),s=await Kl(o,JSON.stringify(n),r),i=await s.json(),a=$l(i);return{response:a}}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ou(e){let t=[];if("string"===typeof e)t=[{text:e}];else for(const n of e)"string"===typeof n?t.push({text:n}):t.push(n);return su(t)}function su(e){const t={role:"user",parts:[]},n={role:"function",parts:[]};let r=!1,o=!1;for(const s of e)"functionResponse"in s?(n.parts.push(s),o=!0):(t.parts.push(s),r=!0);if(r&&o)throw new Tl("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!r&&!o)throw new Tl("No content is provided for sending chat message.");return r?t:n}function iu(e){if(e.contents)return e;{const t=ou(e);return{contents:[t]}}}function au(e){if("string"===typeof e||Array.isArray(e)){const t=ou(e);return{content:t}}return e}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lu=["text","inlineData","functionCall","functionResponse"],uu={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall"]},cu={user:["model"],function:["model"],model:["user","function"]};function du(e){let t;for(const n of e){const{role:e,parts:r}=n;if(!t&&"user"!==e)throw new Tl(`First content should be with role 'user', got ${e}`);if(!Sl.includes(e))throw new Tl(`Each item should include role field. Got ${e} but valid roles are: ${JSON.stringify(Sl)}`);if(!Array.isArray(r))throw new Tl("Content should have 'parts' property with an array of Parts");if(0===r.length)throw new Tl("Each Content should have at least one part");const o={text:0,inlineData:0,functionCall:0,functionResponse:0};for(const t of r)for(const e of lu)e in t&&(o[e]+=1);const s=uu[e];for(const t of lu)if(!s.includes(t)&&o[t]>0)throw new Tl(`Content with role '${e}' can't contain '${t}' part`);if(t){const n=cu[e];if(!n.includes(t.role))throw new Tl(`Content with role '${e}' can't follow '${t.role}'. Valid previous roles: ${JSON.stringify(cu)}`)}t=n}}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hu="SILENT_ERROR";class fu{constructor(e,t,n,r){this.model=t,this.params=n,this.requestOptions=r,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,(null===n||void 0===n?void 0:n.history)&&(du(n.history),this._history=n.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e){var t,n,r;await this._sendPromise;const o=ou(e),s={safetySettings:null===(t=this.params)||void 0===t?void 0:t.safetySettings,generationConfig:null===(n=this.params)||void 0===n?void 0:n.generationConfig,tools:null===(r=this.params)||void 0===r?void 0:r.tools,contents:[...this._history,o]};let i;return this._sendPromise=this._sendPromise.then((()=>ru(this._apiKey,this.model,s,this.requestOptions))).then((e=>{var t;if(e.response.candidates&&e.response.candidates.length>0){this._history.push(o);const n=Object.assign({parts:[],role:"model"},null===(t=e.response.candidates)||void 0===t?void 0:t[0].content);this._history.push(n)}else{const t=Wl(e.response);t&&console.warn(`sendMessage() was unsuccessful. ${t}. Inspect response object for details.`)}i=e})),await this._sendPromise,i}async sendMessageStream(e){var t,n,r;await this._sendPromise;const o=ou(e),s={safetySettings:null===(t=this.params)||void 0===t?void 0:t.safetySettings,generationConfig:null===(n=this.params)||void 0===n?void 0:n.generationConfig,tools:null===(r=this.params)||void 0===r?void 0:r.tools,contents:[...this._history,o]},i=nu(this._apiKey,this.model,s,this.requestOptions);return this._sendPromise=this._sendPromise.then((()=>i)).catch((e=>{throw new Error(hu)})).then((e=>e.response)).then((e=>{if(e.candidates&&e.candidates.length>0){this._history.push(o);const t=Object.assign({},e.candidates[0].content);t.role||(t.role="model"),this._history.push(t)}else{const t=Wl(e);t&&console.warn(`sendMessageStream() was unsuccessful. ${t}. Inspect response object for details.`)}})).catch((e=>{e.message!==hu&&console.error(e)})),i}}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pu(e,t,n,r){const o=new Ul(t,Bl.COUNT_TOKENS,e,!1,r),s=await Kl(o,JSON.stringify(Object.assign(Object.assign({},n),{model:t})),r);return s.json()}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mu(e,t,n,r){const o=new Ul(t,Bl.EMBED_CONTENT,e,!1,r),s=await Kl(o,JSON.stringify(n),r);return s.json()}async function yu(e,t,n,r){const o=new Ul(t,Bl.BATCH_EMBED_CONTENTS,e,!1,r),s=n.requests.map((e=>Object.assign(Object.assign({},e),{model:t}))),i=await Kl(o,JSON.stringify({requests:s}),r);return i.json()}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(e,t,n){this.apiKey=e,t.model.includes("/")?this.model=t.model:this.model=`models/${t.model}`,this.generationConfig=t.generationConfig||{},this.safetySettings=t.safetySettings||[],this.tools=t.tools,this.requestOptions=n||{}}async generateContent(e){const t=iu(e);return ru(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools},t),this.requestOptions)}async generateContentStream(e){const t=iu(e);return nu(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools},t),this.requestOptions)}startChat(e){return new fu(this.apiKey,this.model,Object.assign({tools:this.tools},e),this.requestOptions)}async countTokens(e){const t=iu(e);return pu(this.apiKey,this.model,t)}async embedContent(e){const t=au(e);return mu(this.apiKey,this.model,t)}async batchEmbedContents(e){return yu(this.apiKey,this.model,e,this.requestOptions)}}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu{constructor(e){this.apiKey=e}getGenerativeModel(e,t){if(!e.model)throw new Tl("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new gu(this.apiKey,e,t)}}async function bu(e){const t=e.geminiAPIKey,n={maxOutputTokens:e.maxTokens??800,temperature:e.temperature??.7};try{const r=new vu(t),o=r.getGenerativeModel({model:e.geminiModel??"gemini-pro"},{apiVersion:"v1beta"}),s=o.startChat({history:e.historyDialog.value,generationConfig:n}),i=await s.sendMessage(e.messages),a=await i.response,l=a.text();wu(l,e.messages,e.result,e.historyDialog)}catch(r){Eu(r,e.result,e.errorIssue)}e.loading.value=!1}function wu(e,t,n,r){n.value=e,r.value.push({role:"user",parts:[{text:t}]},{role:"model",parts:[{text:e}]})}function Eu(e,t,n){t.value=String(e),n.value=!0,console.error(e)}var _u={createChatCompletionStream:bu};async function Su(e,t,n,r,o,s,i,a){const l=e.replace(/\/$/,""),u=`${l}/api/chat`,c={"Content-Type":"application/json"},d={model:t,options:{temperature:a},stream:!1,messages:n};let h;try{if(h=await vl.post(u,d,{headers:c}),200!==h.status)throw new Error(`Status code: ${h.status}`);r.value=h.data?.message?.content?.replace(/\\n/g,"\n")??"",o.value.push({role:"assistant",content:r.value})}catch(f){console.error(f),r.value=String(f),s.value=!0}i.value=!1}var Ou={createChatCompletionStream:Su},xu={official:St,azure:js,palm:wl,gemini:_u,common:_l,ollama:Ou};function Au(e){return Au="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Au(e)}function Ru(e,t){if("object"!==Au(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Au(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function Pu(e){var t=Ru(e,"string");return"symbol"===Au(t)?t:String(t)}function Cu(e,t,n){return t=Pu(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n(88);const ku="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,Tu=Object.keys,Iu=Array.isArray;function ju(e,t){return"object"!=typeof t||Tu(t).forEach((function(n){e[n]=t[n]})),e}"undefined"==typeof Promise||ku.Promise||(ku.Promise=Promise);const Nu=Object.getPrototypeOf,Du={}.hasOwnProperty;function qu(e,t){return Du.call(e,t)}function Bu(e,t){"function"==typeof t&&(t=t(Nu(e))),("undefined"==typeof Reflect?Tu:Reflect.ownKeys)(t).forEach((n=>{Mu(e,n,t[n])}))}const Uu=Object.defineProperty;function Mu(e,t,n,r){Uu(e,t,ju(n&&qu(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function Ku(e){return{from:function(t){return e.prototype=Object.create(t.prototype),Mu(e.prototype,"constructor",e),{extend:Bu.bind(null,e.prototype)}}}}const Lu=Object.getOwnPropertyDescriptor;function $u(e,t){let n;return Lu(e,t)||(n=Nu(e))&&$u(n,t)}const Fu=[].slice;function Vu(e,t,n){return Fu.call(e,t,n)}function zu(e,t){return t(e)}function Hu(e){if(!e)throw new Error("Assertion Failed")}function Wu(e){ku.setImmediate?setImmediate(e):setTimeout(e,0)}function Gu(e,t){return e.reduce(((e,n,r)=>{var o=t(n,r);return o&&(e[o[0]]=o[1]),e}),{})}function Ju(e,t){if(qu(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],r=0,o=t.length;r<o;++r){var s=Ju(e,t[r]);n.push(s)}return n}var i=t.indexOf(".");if(-1!==i){var a=e[t.substr(0,i)];return void 0===a?void 0:Ju(a,t.substr(i+1))}}function Yu(e,t,n){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){Hu("string"!=typeof n&&"length"in n);for(var r=0,o=t.length;r<o;++r)Yu(e,t[r],n[r])}else{var s=t.indexOf(".");if(-1!==s){var i=t.substr(0,s),a=t.substr(s+1);if(""===a)void 0===n?Iu(e)&&!isNaN(parseInt(i))?e.splice(i,1):delete e[i]:e[i]=n;else{var l=e[i];l&&qu(e,i)||(l=e[i]={}),Yu(l,a,n)}}else void 0===n?Iu(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function Xu(e){var t={};for(var n in e)qu(e,n)&&(t[n]=e[n]);return t}const Qu=[].concat;function Zu(e){return Qu.apply([],e)}const ec="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Zu([8,16,32,64].map((e=>["Int","Uint","Float"].map((t=>t+e+"Array")))))).filter((e=>ku[e])),tc=ec.map((e=>ku[e]));Gu(ec,(e=>[e,!0]));let nc=null;function rc(e){nc="undefined"!=typeof WeakMap&&new WeakMap;const t=oc(e);return nc=null,t}function oc(e){if(!e||"object"!=typeof e)return e;let t=nc&&nc.get(e);if(t)return t;if(Iu(e)){t=[],nc&&nc.set(e,t);for(var n=0,r=e.length;n<r;++n)t.push(oc(e[n]))}else if(tc.indexOf(e.constructor)>=0)t=e;else{const n=Nu(e);for(var o in t=n===Object.prototype?{}:Object.create(n),nc&&nc.set(e,t),e)qu(e,o)&&(t[o]=oc(e[o]))}return t}const{toString:sc}={};function ic(e){return sc.call(e).slice(8,-1)}const ac="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",lc="symbol"==typeof ac?function(e){var t;return null!=e&&(t=e[ac])&&t.apply(e)}:function(){return null},uc={};function cc(e){var t,n,r,o;if(1===arguments.length){if(Iu(e))return e.slice();if(this===uc&&"string"==typeof e)return[e];if(o=lc(e)){for(n=[];!(r=o.next()).done;)n.push(r.value);return n}if(null==e)return[e];if("number"==typeof(t=e.length)){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}const dc="undefined"!=typeof Symbol?e=>"AsyncFunction"===e[Symbol.toStringTag]:()=>!1;var hc="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function fc(e,t){hc=e,pc=t}var pc=()=>!0;const mc=!new Error("").stack;function yc(){if(mc)try{throw yc.arguments,new Error}catch(ku){return ku}return new Error}function gc(e,t){var n=e.stack;return n?(t=t||0,0===n.indexOf(e.name)&&(t+=(e.name+e.message).split("\n").length),n.split("\n").slice(t).filter(pc).map((e=>"\n"+e)).join("")):""}var vc=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],bc=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(vc),wc={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ec(e,t){this._e=yc(),this.name=e,this.message=t}function _c(e,t){return e+". Errors: "+Object.keys(t).map((e=>t[e].toString())).filter(((e,t,n)=>n.indexOf(e)===t)).join("\n")}function Sc(e,t,n,r){this._e=yc(),this.failures=t,this.failedKeys=r,this.successCount=n,this.message=_c(e,t)}function Oc(e,t){this._e=yc(),this.name="BulkError",this.failures=Object.keys(t).map((e=>t[e])),this.failuresByPos=t,this.message=_c(e,t)}Ku(Ec).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+gc(this._e,2))}},toString:function(){return this.name+": "+this.message}}),Ku(Sc).from(Ec),Ku(Oc).from(Ec);var xc=bc.reduce(((e,t)=>(e[t]=t+"Error",e)),{});const Ac=Ec;var Rc=bc.reduce(((e,t)=>{var n=t+"Error";function r(e,r){this._e=yc(),this.name=n,e?"string"==typeof e?(this.message=`${e}${r?"\n "+r:""}`,this.inner=r||null):"object"==typeof e&&(this.message=`${e.name} ${e.message}`,this.inner=e):(this.message=wc[t]||n,this.inner=null)}return Ku(r).from(Ac),e[t]=r,e}),{});Rc.Syntax=SyntaxError,Rc.Type=TypeError,Rc.Range=RangeError;var Pc=vc.reduce(((e,t)=>(e[t+"Error"]=Rc[t],e)),{}),Cc=bc.reduce(((e,t)=>(-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=Rc[t]),e)),{});function kc(){}function Tc(e){return e}function Ic(e,t){return null==e||e===Tc?t:function(n){return t(e(n))}}function jc(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function Nc(e,t){return e===kc?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var s=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?jc(r,this.onsuccess):r),o&&(this.onerror=this.onerror?jc(o,this.onerror):o),void 0!==s?s:n}}function Dc(e,t){return e===kc?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?jc(n,this.onsuccess):n),r&&(this.onerror=this.onerror?jc(r,this.onerror):r)}}function qc(e,t){return e===kc?t:function(n){var r=e.apply(this,arguments);ju(n,r);var o=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var i=t.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?jc(o,this.onsuccess):o),s&&(this.onerror=this.onerror?jc(s,this.onerror):s),void 0===r?void 0===i?void 0:i:ju(r,i)}}function Bc(e,t){return e===kc?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function Uc(e,t){return e===kc?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var r=this,o=arguments.length,s=new Array(o);o--;)s[o]=arguments[o];return n.then((function(){return t.apply(r,s)}))}return t.apply(this,arguments)}}Cc.ModifyError=Sc,Cc.DexieError=Ec,Cc.BulkError=Oc;var Mc={};const Kc=100,[Lc,$c,Fc]="undefined"==typeof Promise?[]:(()=>{let e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,Nu(e),e];const t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,Nu(t),e]})(),Vc=$c&&$c.then,zc=Lc&&Lc.constructor,Hc=!!Fc;var Wc=!1,Gc=Fc?()=>{Fc.then(gd)}:ku.setImmediate?setImmediate.bind(null,gd):ku.MutationObserver?()=>{var e=document.createElement("div");new MutationObserver((()=>{gd(),e=null})).observe(e,{attributes:!0}),e.setAttribute("i","1")}:()=>{setTimeout(gd,0)},Jc=function(e,t){od.push([e,t]),Xc&&(Gc(),Xc=!1)},Yc=!0,Xc=!0,Qc=[],Zc=[],ed=null,td=Tc,nd={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:$d,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach((e=>{try{$d(e[0],e[1])}catch(e){}}))}},rd=nd,od=[],sd=0,id=[];function ad(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=kc,this._lib=!1;var t=this._PSD=rd;if(hc&&(this._stackHolder=yc(),this._prev=null,this._numPrev=0),"function"!=typeof e){if(e!==Mc)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&dd(this,this._value))}this._state=null,this._value=null,++t.ref,cd(this,e)}const ld={get:function(){var e=rd,t=Rd;function n(n,r){var o=!e.global&&(e!==rd||t!==Rd);const s=o&&!Td();var i=new ad(((t,i)=>{fd(this,new ud(Md(n,e,o,s),Md(r,e,o,s),t,i,e))}));return hc&&yd(i,this),i}return n.prototype=Mc,n},set:function(e){Mu(this,"then",e&&e.prototype===Mc?ld:{get:function(){return e},set:ld.set})}};function ud(e,t,n,r,o){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r,this.psd=o}function cd(e,t){try{t((t=>{if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&vd();t&&"function"==typeof t.then?cd(e,((e,n)=>{t instanceof ad?t._then(e,n):t.then(e,n)})):(e._state=!0,e._value=t,hd(e)),n&&bd()}}),dd.bind(null,e))}catch(t){dd(e,t)}}function dd(e,t){if(Zc.push(t),null===e._state){var n=e._lib&&vd();t=td(t),e._state=!1,e._value=t,hc&&null!==t&&"object"==typeof t&&!t._promise&&function(e,t,n){try{e.apply(null,n)}catch(e){t&&t(e)}}((()=>{var n=$u(t,"stack");t._promise=e,Mu(t,"stack",{get:()=>Wc?n&&(n.get?n.get.apply(t):n.value):e.stack})})),function(e){Qc.some((t=>t._value===e._value))||Qc.push(e)}(e),hd(e),n&&bd()}}function hd(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)fd(e,t[n]);var o=e._PSD;--o.ref||o.finalize(),0===sd&&(++sd,Jc((()=>{0==--sd&&wd()}),[]))}function fd(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++sd,Jc(pd,[n,e,t])}else e._listeners.push(t)}function pd(e,t,n){try{ed=t;var r,o=t._value;t._state?r=e(o):(Zc.length&&(Zc=[]),r=e(o),-1===Zc.indexOf(o)&&function(e){for(var t=Qc.length;t;)if(Qc[--t]._value===e._value)return void Qc.splice(t,1)}(t)),n.resolve(r)}catch(e){n.reject(e)}finally{ed=null,0==--sd&&wd(),--n.psd.ref||n.psd.finalize()}}function md(e,t,n){if(t.length===n)return t;var r="";if(!1===e._state){var o,s,i=e._value;null!=i?(o=i.name||"Error",s=i.message||i,r=gc(i,0)):(o=i,s=""),t.push(o+(s?": "+s:"")+r)}return hc&&((r=gc(e._stackHolder,2))&&-1===t.indexOf(r)&&t.push(r),e._prev&&md(e._prev,t,n)),t}function yd(e,t){var n=t?t._numPrev+1:0;n<100&&(e._prev=t,e._numPrev=n)}function gd(){vd()&&bd()}function vd(){var e=Yc;return Yc=!1,Xc=!1,e}function bd(){var e,t,n;do{for(;od.length>0;)for(e=od,od=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}}while(od.length>0);Yc=!0,Xc=!0}function wd(){var e=Qc;Qc=[],e.forEach((e=>{e._PSD.onunhandled.call(null,e._value,e)}));for(var t=id.slice(0),n=t.length;n;)t[--n]()}function Ed(e){return new ad(Mc,!1,e)}function _d(e,t){var n=rd;return function(){var r=vd(),o=rd;try{return Dd(n,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{Dd(o,!1),r&&bd()}}}Bu(ad.prototype,{then:ld,_then:function(e,t){fd(this,new ud(null,null,e,t,rd))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return"function"==typeof t?this.then(null,(e=>e instanceof t?n(e):Ed(e))):this.then(null,(e=>e&&e.name===t?n(e):Ed(e)))},finally:function(e){return this.then((t=>(e(),t)),(t=>(e(),Ed(t))))},stack:{get:function(){if(this._stack)return this._stack;try{Wc=!0;var e=md(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=e),e}finally{Wc=!1}}},timeout:function(e,t){return e<1/0?new ad(((n,r)=>{var o=setTimeout((()=>r(new Rc.Timeout(t))),e);this.then(n,r).finally(clearTimeout.bind(null,o))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&Mu(ad.prototype,Symbol.toStringTag,"Dexie.Promise"),nd.env=qd(),Bu(ad,{all:function(){var e=cc.apply(null,arguments).map(Id);return new ad((function(t,n){0===e.length&&t([]);var r=e.length;e.forEach(((o,s)=>ad.resolve(o).then((n=>{e[s]=n,--r||t(e)}),n)))}))},resolve:e=>{if(e instanceof ad)return e;if(e&&"function"==typeof e.then)return new ad(((t,n)=>{e.then(t,n)}));var t=new ad(Mc,!0,e);return yd(t,ed),t},reject:Ed,race:function(){var e=cc.apply(null,arguments).map(Id);return new ad(((t,n)=>{e.map((e=>ad.resolve(e).then(t,n)))}))},PSD:{get:()=>rd,set:e=>rd=e},totalEchoes:{get:()=>Rd},newPSD:Cd,usePSD:Bd,scheduler:{get:()=>Jc,set:e=>{Jc=e}},rejectionMapper:{get:()=>td,set:e=>{td=e}},follow:(e,t)=>new ad(((n,r)=>Cd(((t,n)=>{var r=rd;r.unhandleds=[],r.onunhandled=n,r.finalize=jc((function(){!function(e){function t(){e(),id.splice(id.indexOf(t),1)}id.push(t),++sd,Jc((()=>{0==--sd&&wd()}),[])}((()=>{0===this.unhandleds.length?t():n(this.unhandleds[0])}))}),r.finalize),e()}),t,n,r)))}),zc&&(zc.allSettled&&Mu(ad,"allSettled",(function(){const e=cc.apply(null,arguments).map(Id);return new ad((t=>{0===e.length&&t([]);let n=e.length;const r=new Array(n);e.forEach(((e,o)=>ad.resolve(e).then((e=>r[o]={status:"fulfilled",value:e}),(e=>r[o]={status:"rejected",reason:e})).then((()=>--n||t(r)))))}))})),zc.any&&"undefined"!=typeof AggregateError&&Mu(ad,"any",(function(){const e=cc.apply(null,arguments).map(Id);return new ad(((t,n)=>{0===e.length&&n(new AggregateError([]));let r=e.length;const o=new Array(r);e.forEach(((e,s)=>ad.resolve(e).then((e=>t(e)),(e=>{o[s]=e,--r||n(new AggregateError(o))}))))}))})));const Sd={awaits:0,echoes:0,id:0};var Od=0,xd=[],Ad=0,Rd=0,Pd=0;function Cd(e,t,n,r){var o=rd,s=Object.create(o);s.parent=o,s.ref=0,s.global=!1,s.id=++Pd;var i=nd.env;s.env=Hc?{Promise:ad,PromiseProp:{value:ad,configurable:!0,writable:!0},all:ad.all,race:ad.race,allSettled:ad.allSettled,any:ad.any,resolve:ad.resolve,reject:ad.reject,nthen:Kd(i.nthen,s),gthen:Kd(i.gthen,s)}:{},t&&ju(s,t),++o.ref,s.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=Bd(s,e,n,r);return 0===s.ref&&s.finalize(),a}function kd(){return Sd.id||(Sd.id=++Od),++Sd.awaits,Sd.echoes+=Kc,Sd.id}function Td(){return!!Sd.awaits&&(0==--Sd.awaits&&(Sd.id=0),Sd.echoes=Sd.awaits*Kc,!0)}function Id(e){return Sd.echoes&&e&&e.constructor===zc?(kd(),e.then((e=>(Td(),e)),(e=>(Td(),Fd(e))))):e}function jd(e){++Rd,Sd.echoes&&0!=--Sd.echoes||(Sd.echoes=Sd.id=0),xd.push(rd),Dd(e,!0)}function Nd(){var e=xd[xd.length-1];xd.pop(),Dd(e,!1)}function Dd(e,t){var n=rd;if((t?!Sd.echoes||Ad++&&e===rd:!Ad||--Ad&&e===rd)||Ud(t?jd.bind(null,e):Nd),e!==rd&&(rd=e,n===nd&&(nd.env=qd()),Hc)){var r=nd.env.Promise,o=e.env;$c.then=o.nthen,r.prototype.then=o.gthen,(n.global||e.global)&&(Object.defineProperty(ku,"Promise",o.PromiseProp),r.all=o.all,r.race=o.race,r.resolve=o.resolve,r.reject=o.reject,o.allSettled&&(r.allSettled=o.allSettled),o.any&&(r.any=o.any))}}function qd(){var e=ku.Promise;return Hc?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(ku,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:$c.then,gthen:e.prototype.then}:{}}function Bd(e,t,n,r,o){var s=rd;try{return Dd(e,!0),t(n,r,o)}finally{Dd(s,!1)}}function Ud(e){Vc.call(Lc,e)}function Md(e,t,n,r){return"function"!=typeof e?e:function(){var o=rd;n&&kd(),Dd(t,!0);try{return e.apply(this,arguments)}finally{Dd(o,!1),r&&Ud(Td)}}}function Kd(e,t){return function(n,r){return e.call(this,Md(n,t),Md(r,t))}}-1===(""+Vc).indexOf("[native code]")&&(kd=Td=kc);const Ld="unhandledrejection";function $d(e,t){var n;try{n=t.onuncatched(e)}catch(ku){}if(!1!==n)try{var r,o={promise:t,reason:e};if(ku.document&&document.createEvent?((r=document.createEvent("Event")).initEvent(Ld,!0,!0),ju(r,o)):ku.CustomEvent&&ju(r=new CustomEvent(Ld,{detail:o}),o),r&&ku.dispatchEvent&&(dispatchEvent(r),!ku.PromiseRejectionEvent&&ku.onunhandledrejection))try{ku.onunhandledrejection(r)}catch(ku){}hc&&r&&!r.defaultPrevented&&console.warn(`Unhandled rejection: ${e.stack||e}`)}catch(ku){}}var Fd=ad.reject;function Vd(e,t,n,r){if(e.idbdb&&(e._state.openComplete||rd.letThrough||e._vip)){var o=e._createTransaction(t,n,e._dbSchema);try{o.create(),e._state.PR1398_maxLoop=3}catch(o){return o.name===xc.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then((()=>Vd(e,t,n,r)))):Fd(o)}return o._promise(t,((e,t)=>Cd((()=>(rd.trans=o,r(e,t,o)))))).then((e=>o._completion.then((()=>e))))}if(e._state.openComplete)return Fd(new Rc.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return Fd(new Rc.DatabaseClosed);e.open().catch(kc)}return e._state.dbReadyPromise.then((()=>Vd(e,t,n,r)))}const zd="3.2.4",Hd=String.fromCharCode(65535),Wd=-1/0,Gd="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Jd="String expected.",Yd=[],Xd="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Qd=Xd,Zd=Xd,eh=e=>!/(dexie\.js|dexie\.min\.js)/.test(e),th="__dbnames",nh="readonly",rh="readwrite";function oh(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}const sh={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function ih(e){return"string"!=typeof e||/\./.test(e)?e=>e:t=>(void 0===t[e]&&e in t&&delete(t=rc(t))[e],t)}class ah{_trans(e,t,n){const r=this._tx||rd.trans,o=this.name;function s(e,n,r){if(!r.schema[o])throw new Rc.NotFound("Table "+o+" not part of transaction");return t(r.idbtrans,r)}const i=vd();try{return r&&r.db===this.db?r===rd.trans?r._promise(e,s,n):Cd((()=>r._promise(e,s,n)),{trans:r,transless:rd.transless||rd}):Vd(this.db,e,[this.name],s)}finally{i&&bd()}}get(e,t){return e&&e.constructor===Object?this.where(e).first(t):this._trans("readonly",(t=>this.core.get({trans:t,key:e}).then((e=>this.hook.reading.fire(e))))).then(t)}where(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(Iu(e))return new this.db.WhereClause(this,`[${e.join("+")}]`);const t=Tu(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);const n=this.schema.indexes.concat(this.schema.primKey).filter((e=>e.compound&&t.every((t=>e.keyPath.indexOf(t)>=0))&&e.keyPath.every((e=>t.indexOf(e)>=0))))[0];if(n&&this.db._maxKey!==Hd)return this.where(n.name).equals(n.keyPath.map((t=>e[t])));!n&&hc&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit of a compound index [${t.join("+")}]`);const{idxByName:r}=this.schema,o=this.db._deps.indexedDB;function s(e,t){try{return 0===o.cmp(e,t)}catch(e){return!1}}const[i,a]=t.reduce((([t,n],o)=>{const i=r[o],a=e[o];return[t||i,t||!i?oh(n,i&&i.multi?e=>{const t=Ju(e,o);return Iu(t)&&t.some((e=>s(a,e)))}:e=>s(a,Ju(e,o))):n]}),[null,null]);return i?this.where(i.name).equals(e[i.keyPath]).filter(a):n?this.filter(a):this.where(t).equals("")}filter(e){return this.toCollection().and(e)}count(e){return this.toCollection().count(e)}offset(e){return this.toCollection().offset(e)}limit(e){return this.toCollection().limit(e)}each(e){return this.toCollection().each(e)}toArray(e){return this.toCollection().toArray(e)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(e){return new this.db.Collection(new this.db.WhereClause(this,Iu(e)?`[${e.join("+")}]`:e))}reverse(){return this.toCollection().reverse()}mapToClass(e){this.schema.mappedClass=e;const t=t=>{if(!t)return t;const n=Object.create(e.prototype);for(var r in t)if(qu(t,r))try{n[r]=t[r]}catch(e){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=t,this.hook("reading",t),e}defineClass(){return this.mapToClass((function(e){ju(this,e)}))}add(e,t){const{auto:n,keyPath:r}=this.schema.primKey;let o=e;return r&&n&&(o=ih(r)(e)),this._trans("readwrite",(e=>this.core.mutate({trans:e,type:"add",keys:null!=t?[t]:null,values:[o]}))).then((e=>e.numFailures?ad.reject(e.failures[0]):e.lastResult)).then((t=>{if(r)try{Yu(e,r,t)}catch(e){}return t}))}update(e,t){if("object"!=typeof e||Iu(e))return this.where(":id").equals(e).modify(t);{const n=Ju(e,this.schema.primKey.keyPath);if(void 0===n)return Fd(new Rc.InvalidArgument("Given object does not contain its primary key"));try{"function"!=typeof t?Tu(t).forEach((n=>{Yu(e,n,t[n])})):t(e,{value:e,primKey:n})}catch(e){}return this.where(":id").equals(n).modify(t)}}put(e,t){const{auto:n,keyPath:r}=this.schema.primKey;let o=e;return r&&n&&(o=ih(r)(e)),this._trans("readwrite",(e=>this.core.mutate({trans:e,type:"put",values:[o],keys:null!=t?[t]:null}))).then((e=>e.numFailures?ad.reject(e.failures[0]):e.lastResult)).then((t=>{if(r)try{Yu(e,r,t)}catch(e){}return t}))}delete(e){return this._trans("readwrite",(t=>this.core.mutate({trans:t,type:"delete",keys:[e]}))).then((e=>e.numFailures?ad.reject(e.failures[0]):void 0))}clear(){return this._trans("readwrite",(e=>this.core.mutate({trans:e,type:"deleteRange",range:sh}))).then((e=>e.numFailures?ad.reject(e.failures[0]):void 0))}bulkGet(e){return this._trans("readonly",(t=>this.core.getMany({keys:e,trans:t}).then((e=>e.map((e=>this.hook.reading.fire(e)))))))}bulkAdd(e,t,n){const r=Array.isArray(t)?t:void 0,o=(n=n||(r?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(t=>{const{auto:n,keyPath:s}=this.schema.primKey;if(s&&r)throw new Rc.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(r&&r.length!==e.length)throw new Rc.InvalidArgument("Arguments objects and keys must have the same length");const i=e.length;let a=s&&n?e.map(ih(s)):e;return this.core.mutate({trans:t,type:"add",keys:r,values:a,wantResults:o}).then((({numFailures:e,results:t,lastResult:n,failures:r})=>{if(0===e)return o?t:n;throw new Oc(`${this.name}.bulkAdd(): ${e} of ${i} operations failed`,r)}))}))}bulkPut(e,t,n){const r=Array.isArray(t)?t:void 0,o=(n=n||(r?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(t=>{const{auto:n,keyPath:s}=this.schema.primKey;if(s&&r)throw new Rc.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(r&&r.length!==e.length)throw new Rc.InvalidArgument("Arguments objects and keys must have the same length");const i=e.length;let a=s&&n?e.map(ih(s)):e;return this.core.mutate({trans:t,type:"put",keys:r,values:a,wantResults:o}).then((({numFailures:e,results:t,lastResult:n,failures:r})=>{if(0===e)return o?t:n;throw new Oc(`${this.name}.bulkPut(): ${e} of ${i} operations failed`,r)}))}))}bulkDelete(e){const t=e.length;return this._trans("readwrite",(t=>this.core.mutate({trans:t,type:"delete",keys:e}))).then((({numFailures:e,lastResult:n,failures:r})=>{if(0===e)return n;throw new Oc(`${this.name}.bulkDelete(): ${e} of ${t} operations failed`,r)}))}}function lh(e){var t={},n=function(n,r){if(r){for(var o=arguments.length,s=new Array(o-1);--o;)s[o-1]=arguments[o];return t[n].subscribe.apply(null,s),e}if("string"==typeof n)return t[n]};n.addEventType=s;for(var r=1,o=arguments.length;r<o;++r)s(arguments[r]);return n;function s(e,r,o){if("object"!=typeof e){var i;r||(r=Bc),o||(o=kc);var a={subscribers:[],fire:o,subscribe:function(e){-1===a.subscribers.indexOf(e)&&(a.subscribers.push(e),a.fire=r(a.fire,e))},unsubscribe:function(e){a.subscribers=a.subscribers.filter((function(t){return t!==e})),a.fire=a.subscribers.reduce(r,o)}};return t[e]=n[e]=a,a}Tu(i=e).forEach((function(e){var t=i[e];if(Iu(t))s(e,i[e][0],i[e][1]);else{if("asap"!==t)throw new Rc.InvalidArgument("Invalid event config");var n=s(e,Tc,(function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];n.subscribers.forEach((function(e){Wu((function(){e.apply(null,t)}))}))}))}}))}}function uh(e,t){return Ku(t).from({prototype:e}),t}function ch(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function dh(e,t){e.filter=oh(e.filter,t)}function hh(e,t,n){var r=e.replayFilter;e.replayFilter=r?()=>oh(r(),t()):t,e.justLimit=n&&!r}function fh(e,t){if(e.isPrimKey)return t.primaryKey;const n=t.getIndexByKeyPath(e.index);if(!n)throw new Rc.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function ph(e,t,n){const r=fh(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function mh(e,t,n,r){const o=e.replayFilter?oh(e.filter,e.replayFilter()):e.filter;if(e.or){const s={},i=(e,n,r)=>{if(!o||o(n,r,(e=>n.stop(e)),(e=>n.fail(e)))){var i=n.primaryKey,a=""+i;"[object ArrayBuffer]"===a&&(a=""+new Uint8Array(i)),qu(s,a)||(s[a]=!0,t(e,n,r))}};return Promise.all([e.or._iterate(i,n),yh(ph(e,r,n),e.algorithm,i,!e.keysOnly&&e.valueMapper)])}return yh(ph(e,r,n),oh(e.algorithm,o),t,!e.keysOnly&&e.valueMapper)}function yh(e,t,n,r){var o=_d(r?(e,t,o)=>n(r(e),t,o):n);return e.then((e=>{if(e)return e.start((()=>{var n=()=>e.continue();t&&!t(e,(e=>n=e),(t=>{e.stop(t),n=kc}),(t=>{e.fail(t),n=kc}))||o(e.value,e,(e=>n=e)),n()}))}))}function gh(e,t){try{const n=vh(e),r=vh(t);if(n!==r)return"Array"===n?1:"Array"===r?-1:"binary"===n?1:"binary"===r?-1:"string"===n?1:"string"===r?-1:"Date"===n?1:"Date"!==r?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return function(e,t){const n=e.length,r=t.length,o=n<r?n:r;for(let s=0;s<o;++s)if(e[s]!==t[s])return e[s]<t[s]?-1:1;return n===r?0:n<r?-1:1}(bh(e),bh(t));case"Array":return function(e,t){const n=e.length,r=t.length,o=n<r?n:r;for(let s=0;s<o;++s){const n=gh(e[s],t[s]);if(0!==n)return n}return n===r?0:n<r?-1:1}(e,t)}}catch(e){}return NaN}function vh(e){const t=typeof e;if("object"!==t)return t;if(ArrayBuffer.isView(e))return"binary";const n=ic(e);return"ArrayBuffer"===n?"binary":n}function bh(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}class wh{_read(e,t){var n=this._ctx;return n.error?n.table._trans(null,Fd.bind(null,n.error)):n.table._trans("readonly",e).then(t)}_write(e){var t=this._ctx;return t.error?t.table._trans(null,Fd.bind(null,t.error)):t.table._trans("readwrite",e,"locked")}_addAlgorithm(e){var t=this._ctx;t.algorithm=oh(t.algorithm,e)}_iterate(e,t){return mh(this._ctx,e,t,this._ctx.table.core)}clone(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&ju(n,e),t._ctx=n,t}raw(){return this._ctx.valueMapper=null,this}each(e){var t=this._ctx;return this._read((n=>mh(t,e,n,t.table.core)))}count(e){return this._read((e=>{const t=this._ctx,n=t.table.core;if(ch(t,!0))return n.count({trans:e,query:{index:fh(t,n.schema),range:t.range}}).then((e=>Math.min(e,t.limit)));var r=0;return mh(t,(()=>(++r,!1)),e,n).then((()=>r))})).then(e)}sortBy(e,t){const n=e.split(".").reverse(),r=n[0],o=n.length-1;function s(e,t){return t?s(e[n[t]],t-1):e[r]}var i="next"===this._ctx.dir?1:-1;function a(e,t){var n=s(e,o),r=s(t,o);return n<r?-i:n>r?i:0}return this.toArray((function(e){return e.sort(a)})).then(t)}toArray(e){return this._read((e=>{var t=this._ctx;if("next"===t.dir&&ch(t,!0)&&t.limit>0){const{valueMapper:n}=t,r=fh(t,t.table.core.schema);return t.table.core.query({trans:e,limit:t.limit,values:!0,query:{index:r,range:t.range}}).then((({result:e})=>n?e.map(n):e))}{const n=[];return mh(t,(e=>n.push(e)),e,t.table.core).then((()=>n))}}),e)}offset(e){var t=this._ctx;return e<=0||(t.offset+=e,ch(t)?hh(t,(()=>{var t=e;return(e,n)=>0===t||(1===t?(--t,!1):(n((()=>{e.advance(t),t=0})),!1))})):hh(t,(()=>{var t=e;return()=>--t<0}))),this}limit(e){return this._ctx.limit=Math.min(this._ctx.limit,e),hh(this._ctx,(()=>{var t=e;return function(e,n,r){return--t<=0&&n(r),t>=0}}),!0),this}until(e,t){return dh(this._ctx,(function(n,r,o){return!e(n.value)||(r(o),t)})),this}first(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)}last(e){return this.reverse().first(e)}filter(e){var t,n;return dh(this._ctx,(function(t){return e(t.value)})),t=this._ctx,n=e,t.isMatch=oh(t.isMatch,n),this}and(e){return this.filter(e)}or(e){return new this.db.WhereClause(this._ctx.table,e,this)}reverse(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.key,n)}))}eachUniqueKey(e){return this._ctx.unique="unique",this.eachKey(e)}eachPrimaryKey(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.primaryKey,n)}))}keys(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.key)})).then((function(){return n})).then(e)}primaryKeys(e){var t=this._ctx;if("next"===t.dir&&ch(t,!0)&&t.limit>0)return this._read((e=>{var n=fh(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:n,range:t.range}})})).then((({result:e})=>e)).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.primaryKey)})).then((function(){return n})).then(e)}uniqueKeys(e){return this._ctx.unique="unique",this.keys(e)}firstKey(e){return this.limit(1).keys((function(e){return e[0]})).then(e)}lastKey(e){return this.reverse().firstKey(e)}distinct(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var n={};return dh(this._ctx,(function(e){var t=e.primaryKey.toString(),r=qu(n,t);return n[t]=!0,!r})),this}modify(e){var t=this._ctx;return this._write((n=>{var r;if("function"==typeof e)r=e;else{var o=Tu(e),s=o.length;r=function(t){for(var n=!1,r=0;r<s;++r){var i=o[r],a=e[i];Ju(t,i)!==a&&(Yu(t,i,a),n=!0)}return n}}const i=t.table.core,{outbound:a,extractKey:l}=i.schema.primaryKey,u=this.db._options.modifyChunkSize||200,c=[];let d=0;const h=[],f=(e,t)=>{const{failures:n,numFailures:r}=t;d+=e-r;for(let o of Tu(n))c.push(n[o])};return this.clone().primaryKeys().then((o=>{const s=c=>{const d=Math.min(u,o.length-c);return i.getMany({trans:n,keys:o.slice(c,c+d),cache:"immutable"}).then((h=>{const p=[],m=[],y=a?[]:null,g=[];for(let e=0;e<d;++e){const t=h[e],n={value:rc(t),primKey:o[c+e]};!1!==r.call(n,n.value,n)&&(null==n.value?g.push(o[c+e]):a||0===gh(l(t),l(n.value))?(m.push(n.value),a&&y.push(o[c+e])):(g.push(o[c+e]),p.push(n.value)))}const v=ch(t)&&t.limit===1/0&&("function"!=typeof e||e===Eh)&&{index:t.index,range:t.range};return Promise.resolve(p.length>0&&i.mutate({trans:n,type:"add",values:p}).then((e=>{for(let t in e.failures)g.splice(parseInt(t),1);f(p.length,e)}))).then((()=>(m.length>0||v&&"object"==typeof e)&&i.mutate({trans:n,type:"put",keys:y,values:m,criteria:v,changeSpec:"function"!=typeof e&&e}).then((e=>f(m.length,e))))).then((()=>(g.length>0||v&&e===Eh)&&i.mutate({trans:n,type:"delete",keys:g,criteria:v}).then((e=>f(g.length,e))))).then((()=>o.length>c+d&&s(c+u)))}))};return s(0).then((()=>{if(c.length>0)throw new Sc("Error modifying one or more objects",c,d,h);return o.length}))}))}))}delete(){var e=this._ctx,t=e.range;return ch(e)&&(e.isPrimKey&&!Zd||3===t.type)?this._write((n=>{const{primaryKey:r}=e.table.core.schema,o=t;return e.table.core.count({trans:n,query:{index:r,range:o}}).then((t=>e.table.core.mutate({trans:n,type:"deleteRange",range:o}).then((({failures:e,lastResult:n,results:r,numFailures:o})=>{if(o)throw new Sc("Could not delete some values",Object.keys(e).map((t=>e[t])),t-o);return t-o}))))})):this.modify(Eh)}}const Eh=(e,t)=>t.value=null;function _h(e,t){return e<t?-1:e===t?0:1}function Sh(e,t){return e>t?-1:e===t?0:1}function Oh(e,t,n){var r=e instanceof kh?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function xh(e){return new e.Collection(e,(()=>Ch(""))).limit(0)}function Ah(e,t,n,r,o,s){for(var i=Math.min(e.length,r.length),a=-1,l=0;l<i;++l){var u=t[l];if(u!==r[l])return o(e[l],n[l])<0?e.substr(0,l)+n[l]+n.substr(l+1):o(e[l],r[l])<0?e.substr(0,l)+r[l]+n.substr(l+1):a>=0?e.substr(0,a)+t[a]+n.substr(a+1):null;o(e[l],u)<0&&(a=l)}return i<r.length&&"next"===s?e+n.substr(e.length):i<e.length&&"prev"===s?e.substr(0,n.length):a<0?null:e.substr(0,a)+r[a]+n.substr(a+1)}function Rh(e,t,n,r){var o,s,i,a,l,u,c,d=n.length;if(!n.every((e=>"string"==typeof e)))return Oh(e,Jd);function h(e){o=function(e){return"next"===e?e=>e.toUpperCase():e=>e.toLowerCase()}(e),s=function(e){return"next"===e?e=>e.toLowerCase():e=>e.toUpperCase()}(e),i="next"===e?_h:Sh;var t=n.map((function(e){return{lower:s(e),upper:o(e)}})).sort((function(e,t){return i(e.lower,t.lower)}));a=t.map((function(e){return e.upper})),l=t.map((function(e){return e.lower})),u=e,c="next"===e?"":r}h("next");var f=new e.Collection(e,(()=>Ph(a[0],l[d-1]+r)));f._ondirectionchange=function(e){h(e)};var p=0;return f._addAlgorithm((function(e,n,r){var o=e.key;if("string"!=typeof o)return!1;var h=s(o);if(t(h,l,p))return!0;for(var f=null,m=p;m<d;++m){var y=Ah(o,h,a[m],l[m],i,u);null===y&&null===f?p=m+1:(null===f||i(f,y)>0)&&(f=y)}return n(null!==f?function(){e.continue(f+c)}:r),!1})),f}function Ph(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function Ch(e){return{type:1,lower:e,upper:e}}class kh{get Collection(){return this._ctx.table.db.Collection}between(e,t,n,r){n=!1!==n,r=!0===r;try{return this._cmp(e,t)>0||0===this._cmp(e,t)&&(n||r)&&(!n||!r)?xh(this):new this.Collection(this,(()=>Ph(e,t,!n,!r)))}catch(e){return Oh(this,Gd)}}equals(e){return null==e?Oh(this,Gd):new this.Collection(this,(()=>Ch(e)))}above(e){return null==e?Oh(this,Gd):new this.Collection(this,(()=>Ph(e,void 0,!0)))}aboveOrEqual(e){return null==e?Oh(this,Gd):new this.Collection(this,(()=>Ph(e,void 0,!1)))}below(e){return null==e?Oh(this,Gd):new this.Collection(this,(()=>Ph(void 0,e,!1,!0)))}belowOrEqual(e){return null==e?Oh(this,Gd):new this.Collection(this,(()=>Ph(void 0,e)))}startsWith(e){return"string"!=typeof e?Oh(this,Jd):this.between(e,e+Hd,!0,!0)}startsWithIgnoreCase(e){return""===e?this.startsWith(e):Rh(this,((e,t)=>0===e.indexOf(t[0])),[e],Hd)}equalsIgnoreCase(e){return Rh(this,((e,t)=>e===t[0]),[e],"")}anyOfIgnoreCase(){var e=cc.apply(uc,arguments);return 0===e.length?xh(this):Rh(this,((e,t)=>-1!==t.indexOf(e)),e,"")}startsWithAnyOfIgnoreCase(){var e=cc.apply(uc,arguments);return 0===e.length?xh(this):Rh(this,((e,t)=>t.some((t=>0===e.indexOf(t)))),e,Hd)}anyOf(){const e=cc.apply(uc,arguments);let t=this._cmp;try{e.sort(t)}catch(e){return Oh(this,Gd)}if(0===e.length)return xh(this);const n=new this.Collection(this,(()=>Ph(e[0],e[e.length-1])));n._ondirectionchange=n=>{t="next"===n?this._ascending:this._descending,e.sort(t)};let r=0;return n._addAlgorithm(((n,o,s)=>{const i=n.key;for(;t(i,e[r])>0;)if(++r,r===e.length)return o(s),!1;return 0===t(i,e[r])||(o((()=>{n.continue(e[r])})),!1)})),n}notEqual(e){return this.inAnyRange([[Wd,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const e=cc.apply(uc,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return Oh(this,Gd)}const t=e.reduce(((e,t)=>e?e.concat([[e[e.length-1][1],t]]):[[Wd,t]]),null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})}inAnyRange(e,t){const n=this._cmp,r=this._ascending,o=this._descending,s=this._min,i=this._max;if(0===e.length)return xh(this);if(!e.every((e=>void 0!==e[0]&&void 0!==e[1]&&r(e[0],e[1])<=0)))return Oh(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Rc.InvalidArgument);const a=!t||!1!==t.includeLowers,l=t&&!0===t.includeUppers;let u,c=r;function d(e,t){return c(e[0],t[0])}try{u=e.reduce((function(e,t){let r=0,o=e.length;for(;r<o;++r){const o=e[r];if(n(t[0],o[1])<0&&n(t[1],o[0])>0){o[0]=s(o[0],t[0]),o[1]=i(o[1],t[1]);break}}return r===o&&e.push(t),e}),[]),u.sort(d)}catch(e){return Oh(this,Gd)}let h=0;const f=l?e=>r(e,u[h][1])>0:e=>r(e,u[h][1])>=0,p=a?e=>o(e,u[h][0])>0:e=>o(e,u[h][0])>=0;let m=f;const y=new this.Collection(this,(()=>Ph(u[0][0],u[u.length-1][1],!a,!l)));return y._ondirectionchange=e=>{"next"===e?(m=f,c=r):(m=p,c=o),u.sort(d)},y._addAlgorithm(((e,t,n)=>{for(var o=e.key;m(o);)if(++h,h===u.length)return t(n),!1;return!!function(e){return!f(e)&&!p(e)}(o)||(0===this._cmp(o,u[h][1])||0===this._cmp(o,u[h][0])||t((()=>{c===r?e.continue(u[h][0]):e.continue(u[h][1])})),!1)})),y}startsWithAnyOf(){const e=cc.apply(uc,arguments);return e.every((e=>"string"==typeof e))?0===e.length?xh(this):this.inAnyRange(e.map((e=>[e,e+Hd]))):Oh(this,"startsWithAnyOf() only works with strings")}}function Th(e){return _d((function(t){return Ih(t),e(t.target.error),!1}))}function Ih(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}const jh="storagemutated",Nh="x-storagemutated-1",Dh=lh(null,jh);class qh{_lock(){return Hu(!rd.global),++this._reculock,1!==this._reculock||rd.global||(rd.lockOwnerFor=this),this}_unlock(){if(Hu(!rd.global),0==--this._reculock)for(rd.global||(rd.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{Bd(e[1],e[0])}catch(e){}}return this}_locked(){return this._reculock&&rd.lockOwnerFor!==this}create(e){if(!this.mode)return this;const t=this.db.idbdb,n=this.db._state.dbOpenError;if(Hu(!this.idbtrans),!e&&!t)switch(n&&n.name){case"DatabaseClosedError":throw new Rc.DatabaseClosed(n);case"MissingAPIError":throw new Rc.MissingAPI(n.message,n);default:throw new Rc.OpenFailed(n)}if(!this.active)throw new Rc.TransactionInactive;return Hu(null===this._completion._state),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):t.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=_d((t=>{Ih(t),this._reject(e.error)})),e.onabort=_d((t=>{Ih(t),this.active&&this._reject(new Rc.Abort(e.error)),this.active=!1,this.on("abort").fire(t)})),e.oncomplete=_d((()=>{this.active=!1,this._resolve(),"mutatedParts"in e&&Dh.storagemutated.fire(e.mutatedParts)})),this}_promise(e,t,n){if("readwrite"===e&&"readwrite"!==this.mode)return Fd(new Rc.ReadOnly("Transaction is readonly"));if(!this.active)return Fd(new Rc.TransactionInactive);if(this._locked())return new ad(((r,o)=>{this._blockedFuncs.push([()=>{this._promise(e,t,n).then(r,o)},rd])}));if(n)return Cd((()=>{var e=new ad(((e,n)=>{this._lock();const r=t(e,n,this);r&&r.then&&r.then(e,n)}));return e.finally((()=>this._unlock())),e._lib=!0,e}));var r=new ad(((e,n)=>{var r=t(e,n,this);r&&r.then&&r.then(e,n)}));return r._lib=!0,r}_root(){return this.parent?this.parent._root():this}waitFor(e){var t=this._root();const n=ad.resolve(e);if(t._waitingFor)t._waitingFor=t._waitingFor.then((()=>n));else{t._waitingFor=n,t._waitingQueue=[];var r=t.idbtrans.objectStore(t.storeNames[0]);!function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(r.get(-1/0).onsuccess=e)}()}var o=t._waitingFor;return new ad(((e,r)=>{n.then((n=>t._waitingQueue.push(_d(e.bind(null,n)))),(e=>t._waitingQueue.push(_d(r.bind(null,e))))).finally((()=>{t._waitingFor===o&&(t._waitingFor=null)}))}))}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Rc.Abort))}table(e){const t=this._memoizedTables||(this._memoizedTables={});if(qu(t,e))return t[e];const n=this.schema[e];if(!n)throw new Rc.NotFound("Table "+e+" not part of transaction");const r=new this.db.Table(e,n,this);return r.core=this.db.core.table(e),t[e]=r,r}}function Bh(e,t,n,r,o,s,i){return{name:e,keyPath:t,unique:n,multi:r,auto:o,compound:s,src:(n&&!i?"&":"")+(r?"*":"")+(o?"++":"")+Uh(t)}}function Uh(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function Mh(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:Gu(n,(e=>[e.name,e]))}}let Kh=e=>{try{return e.only([[]]),Kh=()=>[[]],[[]]}catch(e){return Kh=()=>Hd,Hd}};function Lh(e){return null==e?()=>{}:"string"==typeof e?function(e){const t=e.split(".");return 1===t.length?t=>t[e]:t=>Ju(t,e)}(e):t=>Ju(t,e)}function $h(e){return[].slice.call(e)}let Fh=0;function Vh(e){return null==e?":id":"string"==typeof e?e:`[${e.join("+")}]`}function zh(e,t,n){function r(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:n,upper:r,lowerOpen:o,upperOpen:s}=e;return void 0===n?void 0===r?null:t.upperBound(r,!!s):void 0===r?t.lowerBound(n,!!o):t.bound(n,r,!!o,!!s)}const{schema:o,hasGetAll:s}=function(e,t){const n=$h(e.objectStoreNames);return{schema:{name:e.name,tables:n.map((e=>t.objectStore(e))).map((e=>{const{keyPath:t,autoIncrement:n}=e,r=Iu(t),o=null==t,s={},i={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:o,compound:r,keyPath:t,autoIncrement:n,unique:!0,extractKey:Lh(t)},indexes:$h(e.indexNames).map((t=>e.index(t))).map((e=>{const{name:t,unique:n,multiEntry:r,keyPath:o}=e,i={name:t,compound:Iu(o),keyPath:o,unique:n,multiEntry:r,extractKey:Lh(o)};return s[Vh(o)]=i,i})),getIndexByKeyPath:e=>s[Vh(e)]};return s[":id"]=i.primaryKey,null!=t&&(s[Vh(t)]=i.primaryKey),i}))},hasGetAll:n.length>0&&"getAll"in t.objectStore(n[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,n),i=o.tables.map((e=>function(e){const t=e.name;return{name:t,schema:e,mutate:function({trans:e,type:n,keys:o,values:s,range:i}){return new Promise(((a,l)=>{a=_d(a);const u=e.objectStore(t),c=null==u.keyPath,d="put"===n||"add"===n;if(!d&&"delete"!==n&&"deleteRange"!==n)throw new Error("Invalid operation type: "+n);const{length:h}=o||s||{length:1};if(o&&s&&o.length!==s.length)throw new Error("Given keys array must have same length as given values array.");if(0===h)return a({numFailures:0,failures:{},results:[],lastResult:void 0});let f;const p=[],m=[];let y=0;const g=e=>{++y,Ih(e)};if("deleteRange"===n){if(4===i.type)return a({numFailures:y,failures:m,results:[],lastResult:void 0});3===i.type?p.push(f=u.clear()):p.push(f=u.delete(r(i)))}else{const[e,t]=d?c?[s,o]:[s,null]:[o,null];if(d)for(let r=0;r<h;++r)p.push(f=t&&void 0!==t[r]?u[n](e[r],t[r]):u[n](e[r])),f.onerror=g;else for(let r=0;r<h;++r)p.push(f=u[n](e[r])),f.onerror=g}const v=e=>{const t=e.target.result;p.forEach(((e,t)=>null!=e.error&&(m[t]=e.error))),a({numFailures:y,failures:m,results:"delete"===n?o:p.map((e=>e.result)),lastResult:t})};f.onerror=e=>{g(e),v(e)},f.onsuccess=v}))},getMany:({trans:e,keys:n})=>new Promise(((r,o)=>{r=_d(r);const s=e.objectStore(t),i=n.length,a=new Array(i);let l,u=0,c=0;const d=e=>{const t=e.target;a[t._pos]=t.result,++c===u&&r(a)},h=Th(o);for(let e=0;e<i;++e)null!=n[e]&&(l=s.get(n[e]),l._pos=e,l.onsuccess=d,l.onerror=h,++u);0===u&&r(a)})),get:({trans:e,key:n})=>new Promise(((r,o)=>{r=_d(r);const s=e.objectStore(t).get(n);s.onsuccess=e=>r(e.target.result),s.onerror=Th(o)})),query:function(e){return n=>new Promise(((o,s)=>{o=_d(o);const{trans:i,values:a,limit:l,query:u}=n,c=l===1/0?void 0:l,{index:d,range:h}=u,f=i.objectStore(t),p=d.isPrimaryKey?f:f.index(d.name),m=r(h);if(0===l)return o({result:[]});if(e){const e=a?p.getAll(m,c):p.getAllKeys(m,c);e.onsuccess=e=>o({result:e.target.result}),e.onerror=Th(s)}else{let e=0;const t=a||!("openKeyCursor"in p)?p.openCursor(m):p.openKeyCursor(m),n=[];t.onsuccess=r=>{const s=t.result;return s?(n.push(a?s.value:s.primaryKey),++e===l?o({result:n}):void s.continue()):o({result:n})},t.onerror=Th(s)}}))}(s),openCursor:function({trans:e,values:n,query:o,reverse:s,unique:i}){return new Promise(((a,l)=>{a=_d(a);const{index:u,range:c}=o,d=e.objectStore(t),h=u.isPrimaryKey?d:d.index(u.name),f=s?i?"prevunique":"prev":i?"nextunique":"next",p=n||!("openKeyCursor"in h)?h.openCursor(r(c),f):h.openKeyCursor(r(c),f);p.onerror=Th(l),p.onsuccess=_d((t=>{const n=p.result;if(!n)return void a(null);n.___id=++Fh,n.done=!1;const r=n.continue.bind(n);let o=n.continuePrimaryKey;o&&(o=o.bind(n));const s=n.advance.bind(n),i=()=>{throw new Error("Cursor not stopped")};n.trans=e,n.stop=n.continue=n.continuePrimaryKey=n.advance=()=>{throw new Error("Cursor not started")},n.fail=_d(l),n.next=function(){let e=1;return this.start((()=>e--?this.continue():this.stop())).then((()=>this))},n.start=e=>{const t=new Promise(((e,t)=>{e=_d(e),p.onerror=Th(t),n.fail=t,n.stop=t=>{n.stop=n.continue=n.continuePrimaryKey=n.advance=i,e(t)}})),a=()=>{if(p.result)try{e()}catch(e){n.fail(e)}else n.done=!0,n.start=()=>{throw new Error("Cursor behind last entry")},n.stop()};return p.onsuccess=_d((e=>{p.onsuccess=a,a()})),n.continue=r,n.continuePrimaryKey=o,n.advance=s,a(),t},a(n)}),l)}))},count({query:e,trans:n}){const{index:o,range:s}=e;return new Promise(((e,i)=>{const a=n.objectStore(t),l=o.isPrimaryKey?a:a.index(o.name),u=r(s),c=u?l.count(u):l.count();c.onsuccess=_d((t=>e(t.target.result))),c.onerror=Th(i)}))}}}(e))),a={};return i.forEach((e=>a[e.name]=e)),{stack:"dbcore",transaction:e.transaction.bind(e),table(e){if(!a[e])throw new Error(`Table '${e}' not found`);return a[e]},MIN_KEY:-1/0,MAX_KEY:Kh(t),schema:o}}function Hh({_novip:e},t){const n=t.db,r=function(e,t,{IDBKeyRange:n,indexedDB:r},o){const s=function(e,t){return t.reduce(((e,{create:t})=>({...e,...t(e)})),e)}(zh(t,n,o),e.dbcore);return{dbcore:s}}(e._middlewares,n,e._deps,t);e.core=r.dbcore,e.tables.forEach((t=>{const n=t.name;e.core.schema.tables.some((e=>e.name===n))&&(t.core=e.core.table(n),e[n]instanceof e.Table&&(e[n].core=t.core))}))}function Wh({_novip:e},t,n,r){n.forEach((n=>{const o=r[n];t.forEach((t=>{const r=$u(t,n);(!r||"value"in r&&void 0===r.value)&&(t===e.Transaction.prototype||t instanceof e.Transaction?Mu(t,n,{get(){return this.table(n)},set(e){Uu(this,n,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[n]=new e.Table(n,o))}))}))}function Gh({_novip:e},t){t.forEach((t=>{for(let n in t)t[n]instanceof e.Table&&delete t[n]}))}function Jh(e,t){return e._cfg.version-t._cfg.version}function Yh(e,t,n,r){const o=e._dbSchema,s=e._createTransaction("readwrite",e._storeNames,o);s.create(n),s._completion.catch(r);const i=s._reject.bind(s),a=rd.transless||rd;Cd((()=>{rd.trans=s,rd.transless=a,0===t?(Tu(o).forEach((e=>{Qh(n,e,o[e].primKey,o[e].indexes)})),Hh(e,n),ad.follow((()=>e.on.populate.fire(s))).catch(i)):function({_novip:e},t,n,r){const o=[],s=e._versions;let i=e._dbSchema=ef(e,e.idbdb,r),a=!1;const l=s.filter((e=>e._cfg.version>=t));function u(){return o.length?ad.resolve(o.shift()(n.idbtrans)).then(u):ad.resolve()}return l.forEach((s=>{o.push((()=>{const o=i,l=s._cfg.dbschema;tf(e,o,r),tf(e,l,r),i=e._dbSchema=l;const u=Xh(o,l);u.add.forEach((e=>{Qh(r,e[0],e[1].primKey,e[1].indexes)})),u.change.forEach((e=>{if(e.recreate)throw new Rc.Upgrade("Not yet support for changing primary key");{const t=r.objectStore(e.name);e.add.forEach((e=>Zh(t,e))),e.change.forEach((e=>{t.deleteIndex(e.name),Zh(t,e)})),e.del.forEach((e=>t.deleteIndex(e)))}}));const c=s._cfg.contentUpgrade;if(c&&s._cfg.version>t){Hh(e,r),n._memoizedTables={},a=!0;let t=Xu(l);u.del.forEach((e=>{t[e]=o[e]})),Gh(e,[e.Transaction.prototype]),Wh(e,[e.Transaction.prototype],Tu(t),t),n.schema=t;const s=dc(c);let i;s&&kd();const d=ad.follow((()=>{if(i=c(n),i&&s){var e=Td.bind(null,null);i.then(e,e)}}));return i&&"function"==typeof i.then?ad.resolve(i):d.then((()=>i))}})),o.push((t=>{a&&Qd||function(e,t){[].slice.call(t.db.objectStoreNames).forEach((n=>null==e[n]&&t.db.deleteObjectStore(n)))}(s._cfg.dbschema,t),Gh(e,[e.Transaction.prototype]),Wh(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),n.schema=e._dbSchema}))})),u().then((()=>{var e,t;t=r,Tu(e=i).forEach((n=>{t.db.objectStoreNames.contains(n)||Qh(t,n,e[n].primKey,e[n].indexes)}))}))}(e,t,s,n).catch(i)}))}function Xh(e,t){const n={del:[],add:[],change:[]};let r;for(r in e)t[r]||n.del.push(r);for(r in t){const o=e[r],s=t[r];if(o){const e={name:r,def:s,recreate:!1,del:[],add:[],change:[]};if(""+(o.primKey.keyPath||"")!=""+(s.primKey.keyPath||"")||o.primKey.auto!==s.primKey.auto&&!Xd)e.recreate=!0,n.change.push(e);else{const t=o.idxByName,r=s.idxByName;let i;for(i in t)r[i]||e.del.push(i);for(i in r){const n=t[i],o=r[i];n?n.src!==o.src&&e.change.push(o):e.add.push(o)}(e.del.length>0||e.add.length>0||e.change.length>0)&&n.change.push(e)}}else n.add.push([r,s])}return n}function Qh(e,t,n,r){const o=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach((e=>Zh(o,e))),o}function Zh(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function ef(e,t,n){const r={};return Vu(t.objectStoreNames,0).forEach((e=>{const t=n.objectStore(e);let o=t.keyPath;const s=Bh(Uh(o),o||"",!1,!1,!!t.autoIncrement,o&&"string"!=typeof o,!0),i=[];for(let n=0;n<t.indexNames.length;++n){const e=t.index(t.indexNames[n]);o=e.keyPath;var a=Bh(e.name,o,!!e.unique,!!e.multiEntry,!1,o&&"string"!=typeof o,!1);i.push(a)}r[e]=Mh(e,s,i)})),r}function tf({_novip:e},t,n){const r=n.db.objectStoreNames;for(let o=0;o<r.length;++o){const s=r[o],i=n.objectStore(s);e._hasGetAll="getAll"in i;for(let e=0;e<i.indexNames.length;++e){const n=i.indexNames[e],r=i.index(n).keyPath,o="string"==typeof r?r:"["+Vu(r).join("+")+"]";if(t[s]){const e=t[s].idxByName[o];e&&(e.name=n,delete t[s].idxByName[o],t[s].idxByName[n]=e)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&ku.WorkerGlobalScope&&ku instanceof ku.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}class nf{_parseStoresSpec(e,t){Tu(e).forEach((n=>{if(null!==e[n]){var r=e[n].split(",").map(((e,t)=>{const n=(e=e.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return Bh(n,r||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),Iu(r),0===t)})),o=r.shift();if(o.multi)throw new Rc.Schema("Primary key cannot be multi-valued");r.forEach((e=>{if(e.auto)throw new Rc.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new Rc.Schema("Index must have a name and cannot be an empty string")})),t[n]=Mh(n,o,r)}}))}stores(e){const t=this.db;this._cfg.storesSource=this._cfg.storesSource?ju(this._cfg.storesSource,e):e;const n=t._versions,r={};let o={};return n.forEach((e=>{ju(r,e._cfg.storesSource),o=e._cfg.dbschema={},e._parseStoresSpec(r,o)})),t._dbSchema=o,Gh(t,[t._allTables,t,t.Transaction.prototype]),Wh(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],Tu(o),o),t._storeNames=Tu(o),this}upgrade(e){return this._cfg.contentUpgrade=Uc(this._cfg.contentUpgrade||kc,e),this}}function rf(e,t){let n=e._dbNamesDB;return n||(n=e._dbNamesDB=new Rf(th,{addons:[],indexedDB:e,IDBKeyRange:t}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function of(e){return e&&"function"==typeof e.databases}function sf(e){return Cd((function(){return rd.letThrough=!0,e()}))}function af(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise((function(t){var n=function(){return indexedDB.databases().finally(t)};e=setInterval(n,100),n()})).finally((function(){return clearInterval(e)})):Promise.resolve()}function lf(e){const t=e._state,{indexedDB:n}=e._deps;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then((()=>t.dbOpenError?Fd(t.dbOpenError):e));hc&&(t.openCanceller._stackHolder=yc()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;const r=t.openCanceller;function o(){if(t.openCanceller!==r)throw new Rc.DatabaseClosed("db.open() was cancelled")}let s=t.dbReadyResolve,i=null,a=!1;return ad.race([r,("undefined"==typeof navigator?ad.resolve():af()).then((()=>new ad(((r,s)=>{if(o(),!n)throw new Rc.MissingAPI;const l=e.name,u=t.autoSchema?n.open(l):n.open(l,Math.round(10*e.verno));if(!u)throw new Rc.MissingAPI;u.onerror=Th(s),u.onblocked=_d(e._fireOnBlocked),u.onupgradeneeded=_d((r=>{if(i=u.transaction,t.autoSchema&&!e._options.allowEmptyDB){u.onerror=Ih,i.abort(),u.result.close();const e=n.deleteDatabase(l);e.onsuccess=e.onerror=_d((()=>{s(new Rc.NoSuchDatabase(`Database ${l} doesnt exist`))}))}else{i.onerror=Th(s);var o=r.oldVersion>Math.pow(2,62)?0:r.oldVersion;a=o<1,e._novip.idbdb=u.result,Yh(e,o/10,i,s)}}),s),u.onsuccess=_d((()=>{i=null;const n=e._novip.idbdb=u.result,o=Vu(n.objectStoreNames);if(o.length>0)try{const r=n.transaction(1===(s=o).length?s[0]:s,"readonly");t.autoSchema?function({_novip:e},t,n){e.verno=t.version/10;const r=e._dbSchema=ef(0,t,n);e._storeNames=Vu(t.objectStoreNames,0),Wh(e,[e._allTables],Tu(r),r)}(e,n,r):(tf(e,e._dbSchema,r),function(e,t){const n=Xh(ef(0,e.idbdb,t),e._dbSchema);return!(n.add.length||n.change.some((e=>e.add.length||e.change.length)))}(e,r)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),Hh(e,r)}catch(e){}var s;Yd.push(e),n.onversionchange=_d((n=>{t.vcFired=!0,e.on("versionchange").fire(n)})),n.onclose=_d((t=>{e.on("close").fire(t)})),a&&function({indexedDB:e,IDBKeyRange:t},n){!of(e)&&n!==th&&rf(e,t).put({name:n}).catch(kc)}(e._deps,l),r()}),s)}))))]).then((()=>(o(),t.onReadyBeingFired=[],ad.resolve(sf((()=>e.on.ready.fire(e.vip)))).then((function n(){if(t.onReadyBeingFired.length>0){let r=t.onReadyBeingFired.reduce(Uc,kc);return t.onReadyBeingFired=[],ad.resolve(sf((()=>r(e.vip)))).then(n)}}))))).finally((()=>{t.onReadyBeingFired=null,t.isBeingOpened=!1})).then((()=>e)).catch((n=>{t.dbOpenError=n;try{i&&i.abort()}catch(e){}return r===t.openCanceller&&e._close(),Fd(n)})).finally((()=>{t.openComplete=!0,s()}))}function uf(e){var t=t=>e.next(t),n=o(t),r=o((t=>e.throw(t)));function o(e){return t=>{var o=e(t),s=o.value;return o.done?s:s&&"function"==typeof s.then?s.then(n,r):Iu(s)?Promise.all(s).then(n,r):n(s)}}return o(t)()}function cf(e,t,n){var r=arguments.length;if(r<2)throw new Rc.InvalidArgument("Too few arguments");for(var o=new Array(r-1);--r;)o[r-1]=arguments[r];return n=o.pop(),[e,Zu(o),n]}function df(e,t,n,r,o){return ad.resolve().then((()=>{const s=rd.transless||rd,i=e._createTransaction(t,n,e._dbSchema,r),a={trans:i,transless:s};if(r)i.idbtrans=r.idbtrans;else try{i.create(),e._state.PR1398_maxLoop=3}catch(r){return r.name===xc.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then((()=>df(e,t,n,null,o)))):Fd(r)}const l=dc(o);let u;l&&kd();const c=ad.follow((()=>{if(u=o.call(i,i),u)if(l){var e=Td.bind(null,null);u.then(e,e)}else"function"==typeof u.next&&"function"==typeof u.throw&&(u=uf(u))}),a);return(u&&"function"==typeof u.then?ad.resolve(u).then((e=>i.active?e:Fd(new Rc.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn")))):c.then((()=>u))).then((e=>(r&&i._resolve(),i._completion.then((()=>e))))).catch((e=>(i._reject(e),Fd(e))))}))}function hf(e,t,n){const r=Iu(e)?e.slice():[e];for(let o=0;o<n;++o)r.push(t);return r}const ff={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return{...e,table(t){const n=e.table(t),{schema:r}=n,o={},s=[];function i(e,t,n){const r=Vh(e),a=o[r]=o[r]||[],l=null==e?0:"string"==typeof e?1:e.length,u=t>0,c={...n,isVirtual:u,keyTail:t,keyLength:l,extractKey:Lh(e),unique:!u&&n.unique};return a.push(c),c.isPrimaryKey||s.push(c),l>1&&i(2===l?e[0]:e.slice(0,l-1),t+1,n),a.sort(((e,t)=>e.keyTail-t.keyTail)),c}const a=i(r.primaryKey.keyPath,0,r.primaryKey);o[":id"]=[a];for(const e of r.indexes)i(e.keyPath,0,e);function l(t){const n=t.query.index;return n.isVirtual?{...t,query:{index:n,range:(r=t.query.range,o=n.keyTail,{type:1===r.type?2:r.type,lower:hf(r.lower,r.lowerOpen?e.MAX_KEY:e.MIN_KEY,o),lowerOpen:!0,upper:hf(r.upper,r.upperOpen?e.MIN_KEY:e.MAX_KEY,o),upperOpen:!0})}}:t;var r,o}const u={...n,schema:{...r,primaryKey:a,indexes:s,getIndexByKeyPath:function(e){const t=o[Vh(e)];return t&&t[0]}},count:e=>n.count(l(e)),query:e=>n.query(l(e)),openCursor(t){const{keyTail:r,isVirtual:o,keyLength:s}=t.query.index;return o?n.openCursor(l(t)).then((n=>n&&function(n){const o=Object.create(n,{continue:{value:function(o){null!=o?n.continue(hf(o,t.reverse?e.MAX_KEY:e.MIN_KEY,r)):t.unique?n.continue(n.key.slice(0,s).concat(t.reverse?e.MIN_KEY:e.MAX_KEY,r)):n.continue()}},continuePrimaryKey:{value(t,o){n.continuePrimaryKey(hf(t,e.MAX_KEY,r),o)}},primaryKey:{get:()=>n.primaryKey},key:{get(){const e=n.key;return 1===s?e[0]:e.slice(0,s)}},value:{get:()=>n.value}});return o}(n))):n.openCursor(t)}};return u}}}};function pf(e,t,n,r){return n=n||{},r=r||"",Tu(e).forEach((o=>{if(qu(t,o)){var s=e[o],i=t[o];if("object"==typeof s&&"object"==typeof i&&s&&i){const e=ic(s);e!==ic(i)?n[r+o]=t[o]:"Object"===e?pf(s,i,n,r+o+"."):s!==i&&(n[r+o]=t[o])}else s!==i&&(n[r+o]=t[o])}else n[r+o]=void 0})),Tu(t).forEach((o=>{qu(e,o)||(n[r+o]=t[o])})),n}const mf={stack:"dbcore",name:"HooksMiddleware",level:2,create:e=>({...e,table(t){const n=e.table(t),{primaryKey:r}=n.schema,o={...n,mutate(e){const o=rd.trans,{deleting:s,creating:i,updating:a}=o.table(t).hook;switch(e.type){case"add":if(i.fire===kc)break;return o._promise("readwrite",(()=>l(e)),!0);case"put":if(i.fire===kc&&a.fire===kc)break;return o._promise("readwrite",(()=>l(e)),!0);case"delete":if(s.fire===kc)break;return o._promise("readwrite",(()=>l(e)),!0);case"deleteRange":if(s.fire===kc)break;return o._promise("readwrite",(()=>function(e){return u(e.trans,e.range,1e4)}(e)),!0)}return n.mutate(e);function l(e){const t=rd.trans,o=e.keys||function(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}(r,e);if(!o)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?{...e,keys:o}:{...e}).type&&(e.values=[...e.values]),e.keys&&(e.keys=[...e.keys]),function(e,t,n){return"add"===t.type?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}(n,e,o).then((l=>{const u=o.map(((n,o)=>{const u=l[o],c={onerror:null,onsuccess:null};if("delete"===e.type)s.fire.call(c,n,u,t);else if("add"===e.type||void 0===u){const s=i.fire.call(c,n,e.values[o],t);null==n&&null!=s&&(n=s,e.keys[o]=n,r.outbound||Yu(e.values[o],r.keyPath,n))}else{const r=pf(u,e.values[o]),s=a.fire.call(c,r,n,u,t);if(s){const t=e.values[o];Object.keys(s).forEach((e=>{qu(t,e)?t[e]=s[e]:Yu(t,e,s[e])}))}}return c}));return n.mutate(e).then((({failures:t,results:n,numFailures:r,lastResult:s})=>{for(let i=0;i<o.length;++i){const r=n?n[i]:o[i],s=u[i];null==r?s.onerror&&s.onerror(t[i]):s.onsuccess&&s.onsuccess("put"===e.type&&l[i]?e.values[i]:r)}return{failures:t,results:n,numFailures:r,lastResult:s}})).catch((e=>(u.forEach((t=>t.onerror&&t.onerror(e))),Promise.reject(e))))}))}function u(e,t,o){return n.query({trans:e,values:!1,query:{index:r,range:t},limit:o}).then((({result:n})=>l({type:"delete",keys:n,trans:e}).then((r=>r.numFailures>0?Promise.reject(r.failures[0]):n.length<o?{failures:[],numFailures:0,lastResult:void 0}:u(e,{...t,lower:n[n.length-1],lowerOpen:!0},o)))))}}};return o}})};function yf(e,t,n){try{if(!t)return null;if(t.keys.length<e.length)return null;const r=[];for(let o=0,s=0;o<t.keys.length&&s<e.length;++o)0===gh(t.keys[o],e[s])&&(r.push(n?rc(t.values[o]):t.values[o]),++s);return r.length===e.length?r:null}catch(e){return null}}const gf={stack:"dbcore",level:-1,create:e=>({table:t=>{const n=e.table(t);return{...n,getMany:e=>{if(!e.cache)return n.getMany(e);const t=yf(e.keys,e.trans._cache,"clone"===e.cache);return t?ad.resolve(t):n.getMany(e).then((t=>(e.trans._cache={keys:e.keys,values:"clone"===e.cache?rc(t):t},t)))},mutate:e=>("add"!==e.type&&(e.trans._cache=null),n.mutate(e))}}})};function vf(e){return!("from"in e)}const bf=function(e,t){if(!this){const t=new bf;return e&&"d"in e&&ju(t,e),t}ju(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function wf(e,t,n){const r=gh(t,n);if(isNaN(r))return;if(r>0)throw RangeError();if(vf(e))return ju(e,{from:t,to:n,d:1});const o=e.l,s=e.r;if(gh(n,e.from)<0)return o?wf(o,t,n):e.l={from:t,to:n,d:1,l:null,r:null},Of(e);if(gh(t,e.to)>0)return s?wf(s,t,n):e.r={from:t,to:n,d:1,l:null,r:null},Of(e);gh(t,e.from)<0&&(e.from=t,e.l=null,e.d=s?s.d+1:1),gh(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);const i=!e.r;o&&!e.l&&Ef(e,o),s&&i&&Ef(e,s)}function Ef(e,t){vf(t)||function e(t,{from:n,to:r,l:o,r:s}){wf(t,n,r),o&&e(t,o),s&&e(t,s)}(e,t)}function _f(e,t){const n=Sf(t);let r=n.next();if(r.done)return!1;let o=r.value;const s=Sf(e);let i=s.next(o.from),a=i.value;for(;!r.done&&!i.done;){if(gh(a.from,o.to)<=0&&gh(a.to,o.from)>=0)return!0;gh(o.from,a.from)<0?o=(r=n.next(a.from)).value:a=(i=s.next(o.from)).value}return!1}function Sf(e){let t=vf(e)?null:{s:0,n:e};return{next(e){const n=arguments.length>0;for(;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&gh(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||gh(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function Of(e){var t,n;const r=((null===(t=e.r)||void 0===t?void 0:t.d)||0)-((null===(n=e.l)||void 0===n?void 0:n.d)||0),o=r>1?"r":r<-1?"l":"";if(o){const t="r"===o?"l":"r",n={...e},r=e[o];e.from=r.from,e.to=r.to,e[o]=r[o],n[o]=r[t],e[t]=n,n.d=xf(n)}e.d=xf(e)}function xf({r:e,l:t}){return(e?t?Math.max(e.d,t.d):e.d:t?t.d:0)+1}Bu(bf.prototype,{add(e){return Ef(this,e),this},addKey(e){return wf(this,e,e),this},addKeys(e){return e.forEach((e=>wf(this,e,e))),this},[ac](){return Sf(this)}});const Af={stack:"dbcore",level:0,create:e=>{const t=e.schema.name,n=new bf(e.MIN_KEY,e.MAX_KEY);return{...e,table:r=>{const o=e.table(r),{schema:s}=o,{primaryKey:i}=s,{extractKey:a,outbound:l}=i,u={...o,mutate:e=>{const i=e.trans,a=i.mutatedParts||(i.mutatedParts={}),l=e=>{const n=`idb://${t}/${r}/${e}`;return a[n]||(a[n]=new bf)},u=l(""),c=l(":dels"),{type:d}=e;let[h,f]="deleteRange"===e.type?[e.range]:"delete"===e.type?[e.keys]:e.values.length<50?[[],e.values]:[];const p=e.trans._cache;return o.mutate(e).then((e=>{if(Iu(h)){"delete"!==d&&(h=e.results),u.addKeys(h);const t=yf(h,p);t||"add"===d||c.addKeys(h),(t||f)&&function(e,t,n,r){function o(t){const o=e(t.name||"");function s(e){return null!=e?t.extractKey(e):null}const i=e=>t.multiEntry&&Iu(e)?e.forEach((e=>o.addKey(e))):o.addKey(e);(n||r).forEach(((e,t)=>{const o=n&&s(n[t]),a=r&&s(r[t]);0!==gh(o,a)&&(null!=o&&i(o),null!=a&&i(a))}))}t.indexes.forEach(o)}(l,s,t,f)}else if(h){const e={from:h.lower,to:h.upper};c.add(e),u.add(e)}else u.add(n),c.add(n),s.indexes.forEach((e=>l(e.name).add(n)));return e}))}},c=({query:{index:t,range:n}})=>{var r,o;return[t,new bf(null!==(r=n.lower)&&void 0!==r?r:e.MIN_KEY,null!==(o=n.upper)&&void 0!==o?o:e.MAX_KEY)]},d={get:e=>[i,new bf(e.key)],getMany:e=>[i,(new bf).addKeys(e.keys)],count:c,query:c,openCursor:c};return Tu(d).forEach((e=>{u[e]=function(s){const{subscr:i}=rd;if(i){const u=e=>{const n=`idb://${t}/${r}/${e}`;return i[n]||(i[n]=new bf)},c=u(""),h=u(":dels"),[f,p]=d[e](s);if(u(f.name||"").add(p),!f.isPrimaryKey){if("count"!==e){const t="query"===e&&l&&s.values&&o.query({...s,values:!1});return o[e].apply(this,arguments).then((n=>{if("query"===e){if(l&&s.values)return t.then((({result:e})=>(c.addKeys(e),n)));const e=s.values?n.result.map(a):n.result;s.values?c.addKeys(e):h.addKeys(e)}else if("openCursor"===e){const e=n,t=s.values;return e&&Object.create(e,{key:{get:()=>(h.addKey(e.primaryKey),e.key)},primaryKey:{get(){const t=e.primaryKey;return h.addKey(t),t}},value:{get:()=>(t&&c.addKey(e.primaryKey),e.value)}})}return n}))}h.add(n)}}return o[e].apply(this,arguments)}})),u}}}};class Rf{constructor(e,t){this._middlewares={},this.verno=0;const n=Rf.dependencies;this._options=t={addons:Rf.addons,autoOpen:!0,indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange,...t},this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange};const{addons:r}=t;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const o={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:kc,dbReadyPromise:null,cancelOpen:kc,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var s;o.dbReadyPromise=new ad((e=>{o.dbReadyResolve=e})),o.openCanceller=new ad(((e,t)=>{o.cancelOpen=t})),this._state=o,this.name=e,this.on=lh(this,"populate","blocked","versionchange","close",{ready:[Uc,kc]}),this.on.ready.subscribe=zu(this.on.ready.subscribe,(e=>(t,n)=>{Rf.vip((()=>{const r=this._state;if(r.openComplete)r.dbOpenError||ad.resolve().then(t),n&&e(t);else if(r.onReadyBeingFired)r.onReadyBeingFired.push(t),n&&e(t);else{e(t);const r=this;n||e((function e(){r.on.ready.unsubscribe(t),r.on.ready.unsubscribe(e)}))}}))})),this.Collection=(s=this,uh(wh.prototype,(function(e,t){this.db=s;let n=sh,r=null;if(t)try{n=t()}catch(e){r=e}const o=e._ctx,i=o.table,a=i.hook.reading.fire;this._ctx={table:i,index:o.index,isPrimKey:!o.index||i.schema.primKey.keyPath&&o.index===i.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:r,or:o.or,valueMapper:a!==Tc?a:null}}))),this.Table=function(e){return uh(ah.prototype,(function(t,n,r){this.db=e,this._tx=r,this.name=t,this.schema=n,this.hook=e._allTables[t]?e._allTables[t].hook:lh(null,{creating:[Nc,kc],reading:[Ic,Tc],updating:[qc,kc],deleting:[Dc,kc]})}))}(this),this.Transaction=function(e){return uh(qh.prototype,(function(t,n,r,o,s){this.db=e,this.mode=t,this.storeNames=n,this.schema=r,this.chromeTransactionDurability=o,this.idbtrans=null,this.on=lh(this,"complete","error","abort"),this.parent=s||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new ad(((e,t)=>{this._resolve=e,this._reject=t})),this._completion.then((()=>{this.active=!1,this.on.complete.fire()}),(e=>{var t=this.active;return this.active=!1,this.on.error.fire(e),this.parent?this.parent._reject(e):t&&this.idbtrans&&this.idbtrans.abort(),Fd(e)}))}))}(this),this.Version=function(e){return uh(nf.prototype,(function(t){this.db=e,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}(this),this.WhereClause=function(e){return uh(kh.prototype,(function(t,n,r){this.db=e,this._ctx={table:t,index:":id"===n?null:n,or:r};const o=e._deps.indexedDB;if(!o)throw new Rc.MissingAPI;this._cmp=this._ascending=o.cmp.bind(o),this._descending=(e,t)=>o.cmp(t,e),this._max=(e,t)=>o.cmp(e,t)>0?e:t,this._min=(e,t)=>o.cmp(e,t)<0?e:t,this._IDBKeyRange=e._deps.IDBKeyRange}))}(this),this.on("versionchange",(e=>{e.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()})),this.on("blocked",(e=>{!e.newVersion||e.newVersion<e.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${e.oldVersion/10}`)})),this._maxKey=Kh(t.IDBKeyRange),this._createTransaction=(e,t,n,r)=>new this.Transaction(e,t,n,this._options.chromeTransactionDurability,r),this._fireOnBlocked=e=>{this.on("blocked").fire(e),Yd.filter((e=>e.name===this.name&&e!==this&&!e._state.vcFired)).map((t=>t.on("versionchange").fire(e)))},this.use(ff),this.use(mf),this.use(Af),this.use(gf),this.vip=Object.create(this,{_vip:{value:!0}}),r.forEach((e=>e(this)))}version(e){if(isNaN(e)||e<.1)throw new Rc.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new Rc.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);const t=this._versions;var n=t.filter((t=>t._cfg.version===e))[0];return n||(n=new this.Version(e),t.push(n),t.sort(Jh),n.stores({}),this._state.autoSchema=!1,n)}_whenReady(e){return this.idbdb&&(this._state.openComplete||rd.letThrough||this._vip)?e():new ad(((e,t)=>{if(this._state.openComplete)return t(new Rc.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void t(new Rc.DatabaseClosed);this.open().catch(kc)}this._state.dbReadyPromise.then(e,t)})).then(e)}use({stack:e,create:t,level:n,name:r}){r&&this.unuse({stack:e,name:r});const o=this._middlewares[e]||(this._middlewares[e]=[]);return o.push({stack:e,create:t,level:null==n?10:n,name:r}),o.sort(((e,t)=>e.level-t.level)),this}unuse({stack:e,name:t,create:n}){return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter((e=>n?e.create!==n:!!t&&e.name!==t))),this}open(){return lf(this)}_close(){const e=this._state,t=Yd.indexOf(this);if(t>=0&&Yd.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(e){}this._novip.idbdb=null}e.dbReadyPromise=new ad((t=>{e.dbReadyResolve=t})),e.openCanceller=new ad(((t,n)=>{e.cancelOpen=n}))}close(){this._close();const e=this._state;this._options.autoOpen=!1,e.dbOpenError=new Rc.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)}delete(){const e=arguments.length>0,t=this._state;return new ad(((n,r)=>{const o=()=>{this.close();var e=this._deps.indexedDB.deleteDatabase(this.name);e.onsuccess=_d((()=>{!function({indexedDB:e,IDBKeyRange:t},n){!of(e)&&n!==th&&rf(e,t).delete(n).catch(kc)}(this._deps,this.name),n()})),e.onerror=Th(r),e.onblocked=this._fireOnBlocked};if(e)throw new Rc.InvalidArgument("Arguments not allowed in db.delete()");t.isBeingOpened?t.dbReadyPromise.then(o):o()}))}backendDB(){return this.idbdb}isOpen(){return null!==this.idbdb}hasBeenClosed(){const e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name}hasFailed(){return null!==this._state.dbOpenError}dynamicallyOpened(){return this._state.autoSchema}get tables(){return Tu(this._allTables).map((e=>this._allTables[e]))}transaction(){const e=cf.apply(this,arguments);return this._transaction.apply(this,e)}_transaction(e,t,n){let r=rd.trans;r&&r.db===this&&-1===e.indexOf("!")||(r=null);const o=-1!==e.indexOf("?");let s,i;e=e.replace("!","").replace("?","");try{if(i=t.map((e=>{var t=e instanceof this.Table?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t})),"r"==e||e===nh)s=nh;else{if("rw"!=e&&e!=rh)throw new Rc.InvalidArgument("Invalid transaction mode: "+e);s=rh}if(r){if(r.mode===nh&&s===rh){if(!o)throw new Rc.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");r=null}r&&i.forEach((e=>{if(r&&-1===r.storeNames.indexOf(e)){if(!o)throw new Rc.SubTransaction("Table "+e+" not included in parent transaction.");r=null}})),o&&r&&!r.active&&(r=null)}}catch(e){return r?r._promise(null,((t,n)=>{n(e)})):Fd(e)}const a=df.bind(null,this,s,i,r,n);return r?r._promise(s,a,"lock"):rd.trans?Bd(rd.transless,(()=>this._whenReady(a))):this._whenReady(a)}table(e){if(!qu(this._allTables,e))throw new Rc.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]}}const Pf="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable";class Cf{constructor(e){this._subscribe=e}subscribe(e,t,n){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:t,complete:n})}[Pf](){return this}}function kf(e,t){return Tu(t).forEach((n=>{Ef(e[n]||(e[n]=new bf),t[n])})),e}function Tf(e){let t,n=!1;const r=new Cf((r=>{const o=dc(e);let s=!1,i={},a={};const l={get closed(){return s},unsubscribe:()=>{s=!0,Dh.storagemutated.unsubscribe(h)}};r.start&&r.start(l);let u=!1,c=!1;function d(){return Tu(a).some((e=>i[e]&&_f(i[e],a[e])))}const h=e=>{kf(i,e),d()&&f()},f=()=>{if(u||s)return;i={};const p={},m=function(t){o&&kd();const n=()=>Cd(e,{subscr:t,trans:null}),r=rd.trans?Bd(rd.transless,n):n();return o&&r.then(Td,Td),r}(p);c||(Dh(jh,h),c=!0),u=!0,Promise.resolve(m).then((e=>{n=!0,t=e,u=!1,s||(d()?f():(i={},a=p,r.next&&r.next(e)))}),(e=>{u=!1,n=!1,r.error&&r.error(e),l.unsubscribe()}))};return f(),l}));return r.hasValue=()=>n,r.getValue=()=>t,r}let If;try{If={indexedDB:ku.indexedDB||ku.mozIndexedDB||ku.webkitIndexedDB||ku.msIndexedDB,IDBKeyRange:ku.IDBKeyRange||ku.webkitIDBKeyRange}}catch(ku){If={indexedDB:null,IDBKeyRange:null}}const jf=Rf;function Nf(e){let t=Df;try{Df=!0,Dh.storagemutated.fire(e)}finally{Df=t}}Bu(jf,{...Cc,delete:e=>new jf(e,{addons:[]}).delete(),exists:e=>new jf(e,{addons:[]}).open().then((e=>(e.close(),!0))).catch("NoSuchDatabaseError",(()=>!1)),getDatabaseNames(e){try{return function({indexedDB:e,IDBKeyRange:t}){return of(e)?Promise.resolve(e.databases()).then((e=>e.map((e=>e.name)).filter((e=>e!==th)))):rf(e,t).toCollection().primaryKeys()}(jf.dependencies).then(e)}catch(e){return Fd(new Rc.MissingAPI)}},defineClass:()=>function(e){ju(this,e)},ignoreTransaction:e=>rd.trans?Bd(rd.transless,e):e(),vip:sf,async:function(e){return function(){try{var t=uf(e.apply(this,arguments));return t&&"function"==typeof t.then?t:ad.resolve(t)}catch(e){return Fd(e)}}},spawn:function(e,t,n){try{var r=uf(e.apply(n,t||[]));return r&&"function"==typeof r.then?r:ad.resolve(r)}catch(e){return Fd(e)}},currentTransaction:{get:()=>rd.trans||null},waitFor:function(e,t){const n=ad.resolve("function"==typeof e?jf.ignoreTransaction(e):e).timeout(t||6e4);return rd.trans?rd.trans.waitFor(n):n},Promise:ad,debug:{get:()=>hc,set:e=>{fc(e,"dexie"===e?()=>!0:eh)}},derive:Ku,extend:ju,props:Bu,override:zu,Events:lh,on:Dh,liveQuery:Tf,extendObservabilitySet:kf,getByKeyPath:Ju,setByKeyPath:Yu,delByKeyPath:function(e,t){"string"==typeof t?Yu(e,t,void 0):"length"in t&&[].map.call(t,(function(t){Yu(e,t,void 0)}))},shallowClone:Xu,deepClone:rc,getObjectDiff:pf,cmp:gh,asap:Wu,minKey:Wd,addons:[],connections:Yd,errnames:xc,dependencies:If,semVer:zd,version:zd.split(".").map((e=>parseInt(e))).reduce(((e,t,n)=>e+t/Math.pow(10,2*n)))}),jf.maxKey=Kh(jf.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&(Dh(jh,(e=>{if(!Df){let t;Xd?(t=document.createEvent("CustomEvent"),t.initCustomEvent(Nh,!0,!0,e)):t=new CustomEvent(Nh,{detail:e}),Df=!0,dispatchEvent(t),Df=!1}})),addEventListener(Nh,(({detail:e})=>{Df||Nf(e)})));let Df=!1;if("undefined"!=typeof BroadcastChannel){const e=new BroadcastChannel(Nh);"function"==typeof e.unref&&e.unref(),Dh(jh,(t=>{Df||e.postMessage(t)})),e.onmessage=e=>{e.data&&Nf(e.data)}}else if("undefined"!=typeof self&&"undefined"!=typeof navigator){Dh(jh,(e=>{try{Df||("undefined"!=typeof localStorage&&localStorage.setItem(Nh,JSON.stringify({trig:Math.random(),changedParts:e})),"object"==typeof self.clients&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach((t=>t.postMessage({type:Nh,changedParts:e}))))}catch(e){}})),"undefined"!=typeof addEventListener&&addEventListener("storage",(e=>{if(e.key===Nh){const t=JSON.parse(e.newValue);t&&Nf(t.changedParts)}}));const e=self.document&&navigator.serviceWorker;e&&e.addEventListener("message",(function({data:e}){e&&e.type===Nh&&Nf(e.changedParts)}))}ad.rejectionMapper=function(e,t){if(!e||e instanceof Ec||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Pc[e.name])return e;var n=new Pc[e.name](t||e.message,e);return"stack"in e&&Mu(n,"stack",{get:function(){return this.inner.stack}}),n},fc(hc,eh);class qf extends Rf{constructor(){super("promptDb"),Cu(this,"userPrompt",void 0),Cu(this,"systemPrompt",void 0);const e=["userPrompt","systemPrompt"],t=e.reduce(((e,t)=>(e[t]="&key, value",e)),{});this.version(1).stores(t),this.userPrompt=this.table("userPrompt"),this.systemPrompt=this.table("systemPrompt")}}const Bf=new qf;var Uf=n(6583),Mf=n(4584),Kf=n(5071),Lf=n(6453),$f=n(6540),Ff=(0,s.aZ)({__name:"HomePageDialog",props:(0,s.Vf)({title:{},optionList:{}},{removeVisible:{type:Boolean},removeVisibleModifiers:{},removeValue:{},removeValueModifiers:{}}),emits:(0,s.Vf)(["remove"],["update:removeVisible","update:removeValue"]),setup(e,{emit:t}){const n=(0,s.tT)(e,"removeVisible"),r=(0,s.tT)(e,"removeValue"),o=t,a=()=>{o("remove")};return(e,t)=>{const o=(0,s.up)("el-option"),l=(0,s.up)("el-select"),u=(0,s.up)("el-button"),c=(0,s.up)("el-dialog");return(0,s.wg)(),(0,s.j4)(c,{modelValue:n.value,"onUpdate:modelValue":t[2]||(t[2]=e=>n.value=e),width:"90%",title:e.$t(e.title)},{footer:(0,s.w5)((()=>[(0,s.Wm)(u,{onClick:t[1]||(t[1]=e=>n.value=!1)},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.$t("cancel")),1)])),_:1}),(0,s.Wm)(u,{type:"primary",onClick:a},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.$t("confirm")),1)])),_:1})])),default:(0,s.w5)((()=>[(0,s.Wm)(l,{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),multiple:"",filterable:"",size:"small",style:{width:"100%"},placeholder:"Select"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.optionList,(e=>((0,s.wg)(),(0,s.j4)(o,{key:e.value,label:e.key,value:e.key},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["modelValue","title"])}}});const Vf=Ff;var zf=Vf,Hf=(0,s.aZ)({__name:"HomePageAddDialog",props:(0,s.Vf)({title:{},aliasLabel:{},aliasPlaceholder:{},promptLabel:{},promptPlaceholder:{}},{addVisible:{type:Boolean},addVisibleModifiers:{},addAlias:{},addAliasModifiers:{},addValue:{},addValueModifiers:{}}),emits:(0,s.Vf)(["add"],["update:addVisible","update:addAlias","update:addValue"]),setup(e,{emit:t}){const n=(0,s.tT)(e,"addVisible"),r=(0,s.tT)(e,"addAlias"),o=(0,s.tT)(e,"addValue"),a=t,l=()=>{a("add")};return(e,t)=>{const a=(0,s.up)("el-input"),u=(0,s.up)("el-form-item"),c=(0,s.up)("el-form"),d=(0,s.up)("el-button"),h=(0,s.up)("el-dialog");return(0,s.wg)(),(0,s.j4)(h,{modelValue:n.value,"onUpdate:modelValue":t[3]||(t[3]=e=>n.value=e),width:"90%",title:e.$t(e.title)},{footer:(0,s.w5)((()=>[(0,s.Wm)(d,{onClick:t[2]||(t[2]=e=>n.value=!1)},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.$t("cancel")),1)])),_:1}),(0,s.Wm)(d,{type:"primary",onClick:l},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.$t("confirm")),1)])),_:1})])),default:(0,s.w5)((()=>[(0,s.Wm)(c,{"label-position":"top","label-width":"50px"},{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{label:(0,s.w5)((()=>[(0,s._)("span",null,(0,i.zw)(e.$t(e.aliasLabel)),1)])),default:(0,s.w5)((()=>[(0,s.Wm)(a,{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),clearable:"",size:"small",placeholder:e.$t(e.aliasPlaceholder)},null,8,["modelValue","placeholder"])])),_:1}),(0,s.Wm)(u,null,{label:(0,s.w5)((()=>[(0,s._)("span",null,(0,i.zw)(e.$t(e.promptLabel)),1)])),default:(0,s.w5)((()=>[(0,s.Wm)(a,{modelValue:o.value,"onUpdate:modelValue":t[1]||(t[1]=e=>o.value=e),clearable:"",type:"textarea",size:"small",placeholder:e.$t(e.promptPlaceholder)},null,8,["modelValue","placeholder"])])),_:1})])),_:1})])),_:1},8,["modelValue","title"])}}});const Wf=Hf;var Gf=Wf;const Jf={class:"container"},Yf={style:{width:"100%"}},Xf={style:{"margin-top":"5px","align-items":"center",display:"flex","margin-bottom":"5px"}},Qf={class:"result-group"};var Zf=(0,s.aZ)({__name:"HomePage",setup(e){const{t:t}=(0,d.QT)(),{settingForm:n}=(0,Kf.Z)(),r=(0,a.iH)(""),o=(0,a.iH)(""),h=(0,a.iH)([]),f=(0,a.iH)(!1),p=(0,a.iH)(""),m=(0,a.iH)(""),y=(0,a.iH)(!1),g=(0,a.iH)([]),v=(0,a.iH)(""),b=(0,a.iH)(""),w=(0,a.iH)([]),E=(0,a.iH)(!1),_=(0,a.iH)(""),S=(0,a.iH)(""),O=(0,a.iH)(!1),x=(0,a.iH)([]),A=(0,a.iH)("res"),R=(0,a.iH)(!1),P=(0,c.tv)(),C=(0,a.iH)([]),k=(0,a.iH)(!1),T=(0,a.iH)(!1),I=(0,a.iH)("replace"),j=["replace","append","newLine","NoAction"].map((e=>({label:t(e),value:e})));async function N(){const e=Bf.table("systemPrompt"),t=await e.toArray();h.value=t}async function D(){const e=Bf.table("systemPrompt");await e.put({key:p.value,value:m.value}),f.value=!1,N()}async function q(){y.value=!1;const e=Bf.table("systemPrompt");for(const t of g.value)await e.delete(t);g.value=[],N()}async function B(){O.value=!1;const e=Bf.table("userPrompt");for(const t of x.value)await e.delete(t);x.value=[],M()}function U(e){r.value=e,localStorage.setItem(Mf._.defaultSystemPrompt,e)}async function M(){const e=Bf.table("userPrompt"),t=await e.toArray();w.value=t}async function K(){const e=Bf.table("userPrompt");await e.put({key:_.value,value:S.value}),E.value=!1,M()}function L(e){v.value=e,localStorage.setItem(Mf._.defaultPrompt,e)}const $=()=>{(0,s.YP)((()=>n.value.replyLanguage),(()=>{localStorage.setItem("replyLanguage",n.value.replyLanguage)}))};async function F(){I.value=localStorage.getItem(Mf._.insertType)||"replace",r.value=localStorage.getItem(Mf._.defaultSystemPrompt)||"Abstract and research paper assistant.",await N(),h.value.find((e=>e.value===r.value))&&(o.value=r.value),v.value=localStorage.getItem(Mf._.defaultPrompt)||"",await M(),w.value.find((e=>e.value===v.value))&&(b.value=v.value)}function V(e){I.value=e,localStorage.setItem(Mf._.insertType,e)}async function z(e){let t;R.value=!0;let o="";const s=async()=>Word.run((async e=>{const t=e.document.getSelection();return t.load("text"),await e.sync(),t.text})),i=await s();if("custom"===e?(t=r.value.includes("{language}")?r.value.replace("{language}",n.value.replyLanguage):r.value,o=o.includes("{text}")?o.replace("{text}",i):`Reply in ${n.value.replyLanguage} ${v.value} ${i}`):(t=wt.ez[e].system(n.value.replyLanguage),o=wt.ez[e].user(i,n.value.replyLanguage)),"official"===n.value.api&&n.value.officialAPIKey){const e=xu.official.setConfig(n.value.officialAPIKey,n.value.officialBasePath);C.value=[{role:"system",content:t},{role:"user",content:o}],await xu.official.createChatCompletionStream(e,C.value,A,C,T,R,n.value.officialMaxTokens,n.value.officialTemperature,n.value.officialCustomModel||n.value.officialModelSelect)}else if("azure"===n.value.api&&n.value.azureAPIKey)C.value=[{role:"system",content:t},{role:"user",content:o}],await xu.azure.createChatCompletionStream({azureAPIKey:n.value.azureAPIKey,azureAPIEndpoint:n.value.azureAPIEndpoint,azureDeploymentName:n.value.azureDeploymentName,messages:C.value,result:A,historyDialog:C,errorIssue:T,loading:R,maxTokens:n.value.azureMaxTokens,temperature:n.value.azureTemperature});else if("palm"===n.value.api&&n.value.palmAPIKey)await xu.palm.createChatCompletionStream(n.value.palmAPIKey,n.value.palmAPIEndpoint,n.value.palmCustomModel||n.value.palmModelSelect,`${t}\n${o}`,A,T,R,n.value.palmMaxTokens,n.value.palmTemperature);else if("gemini"===n.value.api&&n.value.geminiAPIKey)C.value=[{role:"user",parts:[{text:t+"\n"+o}]},{role:"model",parts:[{text:"Hi, what can I help you?"}]}],await xu.gemini.createChatCompletionStream({geminiAPIKey:n.value.geminiAPIKey,messages:o,result:A,historyDialog:C,errorIssue:T,loading:R,maxTokens:n.value.geminiMaxTokens,temperature:n.value.geminiTemperature,geminiModel:n.value.geminiCustomModel||n.value.geminiModelSelect});else{if("ollama"!==n.value.api||!n.value.ollamaEndpoint)return void l.z8.error("Set API Key or Access Token first");C.value=[{role:"user",content:t+"\n"+o}],await xu.ollama.createChatCompletionStream(n.value.ollamaEndpoint,n.value.ollamaCustomModel||n.value.ollamaModelSelect,C.value,A,C,T,R,n.value.ollamaTemperature)}if(!0===T.value)return T.value=!1,void l.z8.error("Something is wrong");k.value||xu.common.insertResult(A,I)}function H(){const e={type:n.value.api,apiKey:n.value.officialAPIKey,azureAPIKey:n.value.azureAPIKey,palmAPIKey:n.value.palmAPIKey,geminiAPIKey:n.value.geminiAPIKey};return!!(0,Uf.wt)(e)||(l.z8.error("Set API Key or Access Token first"),!1)}const W=Object.keys(wt.ez);async function G(e){H()&&z(e)}function J(){P.push("/settings")}function Y(){H()&&z("custom")}async function X(){if(H()){R.value=!0;try{switch(n.value.api){case"official":C.value.push({role:"user",content:"continue"}),await xu.official.createChatCompletionStream(xu.official.setConfig(n.value.officialAPIKey,n.value.officialBasePath),C.value,A,C,T,R,n.value.officialMaxTokens,n.value.officialTemperature,n.value.officialCustomModel||n.value.officialModelSelect);break;case"azure":C.value.push({role:"user",content:"continue"}),await xu.azure.createChatCompletionStream({azureAPIKey:n.value.azureAPIKey,azureAPIEndpoint:n.value.azureAPIEndpoint,azureDeploymentName:n.value.azureDeploymentName,messages:C.value,result:A,historyDialog:C,errorIssue:T,loading:R,maxTokens:n.value.azureMaxTokens,temperature:n.value.azureTemperature});break;case"gemini":C.value.push({role:"user",parts:[{text:"continue"}]},{role:"model",parts:[{text:"OK, I will continue to help you."}]}),await xu.gemini.createChatCompletionStream({geminiAPIKey:n.value.geminiAPIKey,messages:"continue",result:A,historyDialog:C,errorIssue:T,loading:R,maxTokens:n.value.geminiMaxTokens,temperature:n.value.geminiTemperature,geminiModel:n.value.geminiCustomModel||n.value.geminiModelSelect});break;case"ollama":C.value.push({role:"user",content:"continue"}),await xu.ollama.createChatCompletionStream(n.value.ollamaEndpoint,n.value.ollamaCustomModel||n.value.ollamaModelSelect,C.value,A,C,T,R,n.value.ollamaTemperature)}}catch(e){A.value=String(e),T.value=!0,console.error(e)}if(!0===T.value)return T.value=!1,void l.z8.error("Something is wrong");xu.common.insertResult(A,I)}}return(0,s.wF)((()=>{$(),F()})),(e,t)=>{const l=(0,s.up)("el-input"),c=(0,s.up)("el-option"),d=(0,s.up)("el-select"),P=(0,s.up)("el-icon"),C=(0,s.up)("el-form-item"),k=(0,s.up)("el-form"),T=(0,s.up)("el-progress"),N=(0,s.up)("el-button"),M=(0,s.up)("el-button-group");return(0,s.wg)(),(0,s.iD)("div",Jf,[(0,s.Wm)(k,{"label-position":"left","label-width":"70px"},{default:(0,s.w5)((()=>[(0,s.Wm)(C,null,{label:(0,s.w5)((()=>[(0,s._)("span",null,(0,i.zw)(e.$t("homeSystem")),1)])),default:(0,s.w5)((()=>[(0,s.Wm)(l,{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),clearable:"",size:"small",placeholder:e.$t("homeSystemDescription")},null,8,["modelValue","placeholder"]),(0,s._)("span",null,[(0,s.Wm)(d,{modelValue:o.value,"onUpdate:modelValue":t[1]||(t[1]=e=>o.value=e),size:"small",placeholder:"Select a system prompt",onChange:U},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(h.value,(e=>((0,s.wg)(),(0,s.j4)(c,{key:e.value,label:e.key,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),(0,s.Wm)(P,{color:"#409EFF",style:{cursor:"pointer","margin-left":"5px","vertical-align":"middle"},size:"15px",onClick:t[2]||(t[2]=e=>f.value=!0)},{default:(0,s.w5)((()=>[(0,s.Wm)((0,a.SU)(u.Gq5))])),_:1}),(0,s.Wm)(P,{color:"red",style:{cursor:"pointer","margin-left":"5px","vertical-align":"middle"},size:"15px",onClick:t[3]||(t[3]=e=>y.value=!0)},{default:(0,s.w5)((()=>[(0,s.Wm)((0,a.SU)(u.JWV))])),_:1})])])),_:1}),(0,s.Wm)(C,null,{label:(0,s.w5)((()=>[(0,s._)("span",null,(0,i.zw)(e.$t("homePrompt")),1)])),default:(0,s.w5)((()=>[(0,s.Wm)(l,{modelValue:v.value,"onUpdate:modelValue":t[4]||(t[4]=e=>v.value=e),autofocus:"",clearable:"",size:"small",placeholder:e.$t("homePromptDescription")},null,8,["modelValue","placeholder"]),(0,s._)("span",null,[(0,s.Wm)(d,{modelValue:b.value,"onUpdate:modelValue":t[5]||(t[5]=e=>b.value=e),size:"small",placeholder:"Select a prompt",onChange:L},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(w.value,(e=>((0,s.wg)(),(0,s.j4)(c,{key:e.value,label:e.key,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),(0,s.Wm)(P,{color:"#409EFF",style:{cursor:"pointer","margin-left":"5px","vertical-align":"middle"},size:"15px",onClick:t[6]||(t[6]=e=>E.value=!0)},{default:(0,s.w5)((()=>[(0,s.Wm)((0,a.SU)(u.Gq5))])),_:1}),(0,s.Wm)(P,{color:"red",style:{cursor:"pointer","margin-left":"5px","vertical-align":"middle"},size:"15px",onClick:t[7]||(t[7]=e=>O.value=!0)},{default:(0,s.w5)((()=>[(0,s.Wm)((0,a.SU)(u.JWV))])),_:1})])])),_:1}),(0,s.Wm)($f.Z,{modelValue:(0,a.SU)(n).replyLanguage,"onUpdate:modelValue":t[8]||(t[8]=e=>(0,a.SU)(n).replyLanguage=e),label:"replyLanguageLabel","option-list":(0,a.SU)(Lf.w).replyLanguage.optionList,placeholder:"replyLanguagePlaceholder"},null,8,["modelValue","option-list"]),(0,s.Wm)($f.Z,{modelValue:I.value,"onUpdate:modelValue":t[9]||(t[9]=e=>I.value=e),label:"insertType","option-list":(0,a.SU)(j),placeholder:"insertTypePlaceholder",onChange:V},null,8,["modelValue","option-list"])])),_:1}),(0,s._)("div",Yf,[R.value?((0,s.wg)(),(0,s.j4)(T,{key:0,percentage:50,indeterminate:"",duration:5,status:"warning",style:{widows:"100%"}})):(0,s.kq)("",!0)]),(0,s.Wm)(M,{class:"input-group",style:{"margin-top":"5px"}},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,a.SU)(W),(t=>((0,s.wg)(),(0,s.j4)(N,{key:t,class:"api-button",type:"primary",size:"small",disabled:R.value,onClick:e=>G(t)},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.$t(t)),1)])),_:2},1032,["disabled","onClick"])))),128)),(0,s.Wm)(N,{class:"api-button",type:"warning",size:"small",onClick:J},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.$t("settings")),1)])),_:1})])),_:1}),(0,s._)("div",Xf,[(0,s.Wm)(M,null,{default:(0,s.w5)((()=>[(0,s.Wm)(N,{class:"api-button",type:"success",size:"default",disabled:R.value,onClick:Y},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.$t("start")),1)])),_:1},8,["disabled"]),["azure","official","gemini","ollama"].includes((0,a.SU)(n).api)?((0,s.wg)(),(0,s.j4)(N,{key:0,class:"api-button",type:"success",size:"default",disabled:R.value,onClick:X},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.$t("continue")),1)])),_:1},8,["disabled"])):(0,s.kq)("",!0)])),_:1})]),(0,s._)("div",Qf,[(0,s.Wm)(l,{modelValue:A.value,"onUpdate:modelValue":t[10]||(t[10]=e=>A.value=e),type:"textarea",autosize:"",row:5,"aria-placeholder":e.$t("result")},null,8,["modelValue","aria-placeholder"])]),(0,s.Wm)(Gf,{addVisible:f.value,"onUpdate:addVisible":t[11]||(t[11]=e=>f.value=e),addAlias:p.value,"onUpdate:addAlias":t[12]||(t[12]=e=>p.value=e),addValue:m.value,"onUpdate:addValue":t[13]||(t[13]=e=>m.value=e),title:"addSystemPrompt","alias-label":"addSystemPromptAlias","alias-placeholder":"addSystemPromptAliasDescription","prompt-label":"homeSystem","prompt-placeholder":"addSystemPromptDescription",onAdd:D},null,8,["addVisible","addAlias","addValue"]),(0,s.Wm)(Gf,{addVisible:E.value,"onUpdate:addVisible":t[14]||(t[14]=e=>E.value=e),addAlias:_.value,"onUpdate:addAlias":t[15]||(t[15]=e=>_.value=e),addValue:S.value,"onUpdate:addValue":t[16]||(t[16]=e=>S.value=e),title:"addPrompt","alias-label":"addPromptAlias","alias-placeholder":"addPromptAliasDescription","prompt-label":"homePrompt","prompt-placeholder":"homePromptDescription",onAdd:K},null,8,["addVisible","addAlias","addValue"]),(0,s.Wm)(zf,{removeVisible:y.value,"onUpdate:removeVisible":t[17]||(t[17]=e=>y.value=e),removeValue:g.value,"onUpdate:removeValue":t[18]||(t[18]=e=>g.value=e),title:"removeSystemPrompt","option-list":h.value,onRemove:q},null,8,["removeVisible","removeValue","option-list"]),(0,s.Wm)(zf,{removeVisible:O.value,"onUpdate:removeVisible":t[19]||(t[19]=e=>O.value=e),removeValue:x.value,"onUpdate:removeValue":t[20]||(t[20]=e=>x.value=e),title:"removePrompt","option-list":w.value,onRemove:B},null,8,["removeVisible","removeValue","option-list"])])}}}),ep=n(89);const tp=(0,ep.Z)(Zf,[["__scopeId","data-v-07a9fb34"]]);var np=tp},6004:function(e,t,n){var r=n(8844);e.exports=r([].slice)},3127:function(e){e.exports="function"==typeof Bun&&Bun&&"string"==typeof Bun.version},4764:function(e,t,n){var r=n(71);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},806:function(e,t,n){var r=n(9037),o=n(6648);e.exports="process"===o(r.process)},1735:function(e,t,n){var r=n(7215),o=Function.prototype,s=o.apply,i=o.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?i.bind(s):function(){return i.apply(s,arguments)})},4071:function(e,t,n){var r=n(6576),o=n(509),s=n(7215),i=r(r.bind);e.exports=function(e,t){return o(e),void 0===t?e:s?i(e,t):function(){return e.apply(t,arguments)}}},6576:function(e,t,n){var r=n(6648),o=n(8844);e.exports=function(e){if("Function"===r(e))return o(e)}},2688:function(e,t,n){var r=n(6058);e.exports=r("document","documentElement")},8552:function(e,t,n){var r=n(9037),o=n(1735),s=n(9985),i=n(3127),a=n(71),l=n(6004),u=n(1500),c=r.Function,d=/MSIE .\./.test(a)||i&&function(){var e=r.Bun.version.split(".");return e.length<3||"0"===e[0]&&(e[1]<3||"3"===e[1]&&"0"===e[2])}();e.exports=function(e,t){var n=t?2:1;return d?function(r,i){var a=u(arguments.length,1)>n,d=s(r)?r:c(r),h=a?l(arguments,n):[],f=a?function(){o(d,this,h)}:d;return t?e(f,i):e(f)}:e}},9886:function(e,t,n){var r,o,s,i,a=n(9037),l=n(1735),u=n(4071),c=n(9985),d=n(6812),h=n(3689),f=n(2688),p=n(6004),m=n(6420),y=n(1500),g=n(4764),v=n(806),b=a.setImmediate,w=a.clearImmediate,E=a.process,_=a.Dispatch,S=a.Function,O=a.MessageChannel,x=a.String,A=0,R={},P="onreadystatechange";h((function(){r=a.location}));var C=function(e){if(d(R,e)){var t=R[e];delete R[e],t()}},k=function(e){return function(){C(e)}},T=function(e){C(e.data)},I=function(e){a.postMessage(x(e),r.protocol+"//"+r.host)};b&&w||(b=function(e){y(arguments.length,1);var t=c(e)?e:S(e),n=p(arguments,1);return R[++A]=function(){l(t,void 0,n)},o(A),A},w=function(e){delete R[e]},v?o=function(e){E.nextTick(k(e))}:_&&_.now?o=function(e){_.now(k(e))}:O&&!g?(s=new O,i=s.port2,s.port1.onmessage=T,o=u(i.postMessage,i)):a.addEventListener&&c(a.postMessage)&&!a.importScripts&&r&&"file:"!==r.protocol&&!h(I)?(o=I,a.addEventListener("message",T,!1)):o=P in m("script")?function(e){f.appendChild(m("script"))[P]=function(){f.removeChild(this),C(e)}}:function(e){setTimeout(k(e),0)}),e.exports={set:b,clear:w}},9742:function(e,t,n){var r=n(9989),o=n(9037),s=n(9886).clear;r({global:!0,bind:!0,enumerable:!0,forced:o.clearImmediate!==s},{clearImmediate:s})},88:function(e,t,n){n(9742),n(2731)},2731:function(e,t,n){var r=n(9989),o=n(9037),s=n(9886).set,i=n(8552),a=o.setImmediate?i(s,!1):s;r({global:!0,bind:!0,enumerable:!0,forced:o.setImmediate!==a},{setImmediate:a})}}]);
//# sourceMappingURL=home.447c162c.js.map